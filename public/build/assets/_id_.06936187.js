import{bd as se,k as u,r as _e,o as w,b as F,w as o,m as l,p as e,C,q as s,P as ve,D as v,be as Ve,E as V,ay as ge,$ as q,Z as De,A as be,c as j,F as he,a as xe,x,y as Y,H as we,I as ye}from"./main.7fa0f71e.js";import{_ as Ae}from"./DialogCloseBtn.65c2afd7.js";import{s as H}from"./successMiddleware.5781748a.js";import{e as B}from"./errorsMiddleware.63c0e2b3.js";import{u as ie}from"./useAttendanceStore.44fbf43b.js";import{_ as Ce}from"./EditEmployeeAttendanceDrawer.f27b9f5d.js";import{r as te}from"./validators.330a354f.js";import{V as re}from"./VSpacer.3ec81c6b.js";import{V as D,a as ae}from"./VBtn.069192ce.js";import{V as Q,c as O}from"./VCard.030e8f02.js";import{V as Ee}from"./VForm.4e1ce8b2.js";import{V as de,a as h}from"./VRow.9a415d63.js";import{V as I}from"./VInput.5ff15ec5.js";import{V as L}from"./VTextField.274a75e5.js";import{V as le}from"./VFileInput.075d8aee.js";import{V as Ue}from"./VNavigationDrawer.bfe02dd1.js";import{a as ke}from"./VOverlay.4a38a54b.js";import{V as Z}from"./VDivider.c84ac45e.js";import{V as Se}from"./VSelect.a4bf81df.js";import{V as Ne}from"./VTable.049a34c9.js";import{V as Re}from"./VMenu.cdb8ae34.js";import{V as Fe,b as oe,a as ne}from"./VList.fc38797b.js";import{V as $e}from"./VPagination.d7236996.js";import{V as Te}from"./VDialog.8b46c977.js";import"./AppDateTimePicker.962f3994.js";import"./VField.48a02540.js";import"./index.6cded1e6.js";import"./position.67e80c4d.js";import"./router.03090725.js";import"./easing.36b781ab.js";import"./index.b522f886.js";import"./VAvatar.e9ee2511.js";import"./VImg.2d1f7e61.js";import"./forwardRefs.c003b6b8.js";/* empty css                   */import"./VCounter.ac27f1c3.js";import"./VChip.43475c6f.js";import"./ssrBoot.7e6afdfd.js";import"./lazy.620d5a9e.js";import"./dialog-transition.2bfa19b0.js";import"./VCheckboxBtn.95fc78a7.js";import"./VSelectionControl.0a0ba36b.js";import"./scopeId.dda89175.js";const Oe={class:"d-flex align-center pa-6 pb-1"},Pe=l("h6",{class:"text-h6"}," Add New Record ",-1),ze={__name:"AddEmployeeAttendanceDrawer",props:{isDrawerOpen:{type:null,required:!0},loading:{type:null,required:!0},employees:{type:Object,required:!0}},setup(W){const g=W,k=ie(),P=se(),t=u({start_date:new Date().getFullYear()+"-"+(new Date().getMonth()+1)+"-"+new Date().getDate(),end_date:"",end_date_restrict:new Date().getFullYear()+"-"+(new Date().getMonth()+1)+"-"+(new Date().getDate()+1),position:"",position_ar:"",real_start_date:"",real_end_date:"",national_card:"",birth_certificate:""}),$=u(!1),S=u();u(),u({id:-1});const E=()=>{g.isDrawerOpen.open=!1,ge(()=>{var d,i;(d=S.value)==null||d.reset(),(i=S.value)==null||i.resetValidation()})},U=()=>{if(console.log(t),t.value.birth_certificate[0]===void 0&&t.value.national_card[0]===void 0&&m(null,null),t.value.birth_certificate[0]!==void 0&&t.value.national_card[0]===void 0){var d=new FileReader;d.readAsDataURL(t.value.birth_certificate[0]),d.onload=function(){let r=d.result;m(r,null)},d.onerror=function(r){return""}}if(t.value.national_card[0]!==void 0&&t.value.birth_certificate[0]===void 0){var i=new FileReader;i.readAsDataURL(t.value.national_card[0]),i.onload=function(){let r=i.result;m(null,r)},i.onerror=function(r){return""}}if(t.value.birth_certificate[0]!==void 0&&t.value.national_card[0]!==void 0){console.log("here");var c=new FileReader;c.readAsDataURL(t.value.birth_certificate[0]),c.onload=function(){let r=c.result;if(t.value.national_card[0]!==void 0){var _=new FileReader;_.readAsDataURL(t.value.national_card[0]),_.onload=function(){let M=_.result;m(r,M)}}},c.onerror=function(r){return""}}},m=(d,i)=>{t.value.start_date===""?B("Warning","start date must be selected"):(g.loading.isActive=!0,console.log(g.loading),k.addEmployeeAttendanceRecord(b(t.value.end_date),b(t.value.start_date),Number(P.params.id),t.value.position,d,i,b(t.value.real_start_date),b(t.value.real_end_date),t.value.position_ar).then(c=>{g.isDrawerOpen.open=!1,g.loading.isActive=!1,H(c.data.msg),location.reload()}).catch(c=>{g.loading.isActive=!1,B("Error Occured",c.response.data.message)}))},y=d=>{g.isDrawerOpen.value.open=d};function T(d){return parseInt(d)<10?"0"+d:d}const p=d=>{const i=d.getDate(),c=d.getMonth()+1;return`${d.getFullYear()}-${T(c)}-${T(i)}`},A=()=>{(t.value.start_date===""||t.value.start_date>=t.value.end_date&&t.value.end_date!=="")&&(t.value.end_date=""),t.value.end_date_restrict=new Date(new Date(t.value.start_date).getTime()+24*60*60*2e3).toISOString().split("T")[0]},b=d=>{if(d!=null&&d!==""){console.log(d);let i=new Date(d),c=i.getFullYear(),r=String(i.getMonth()+1).padStart(2,"0"),_=String(i.getDate()).padStart(2,"0");return`${c}-${r}-${_}`}return d};return(d,i)=>{const c=_e("VueDatePicker");return w(),F(Ue,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":g.isDrawerOpen.open,"onUpdate:modelValue":y},{default:o(()=>[l("div",Oe,[Pe,e(re),e(D,{variant:"tonal",color:"default",icon:"",size:"32",class:"rounded",onClick:E},{default:o(()=>[e(C,{size:"18",icon:"tabler-x"})]),_:1})]),e(s(ve),{options:{wheelPropagation:!1}},{default:o(()=>[e(Q,{flat:""},{default:o(()=>[e(O,null,{default:o(()=>[e(Ee,{ref_key:"refForm",ref:S,modelValue:s($),"onUpdate:modelValue":i[8]||(i[8]=r=>v($)?$.value=r:null),onSubmit:Ve(U,["prevent"])},{default:o(()=>[e(de,null,{default:o(()=>[e(h,{cols:"12"},{default:o(()=>[e(I,null,{default:o(()=>[V(" CNAS START DATE ")]),_:1}),e(c,{modelValue:s(t).start_date,"onUpdate:modelValue":[i[0]||(i[0]=r=>s(t).start_date=r),A],"auto-apply":"",format:p},null,8,["modelValue"])]),_:1}),e(h,{cols:"12"},{default:o(()=>[e(I,null,{default:o(()=>[V(" CNAS END DATE ")]),_:1}),e(c,{modelValue:s(t).end_date,"onUpdate:modelValue":i[1]||(i[1]=r=>s(t).end_date=r),"auto-apply":"",format:p,"min-date":s(t).end_date_restrict},null,8,["modelValue","min-date"])]),_:1}),e(h,{cols:"12"},{default:o(()=>[e(I,null,{default:o(()=>[V(" REAL START DATE ")]),_:1}),e(c,{modelValue:s(t).real_start_date,"onUpdate:modelValue":[i[2]||(i[2]=r=>s(t).real_start_date=r),A],"auto-apply":"",format:p},null,8,["modelValue"])]),_:1}),e(h,{cols:"12"},{default:o(()=>[e(I,null,{default:o(()=>[V(" REAL END DATE ")]),_:1}),e(c,{modelValue:s(t).real_end_date,"onUpdate:modelValue":i[3]||(i[3]=r=>s(t).real_end_date=r),"auto-apply":"",format:p,"min-date":s(t).end_date_restrict},null,8,["modelValue","min-date"])]),_:1}),e(h,{cols:"12"},{default:o(()=>[e(L,{modelValue:s(t).position,"onUpdate:modelValue":i[4]||(i[4]=r=>s(t).position=r),rules:[s(te)],label:"Position"},null,8,["modelValue","rules"])]),_:1}),e(h,{cols:"12"},{default:o(()=>[e(L,{modelValue:s(t).position_ar,"onUpdate:modelValue":i[5]||(i[5]=r=>s(t).position_ar=r),rules:[s(te)],label:"Position Arabic"},null,8,["modelValue","rules"])]),_:1}),e(h,{cols:"12"},{default:o(()=>[e(le,{modelValue:s(t).national_card,"onUpdate:modelValue":i[6]||(i[6]=r=>s(t).national_card=r),label:"National Card",variant:"filled"},null,8,["modelValue"])]),_:1}),e(h,{cols:"12"},{default:o(()=>[e(le,{modelValue:s(t).birth_certificate,"onUpdate:modelValue":i[7]||(i[7]=r=>s(t).birth_certificate=r),label:"Birth Certificate",variant:"filled"},null,8,["modelValue"])]),_:1}),e(h,{cols:"12"},{default:o(()=>[e(D,{type:"submit",class:"me-3"},{default:o(()=>[V(" Submit ")]),_:1}),e(D,{type:"reset",variant:"tonal",color:"secondary",onClick:E},{default:o(()=>[V(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};const Ie={class:"me-3",style:{width:"80px"}},Be={style:{width:"12rem"}},Le={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Me={style:{width:"9rem"}},qe=l("thead",null,[l("tr",null,[l("th",{scope:"col"}," ID "),l("th",{scope:"col"}," Start Date "),l("th",{scope:"col"}," End Date "),l("th",{scope:"col"}," Period "),l("th",{scope:"col"}," REAL Start Date "),l("th",{scope:"col"}," REAL End Date "),l("th",{scope:"col"}," REAL Period "),l("th",{scope:"col"}," Position "),l("th",{scope:"col"}," ACTIONS ")])],-1),je={class:"d-flex align-center"},Ye={class:"d-flex flex-column"},Ze={class:"text-base"},He={class:"d-flex align-center"},Qe={class:"d-flex flex-column"},We={class:"text-base"},Ge={class:"d-flex align-center"},Je={class:"d-flex flex-column"},Ke={class:"text-base"},Xe={class:"d-flex align-center"},et={class:"d-flex flex-column"},tt={class:"text-base"},at={class:"d-flex align-center"},lt={class:"d-flex flex-column"},ot={class:"text-base"},nt={class:"d-flex align-center"},st={class:"d-flex flex-column"},it={class:"text-base"},rt={class:"d-flex align-center"},dt={class:"d-flex flex-column"},ut={class:"text-base"},ct={class:"text-center",style:{width:"5rem"}},ft=l("tr",null,[l("td",{colspan:"7",class:"text-center"}," No data available ")],-1),mt=[ft],pt={class:"text-sm text-disabled"},oa={__name:"[id]",setup(W){const g=ie(),k=u(""),P=u(!1),t=u({isActive:!0}),$=se(),S=u(!0);u();const E=u("mahgounoussama23@gmail.com");u(),u();const U=u(10),m=u(1),y=u(1),T=u(0);let p=u([]),A=u({open:!1}),b=u({open:!1}),d=u({open:!1}),i=u(!1),c=u(!0);const r=()=>{t.value.isActive=!0,g.fetchEmployeesByAttendance(Number($.params.id)).then(f=>{p.value=f.data.employees.data,y.value=f.data.totalPage,T.value=f.data.totalEmployees,P.value=!1,t.value.isActive=!1,console.log(f)}).catch(f=>{console.error(f),t.value.isActive=!1})};q(r),q(()=>{m.value>y.value&&(m.value=y.value)}),De(k,()=>{r()}),u(!1);let _=u(null);q(()=>{m.value>y.value&&(m.value=y.value)});const M=be(()=>{const f=p.value.length?(m.value-1)*U.value+1:0,n=p.value.length+(m.value-1)*U.value;return`Showing ${f} to ${n} of ${T.value} entries`}),ue=f=>{_.value=f,A.value.open=!0},ce=f=>{_.value=f,b.value.open=!0},fe=()=>{d.value.open=!0},me=()=>{t.value.isActive=!0,b.value.open=!1,g.deleteCareer(_.value.id).then(f=>{t.value.isActive=!1,H(f.data.message),r()}).catch(f=>{B(f.data.message),t.value.isActive=!1})},G=()=>{b.value.open=!1},J=(f,n)=>{let z=new Date(n);n||(z=new Date);const a=z-new Date(f),N=Math.floor(a/(1e3*60*60*24)),K=Math.floor(N/365),X=Math.floor(N%365/30),ee=N%30;let R="";return K>0&&(R+=("0"+K).slice(-2)+" years, "),X>0&&(R+=("0"+X).slice(-2)+" months, "),ee>0&&(R+=("0"+ee).slice(-2)+" days"),R=R.replace(/,\s*$/,""),R},pe=f=>{console.log(f),t.value.isActive=!0,g.generateEmail(f.id,E.value).then(n=>{t.value.isActive=!1,H(n.data.message)}).catch(n=>{B(n.data.message),t.value.isActive=!1})};return(f,n)=>{const z=Ae;return w(),j("section",null,[e(de,null,{default:o(()=>[e(ke,{"model-value":s(t).isActive,class:"align-center justify-center"},{default:o(()=>[e(ae,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),e(h,{cols:"12"},{default:o(()=>[e(Q,{title:"Employees"},{default:o(()=>[e(Z),e(O,{class:"d-flex flex-wrap py-4 gap-4"},{default:o(()=>[l("div",Ie,[e(Se,{modelValue:s(U),"onUpdate:modelValue":n[0]||(n[0]=a=>v(U)?U.value=a:null),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"])]),l("div",Be,[e(L,{onInput:n[1]||(n[1]=a=>S.value=!0),ref:"searchField",modelValue:s(E),"onUpdate:modelValue":n[2]||(n[2]=a=>v(E)?E.value=a:null),placeholder:"Email",density:"compact"},null,8,["modelValue"])]),e(re),l("div",Le,[l("div",Me,[s(P)?(w(),F(ae,{key:0,indeterminate:"",color:"primary"})):(w(),F(L,{key:1,onInput:n[3]||(n[3]=a=>S.value=!0),ref:"searchField",modelValue:s(k),"onUpdate:modelValue":n[4]||(n[4]=a=>v(k)?k.value=a:null),placeholder:"Search",density:"compact"},null,8,["modelValue"]))]),e(D,{variant:"tonal",color:"secondary","prepend-icon":"tabler-screen-share"},{default:o(()=>[V(" Export ")]),_:1}),e(D,{color:"primary","prepend-icon":"tabler-plus",onClick:n[5]||(n[5]=a=>fe())},{default:o(()=>[V(" New Record ")]),_:1})])]),_:1}),e(Z),e(Ne,{class:"text-no-wrap"},{default:o(()=>[qe,l("tbody",null,[(w(!0),j(he,null,xe(s(p),a=>(w(),j("tr",{key:a.id,style:{height:"3.75rem"}},[l("td",null,x(a.id),1),l("td",null,[l("div",je,[l("div",Ye,[l("h6",Ze,x(a.start_date),1)])])]),l("td",null,[l("div",He,[l("div",Qe,[l("h6",We,x(a.end_date),1)])])]),l("td",null,[l("div",Ge,[l("div",Je,[l("h6",Ke,x(J(a.start_date,a.end_date)),1)])])]),l("td",null,[l("div",Xe,[l("div",et,[l("h6",tt,x(a.real_start_date),1)])])]),l("td",null,[l("div",at,[l("div",lt,[l("h6",ot,x(a.real_end_date),1)])])]),l("td",null,[l("div",nt,[l("div",st,[l("h6",it,x(J(a.real_start_date,a.real_end_date)),1)])])]),l("td",null,[l("div",rt,[l("div",dt,[l("h6",ut,x(a.position),1)])])]),l("td",ct,[a.last?(w(),F(D,{key:0,icon:"",size:"x-small",color:"default",variant:"text",onClick:N=>ue(a)},{default:o(()=>[e(C,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"])):Y("",!0),e(D,{icon:"",size:"x-small",color:"default",variant:"text",to:{name:"apps-employee-vacation-id",params:{id:a.id}}},{default:o(()=>[e(C,{size:"22",icon:"tabler-user-check"})]),_:2},1032,["to"]),e(D,{icon:"",size:"x-small",color:"default",variant:"text"},{default:o(()=>[e(C,{size:"22",icon:"tabler-trash",onClick:N=>ce(a)},null,8,["onClick"])]),_:2},1024),e(D,{icon:"",size:"x-small",color:"default",variant:"text"},{default:o(()=>[e(C,{size:"22",icon:"tabler-send",onClick:N=>pe(a)},null,8,["onClick"])]),_:2},1024),e(D,{icon:"",variant:"text",color:"default",size:"x-small"},{default:o(()=>[e(C,{size:22,icon:"tabler-dots-vertical"}),e(Re,{activator:"parent"},{default:o(()=>[e(Fe,{density:"compact"},{default:o(()=>[a.BC?(w(),F(ne,{key:0,value:"BC",href:a.BC},{prepend:o(()=>[e(C,{size:"22",class:"me-3",icon:"tabler-download"})]),default:o(()=>[e(oe,null,{default:o(()=>[V("Birth Certificate")]),_:1})]),_:2},1032,["href"])):Y("",!0),a.NC?(w(),F(ne,{key:1,value:"NC",href:a.NC},{prepend:o(()=>[e(C,{size:"22",class:"me-3",icon:"tabler-download"})]),default:o(()=>[e(oe,null,{default:o(()=>[V("National Card")]),_:1})]),_:2},1032,["href"])):Y("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]))),128))]),we(l("tfoot",null,mt,512),[[ye,!s(p).length]])]),_:1}),e(Z),e(O,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3 px-5"},{default:o(()=>[l("span",pt,x(s(M)),1),e($e,{modelValue:s(m),"onUpdate:modelValue":n[6]||(n[6]=a=>v(m)?m.value=a:null),size:"small","total-visible":5,length:s(y)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Ce,{isDrawerOpen:s(A),"onUpdate:isDrawerOpen":n[7]||(n[7]=a=>v(A)?A.value=a:A=a),employee:s(_),"onUpdate:employee":n[8]||(n[8]=a=>v(_)?_.value=a:_=a),"disable-end-date":s(i),"onUpdate:disable-end-date":n[9]||(n[9]=a=>v(i)?i.value=a:i=a),loading:s(t),"onUpdate:loading":n[10]||(n[10]=a=>v(t)?t.value=a:null),"disable-start-date":s(c),"onUpdate:disable-start-date":n[11]||(n[11]=a=>v(c)?c.value=a:c=a)},null,8,["isDrawerOpen","employee","disable-end-date","loading","disable-start-date"]),e(ze,{isDrawerOpen:s(d),"onUpdate:isDrawerOpen":n[12]||(n[12]=a=>v(d)?d.value=a:d=a),employees:s(p),"onUpdate:employees":n[13]||(n[13]=a=>v(p)?p.value=a:p=a),loading:s(t),"onUpdate:loading":n[14]||(n[14]=a=>v(t)?t.value=a:null)},null,8,["isDrawerOpen","employees","loading"]),e(Te,{modelValue:s(b).open,"onUpdate:modelValue":n[17]||(n[17]=a=>s(b).open=a),persistent:"",class:"v-dialog-sm"},{default:o(()=>[e(z,{onClick:n[15]||(n[15]=a=>G())}),e(Q,{title:"Confirmation"},{default:o(()=>[e(O,null,{default:o(()=>[V(" Are you sure you want to delete this record ? ")]),_:1}),e(O,{class:"d-flex justify-end gap-3 flex-wrap"},{default:o(()=>[e(D,{color:"secondary",variant:"tonal",onClick:n[16]||(n[16]=a=>G())},{default:o(()=>[V(" Disagree ")]),_:1}),e(D,{onClick:me},{default:o(()=>[V(" Agree ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{oa as default};
