import{bd as O,k as u,r as T,o as $,b as A,w as o,m as b,p as a,C as U,q as r,P,D as B,be as E,E as i,ay as R}from"./main.0cc37d68.js";import{s as Y}from"./successMiddleware.07d7820d.js";import{e as _}from"./errorsMiddleware.dfcaf12b.js";import{u as q}from"./useVacationStore.c32c2174.js";import{V as I}from"./VSpacer.a1b25d3b.js";import{V as f}from"./VBtn.bfc904f9.js";import{V as z,c as W}from"./VCard.82c7427c.js";import{V as j}from"./VForm.47630f91.js";import{V as L,a as c}from"./VRow.4110b62f.js";import{V as y}from"./VInput.9827f2d3.js";import{V as Z}from"./VTextField.33e694f1.js";import{V as G}from"./VNavigationDrawer.c54d7fac.js";const H={class:"d-flex align-center pa-6 pb-1"},J=b("h6",{class:"text-h6"}," Add New Record ",-1),ue={__name:"AddNewVacation",props:{isDrawerOpen:{type:null,required:!0},loading:{type:null,required:!0}},setup(h){const s=h,C=q(),x=O(),e=u({start_date:new Date().getFullYear()+"-"+(new Date().getMonth()+1)+"-"+new Date().getDate(),end_date:"",end_date_restrict:new Date().getFullYear()+"-"+(new Date().getMonth()+1)+"-"+(new Date().getDate()+1),count:0}),m=u(!1),p=u();u(),u({id:-1});const V=()=>{s.isDrawerOpen.open=!1,R(()=>{var t,l;(t=p.value)==null||t.reset(),(l=p.value)==null||l.resetValidation()})},N=()=>{e.value.start_date===""||e.value.start_date===null||e.value.end_date===""||e.value.end_date===null||e.value.count<=0?((e.value.start_date===""||e.value.start_date===null)&&_("Warning","start date must be selected"),e.value.count<=0&&_("Warning","count days starts from 1 ")):(s.loading.isActive=!0,console.log(s.loading),C.addNew(D(e.value.start_date),D(e.value.end_date),Number(x.params.id),e.value.count).then(t=>{s.isDrawerOpen.open=!1,s.loading.isActive=!1,Y(t.data.msg),location.reload()}).catch(t=>{s.loading.isActive=!1,_("Error Occured",t.response.data.message)}))},S=t=>{s.isDrawerOpen.value.open=t};function v(t){return parseInt(t)<10?"0"+t:t}const g=t=>{const l=t.getDate(),d=t.getMonth()+1;return`${t.getFullYear()}-${v(d)}-${v(l)}`},k=()=>{e.value.start_date===null&&(e.value.end_date=null),(e.value.start_date===""||e.value.start_date>=e.value.end_date&&e.value.end_date!=="")&&(e.value.end_date=""),w(),e.value.end_date_restrict=new Date(new Date(e.value.start_date).getTime()+24*60*60*2e3).toISOString().split("T")[0]},D=t=>{if(t!=null&&t!==""){console.log(t);let l=new Date(t),d=l.getFullYear(),n=String(l.getMonth()+1).padStart(2,"0"),M=String(l.getDate()).padStart(2,"0");return`${d}-${n}-${M}`}return t},F=()=>{w()},w=()=>{if(e.value.start_date){let t=new Date(e.value.start_date);e.value.end_date=new Date(t.getTime()+e.value.count*24*60*60*1e3)}console.log(e.value.end_date)};return(t,l)=>{const d=T("VueDatePicker");return $(),A(G,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":s.isDrawerOpen.open,"onUpdate:modelValue":S},{default:o(()=>[b("div",H,[J,a(I),a(f,{variant:"tonal",color:"default",icon:"",size:"32",class:"rounded",onClick:V},{default:o(()=>[a(U,{size:"18",icon:"tabler-x"})]),_:1})]),a(r(P),{options:{wheelPropagation:!1}},{default:o(()=>[a(z,{flat:""},{default:o(()=>[a(W,null,{default:o(()=>[a(j,{ref_key:"refForm",ref:p,modelValue:r(m),"onUpdate:modelValue":l[3]||(l[3]=n=>B(m)?m.value=n:null),onSubmit:E(N,["prevent"])},{default:o(()=>[a(L,null,{default:o(()=>[a(c,{cols:"12"},{default:o(()=>[a(y,null,{default:o(()=>[i(" Vacation Start Date ")]),_:1}),a(d,{modelValue:r(e).start_date,"onUpdate:modelValue":[l[0]||(l[0]=n=>r(e).start_date=n),k],"auto-apply":"",format:g},null,8,["modelValue"])]),_:1}),a(c,{cols:"12"},{default:o(()=>[a(Z,{modelValue:r(e).count,"onUpdate:modelValue":[l[1]||(l[1]=n=>r(e).count=n),F],type:"number",label:"Vacation Days"},null,8,["modelValue"])]),_:1}),a(c,{cols:"12"},{default:o(()=>[a(y,null,{default:o(()=>[i(" Vacation End Date ")]),_:1}),a(d,{modelValue:r(e).end_date,"onUpdate:modelValue":l[2]||(l[2]=n=>r(e).end_date=n),"auto-apply":"",disabled:"true",format:g,"min-date":r(e).end_date_restrict},null,8,["modelValue","min-date"])]),_:1}),a(c,{cols:"12"},{default:o(()=>[a(f,{type:"submit",class:"me-3"},{default:o(()=>[i(" Submit ")]),_:1}),a(f,{type:"reset",variant:"tonal",color:"secondary",onClick:V},{default:o(()=>[i(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};export{ue as _};
