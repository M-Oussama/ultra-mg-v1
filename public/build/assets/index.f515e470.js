import{k as r,$ as F,Z as rt,A as dt,r as ut,o as i,c as _,p as a,w as s,q as n,m as e,D as c,b as p,E as I,y as R,F as S,a as $,x as d,C as A,H as ct,I as pt,bf as Q}from"./main.e6f2226b.js";import{_ as mt}from"./DialogCloseBtn.bdeee9c4.js";import{u as ft,_ as vt,a as _t,b as ht,c as xt}from"./ClientMonthlyReport.2b86d7ce.js";import{P as T}from"./permissions.bafe5f34.js";import"./jspdf.es.min.af3ca23a.js";import"./jspdf.plugin.autotable.78d154ff.js";import{a as Vt}from"./VOverlay.6f5b1171.js";import{a as Z,V}from"./VBtn.8ee7d1bc.js";import{a as M,V as G}from"./VRow.0dee9a23.js";import{V as K,c as j}from"./VCard.98fdd3d2.js";import{V as B}from"./VDivider.3beb977f.js";import{V as gt}from"./VSelect.2e98f326.js";import{V as Ct}from"./VSpacer.5af32ac4.js";import{V as bt}from"./VTextField.8783cc1b.js";import{V as W}from"./VTable.be0f615e.js";import{V as wt}from"./VAvatar.bf7ae53a.js";import{V as yt}from"./VImg.37abf546.js";import{V as kt}from"./VPagination.5d4e2824.js";import{V as Dt,a as At}from"./VTabs.3a141a88.js";import{V as Tt,a as O}from"./VWindowItem.275f50cb.js";import{V as Et}from"./VDialog.adc227a5.js";import"./validators.330a354f.js";import"./index.b522f886.js";import"./VForm.677822bd.js";import"./VInput.8559a63c.js";import"./router.5ba86b57.js";import"./index.96305a7f.js";import"./forwardRefs.c003b6b8.js";import"./VAutocomplete.1cc546f2.js";import"./filter.edbe12b3.js";import"./VList.2ba046ce.js";import"./VMenu.319a5e50.js";import"./scopeId.f937809a.js";import"./dialog-transition.f250e308.js";import"./easing.36b781ab.js";import"./VCheckboxBtn.b0823098.js";import"./VSelectionControl.14a64459.js";import"./VChip.93584157.js";import"./VNavigationDrawer.84b927c3.js";import"./ssrBoot.671feef1.js";import"./vue3-apexcharts.common.82561751.js";import"./vue.runtime.esm-bundler.8bab5225.js";import"./lazy.e5202e15.js";import"./position.00c850f0.js";/* empty css                   */import"./VField.0c7bfcf3.js";import"./VCounter.57b6c0d3.js";import"./VSlideGroup.da2457c8.js";const Lt={class:"me-3",style:{width:"80px"}},Ut={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},zt={style:{width:"9rem"}},It=e("thead",null,[e("tr",null,[e("th",{scope:"col"}," ID "),e("th",{scope:"col"}," Client "),e("th",{scope:"col"}," City "),e("th",{scope:"col"}," Phone "),e("th",{scope:"col"}," Balance "),e("th",{scope:"col"}," ACTIONS ")])],-1),St={class:"d-flex align-center"},$t={key:1},Nt={class:"d-flex flex-column"},Pt={class:"text-base"},Rt={class:"text-sm text-disabled"},Bt={class:"text-capitalize text-base font-weight-semibold"},Ot={class:"text-capitalize text-base font-weight-semibold"},Ft={class:"text-capitalize text-base font-weight-semibold"},jt={class:"text-center",style:{width:"5rem"}},Wt=e("tr",null,[e("td",{colspan:"7",class:"text-center"}," No data available ")],-1),Jt=[Wt],qt={class:"text-sm text-disabled"},Ht=e("thead",null,[e("tr",null,[e("th",{class:"text-caption"}," Product "),e("th",{class:"text-caption"}," Date "),e("th",{class:"text-caption"}," Quantity "),e("th",{class:"text-caption"}," Price "),e("th",{class:"text-caption"}," Total ")])],-1),Qt={class:"text-caption"},Zt={class:"text-caption"},Mt={class:"text-caption"},Gt={class:"text-caption"},Kt={class:"text-caption"},Xt=e("td",null,null,-1),Yt=e("td",null,null,-1),te=e("td",null,null,-1),ee=e("td",{class:"text-caption"}," Total ",-1),le={class:"text-caption"},ae=e("td",null,null,-1),oe=e("td",null,null,-1),se=e("td",null,null,-1),ne=e("td",{class:"text-caption"}," Payment ",-1),ie={class:"text-caption"},re=e("td",null,null,-1),de=e("td",null,null,-1),ue=e("td",null,null,-1),ce=e("td",{class:"text-caption"}," Rest ",-1),pe={class:"text-caption"},me=e("thead",null,[e("tr",null,[e("th",null," Date "),e("th",null," Amount ")])],-1),fe={__name:"index",setup(ve){const w=ft(),E=r(""),J=r(!1),X=r(!0),C=r(!1);r(),r(),r();const y=r(10),f=r(1),k=r(1),q=r(0),b=r([]);let D=r([]),Y=r([]),g=r("Appetizers"),v=r({isActive:!1});const h=[{id:1,name:"Home"},{id:2,name:"Record"},{id:3,name:"Payments"},{id:4,name:"State"}],L=()=>{v.value.isActive=!0,w.fetchClients({searchValue:E.value,perPage:y.value,currentPage:f.value}).then(o=>{v.value.isActive=!1,D.value=o.data.clients.data,console.log(o.data.clientsAll),Y.value=o.data.clientsAll,console.log(D.value),k.value=o.data.totalPage,b.value=o.data.cities,q.value=o.data.totalClients,J.value=!1}).catch(o=>{console.error(o),v.value.isActive=!1})};F(L),F(()=>{f.value>k.value&&(f.value=k.value)}),rt(E,()=>{L()});const N=r(!1),P=r(!1),U=r(!1);let u=r();F(()=>{f.value>k.value&&(f.value=k.value)});const tt=dt(()=>{const o=D.value.length?(f.value-1)*y.value+1:0,l=D.value.length+(f.value-1)*y.value;return`Showing ${o} to ${l} of ${q.value} entries`}),et=o=>{w.addClient(o).then(l=>{L()}).catch(l=>{console.log(l)})},lt=o=>{w.updateClient(o).then(l=>{L()}).catch(l=>{console.log(l)})},at=o=>{w.deleteClient(o).then(l=>{L()}).catch(l=>{console.log(l)})},ot=o=>{P.value=!0,u=o},st=o=>{U.value=!0,u=o},nt=o=>{C.value=!0,u=o},H=o=>{var l=o.id;v.value.isActive=!0,w.getLogList(l).then(x=>{v.value.isActive=!1;const z=window.URL.createObjectURL(new Blob([x.data])),t=document.createElement("a");t.href=z,t.setAttribute("download","ETAT "+o.name+".pdf"),document.body.appendChild(t),t.click()}).catch(x=>{console.error(x),v.value.isActive=!1})},it=o=>{var l=o.id;v.value.isActive=!0,w.getLogListWithReturn(l).then(x=>{v.value.isActive=!1;const z=window.URL.createObjectURL(new Blob([x.data])),t=document.createElement("a");t.href=z,t.setAttribute("download","ETAT "+o.name+".pdf"),document.body.appendChild(t),t.click()}).catch(x=>{console.error(x),v.value.isActive=!1})};return(o,l)=>{const x=ut("RouterLink"),z=mt;return i(),_("section",null,[a(G,null,{default:s(()=>[a(Vt,{"model-value":n(v).isActive,class:"align-center justify-center"},{default:s(()=>[a(Z,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),a(M,{cols:"12"},{default:s(()=>[a(K,{title:"Clients"},{default:s(()=>[a(B),a(j,{class:"d-flex flex-wrap py-4 gap-4"},{default:s(()=>[e("div",Lt,[a(gt,{modelValue:n(y),"onUpdate:modelValue":l[0]||(l[0]=t=>c(y)?y.value=t:null),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"])]),a(Ct),e("div",Ut,[e("div",zt,[n(J)?(i(),p(Z,{key:0,indeterminate:"",color:"primary"})):(i(),p(bt,{key:1,onInput:l[1]||(l[1]=t=>X.value=!0),ref:"searchField",modelValue:n(E),"onUpdate:modelValue":l[2]||(l[2]=t=>c(E)?E.value=t:null),placeholder:"Search",density:"compact"},null,8,["modelValue"]))]),a(V,{variant:"tonal",color:"secondary","prepend-icon":"tabler-screen-share",onClick:H},{default:s(()=>[I(" Export ")]),_:1}),o.$can(n(T).CLIENT.ADD,n(T).CLIENT.SUBJECT)?(i(),p(V,{key:0,"prepend-icon":"tabler-plus",onClick:l[3]||(l[3]=t=>N.value=!0)},{default:s(()=>[I(" Add New Client ")]),_:1})):R("",!0)])]),_:1}),a(B),a(W,{class:"text-no-wrap"},{default:s(()=>[It,e("tbody",null,[(i(!0),_(S,null,$(n(D),t=>(i(),_("tr",{key:t.id,style:{height:"3.75rem"}},[e("td",null,d(t.id),1),e("td",null,[e("div",St,[a(wt,{variant:"tonal",class:"me-3",size:"38"},{default:s(()=>[t.avatar?(i(),p(yt,{key:0,src:t.avatar},null,8,["src"])):(i(),_("span",$t,d(t.name.toUpperCase().charAt(0)),1))]),_:2},1024),e("div",Nt,[e("h6",Pt,[a(x,{to:{name:"apps-user-view-id",params:{id:t.id}},class:"font-weight-medium user-list-name"},{default:s(()=>[I(d(t.name),1)]),_:2},1032,["to"])]),e("span",Rt,"@"+d(t.email),1)])])]),e("td",null,[e("span",Bt,d(t.city.name),1)]),e("td",null,[e("span",Ot,d(t.phone),1)]),e("td",null,[e("span",Ft,d(parseFloat(t.balance.balance).toFixed(2))+" DZD",1)]),e("td",jt,[a(V,{icon:"",size:"x-small",color:"default",variant:"text",onClick:m=>it(t)},{default:s(()=>[a(A,{size:"22",icon:"tabler-briefcase"})]),_:2},1032,["onClick"]),a(V,{icon:"",size:"x-small",color:"default",variant:"text",onClick:m=>H(t)},{default:s(()=>[a(A,{size:"22",icon:"tabler-currency-dollar"})]),_:2},1032,["onClick"]),a(V,{icon:"",size:"x-small",color:"default",variant:"text",onClick:m=>nt(t)},{default:s(()=>[a(A,{size:"22",icon:"tabler-shopping-cart"})]),_:2},1032,["onClick"]),o.$can(n(T).CLIENT.EDIT,n(T).CLIENT.SUBJECT)?(i(),p(V,{key:0,icon:"",size:"x-small",color:"default",variant:"text",onClick:m=>ot(t)},{default:s(()=>[a(A,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"])):R("",!0),o.$can(n(T).CLIENT.DELETE,n(T).CLIENT.SUBJECT)?(i(),p(V,{key:1,icon:"",size:"x-small",color:"default",variant:"text",onClick:m=>st(t)},{default:s(()=>[a(A,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"])):R("",!0),a(V,{icon:"",size:"x-small",color:"default",variant:"text"},{default:s(()=>[a(A,{size:"22",icon:"tabler-dots-vertical"})]),_:1})])]))),128))]),ct(e("tfoot",null,Jt,512),[[pt,!n(D).length]])]),_:1}),a(B),a(j,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3 px-5"},{default:s(()=>[e("span",qt,d(n(tt)),1),a(kt,{modelValue:n(f),"onUpdate:modelValue":l[4]||(l[4]=t=>c(f)?f.value=t:null),size:"small","total-visible":5,length:n(k)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1}),a(Et,{modelValue:n(C),"onUpdate:modelValue":l[9]||(l[9]=t=>c(C)?C.value=t:null),scrollable:"",class:"v-dialog-sm","max-width":"700",width:"auto","content-class":"scrollable-dialog"},{default:s(()=>[a(z,{onClick:l[5]||(l[5]=t=>C.value=!n(C))}),a(K,{title:" "},{default:s(()=>[a(j,{class:"d-flex justify-end gap-3 flex-wrap"},{default:s(()=>[a(Dt,{modelValue:n(g),"onUpdate:modelValue":l[6]||(l[6]=t=>c(g)?g.value=t:g=t),grow:""},{default:s(()=>[(i(),_(S,null,$(h,t=>a(At,{key:t.id,value:t.id},{default:s(()=>[I(d(t.name),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),a(B),a(Tt,{modelValue:n(g),"onUpdate:modelValue":l[7]||(l[7]=t=>c(g)?g.value=t:g=t),class:"mt-6 pl-3 pa-1"},{default:s(()=>[(i(),p(O,{key:h[0].id,value:h[0].id,width:"150%"},{default:s(()=>[a(G,null,{default:s(()=>[a(M,{cols:"6",md:"6"},{default:s(()=>[a(vt)]),_:1})]),_:1})]),_:1},8,["value"])),(i(),p(O,{key:h[1].id,value:h[1].id,class:"mt-0",style:{"margin-top":"0 !important"}},{default:s(()=>[(i(!0),_(S,null,$(n(u).sales,t=>(i(),p(W,{class:"text-no-wrap mt-0 mb-10"},{default:s(()=>[Ht,e("tbody",null,[(i(!0),_(S,null,$(t.sale_items,m=>(i(),_("tr",{key:m.id},[e("td",Qt,d(m.product.name),1),e("td",Zt,d(m.sale_date),1),e("td",Mt,d(m.quantity),1),e("td",Gt,d(m.price),1),e("td",Kt,d(m.total_price),1)]))),128)),e("tr",null,[Xt,Yt,te,ee,e("td",le,d(t.total_amount),1)]),e("tr",null,[ae,oe,se,ne,e("td",ie,d(t.regulation),1)]),e("tr",null,[re,de,ue,ce,e("td",pe,d(t.balance),1)])])]),_:2},1024))),256))]),_:1},8,["value"])),(i(),p(O,{key:h[2].id,value:h[2].id,class:"mt-0",style:{width:"-webkit-fill-available"},width:"100%"},{default:s(()=>[a(W,{class:"text-no-wrap mt-0",style:{width:"-webkit-fill-available"}},{default:s(()=>[me,e("tbody",null,[(i(!0),_(S,null,$(n(u).payments,t=>(i(),_("tr",{key:t.id},[e("td",null,d(t.payment_date),1),e("td",null,d(t.amount_paid),1)]))),128))])]),_:1})]),_:1},8,["value"])),(i(),p(O,{key:h[3].id,value:h[3].id},null,8,["value"]))]),_:1},8,["modelValue"]),a(V,{onClick:l[8]||(l[8]=t=>C.value=!1)},{default:s(()=>[I(" Close ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(_t,{isDrawerOpen:n(N),"onUpdate:isDrawerOpen":l[10]||(l[10]=t=>c(N)?N.value=t:null),cities:n(b),"onUpdate:cities":l[11]||(l[11]=t=>c(b)?b.value=t:null),onClientData:et},null,8,["isDrawerOpen","cities"]),a(ht,{isDrawerOpen:n(P),"onUpdate:isDrawerOpen":l[12]||(l[12]=t=>c(P)?P.value=t:null),client:n(u),"onUpdate:client":l[13]||(l[13]=t=>c(u)?u.value=t:u=t),cities:n(b),"onUpdate:cities":l[14]||(l[14]=t=>c(b)?b.value=t:null),onClientData:lt},null,8,["isDrawerOpen","client","cities"]),n(U)?(i(),p(xt,{key:0,isDialogVisible:n(U),"onUpdate:isDialogVisible":l[15]||(l[15]=t=>c(U)?U.value=t:null),client:n(u),"onUpdate:client":l[16]||(l[16]=t=>c(u)?u.value=t:u=t),onClientData:at},null,8,["isDialogVisible","client"])):R("",!0)])}}};typeof Q=="function"&&Q(fe);export{fe as default};
