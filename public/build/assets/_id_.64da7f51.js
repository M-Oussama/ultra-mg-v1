import{A as Q,Z as F,o as g,c as L,m as e,p as t,w as s,x as c,q as d,C as Y,F as B,k as p,b as D,V as z,v as G,D as k,a as H,bd as J,j as W,E as S,y as O}from"./main.bc5a6167.js";import{_ as X}from"./AppDateTimePicker.7a3a8451.js";import"./useSaleStore.0d02a10c.js";import{e as A}from"./errorsMiddleware.dc74006f.js";import{s as ee}from"./successMiddleware.76cc9273.js";import{_ as te}from"./InvoiceSendInvoiceDrawer.d9626c7d.js";/* empty css                        */import{a as f,V as P}from"./VRow.54306fd6.js";import{V as N}from"./VTextField.cfceb116.js";import{V as E,a as ae}from"./VBtn.f2bdc60e.js";import{V as j,c as I}from"./VCard.7d98e4d8.js";import{u as M}from"./useCertifyInvoiceListStore.98dfa0b8.js";import{q as K}from"./VueSearchSelect.cffa6350.js";import{V as C}from"./VDivider.4d5529ad.js";import{V as se}from"./VTextarea.c207fe45.js";import{a as oe}from"./VOverlay.73582a32.js";import{V as le}from"./VSelect.ff8b272a.js";import{V as $}from"./VInput.2754c40c.js";import{V as R}from"./VSwitch.bab713f6.js";import"./VField.ee41957d.js";import"./index.aabd9a56.js";import"./position.9c03e7aa.js";import"./router.97736653.js";import"./easing.36b781ab.js";import"./VSpacer.6a899248.js";import"./VAvatar.ac7ddd4f.js";import"./VImg.e07274e6.js";import"./VForm.0f28fc52.js";import"./forwardRefs.c003b6b8.js";import"./VChip.dd0a5f41.js";import"./VNavigationDrawer.159baa28.js";import"./ssrBoot.53da8efe.js";/* empty css                   */import"./VCounter.4d14b846.js";import"./lazy.de2d5758.js";import"./VList.df00305c.js";import"./dialog-transition.65609221.js";import"./VMenu.cd626b3e.js";import"./scopeId.401ed28f.js";import"./VCheckboxBtn.c7e1a53e.js";import"./VSelectionControl.75656c3f.js";const de={class:"add-products-header mb-2 d-none d-md-flex"},ne=e("span",{class:"text-sm"}," Item ",-1),ie=e("span",{class:"text-sm"}," Price ",-1),ce=e("span",{class:"text-sm"}," Quantity ",-1),re=e("span",{class:"text-sm"}," Total ",-1),ue={class:"pa-5 flex-grow-1"},me={class:"text-sm-center my-2"},pe=e("span",{class:"d-inline d-md-none"},"Price: ",-1),_e={class:"text-body-1"},fe={class:"d-flex flex-column justify-space-between border-s pa-1"},ve={__name:"InvoiceProductEdit",props:{id:{type:Number,required:!0},data:{type:Object,required:!0,default:()=>({id:"",name:"",brand:"",description:"",product_code:"",SKU:"",price:15,stockable:!1,tax_rate:.5,product_stock:{quantity:0}})}},emits:["removeProduct","totalAmount"],setup(T,{emit:a}){const m=T,n=m.data.quantity;m.data.oldQuantity=n;const x=Q(()=>Number(m.data.price)*Number(m.data.quantity)),r=()=>{a("removeProduct",m.data)},i=()=>{a("totalAmount",m.data)};return F(x,()=>{i()},{immediate:!0}),(w,v)=>(g(),L(B,null,[e("div",de,[t(P,{class:"font-weight-medium px-4"},{default:s(()=>[t(f,{cols:"12",md:"6"},{default:s(()=>[ne]),_:1}),t(f,{cols:"12",md:"2"},{default:s(()=>[ie]),_:1}),t(f,{cols:"12",md:"2"},{default:s(()=>[ce]),_:1}),t(f,{cols:"12",md:"2"},{default:s(()=>[re]),_:1})]),_:1})]),t(j,{flat:"",border:"",class:"d-flex flex-row"},{default:s(()=>[e("div",ue,[t(P,null,{default:s(()=>[t(f,{cols:"12",md:"6",sm:"4"},{default:s(()=>[t(N,{modelValue:m.data.product.name,"onUpdate:modelValue":v[0]||(v[0]=b=>m.data.product.name=b),type:"string",label:"Product",disabled:""},null,8,["modelValue"])]),_:1}),t(f,{cols:"12",md:"2",sm:"4"},{default:s(()=>[t(N,{modelValue:m.data.price,"onUpdate:modelValue":v[1]||(v[1]=b=>m.data.price=b),type:"number",label:"Price"},null,8,["modelValue"])]),_:1}),t(f,{cols:"12",md:"2",sm:"4"},{default:s(()=>[t(N,{modelValue:m.data.quantity,"onUpdate:modelValue":v[2]||(v[2]=b=>m.data.quantity=b),type:"number",label:"Quantity"},null,8,["modelValue"])]),_:1}),t(f,{cols:"12",md:"2",sm:"4"},{default:s(()=>[e("p",me,[pe,e("span",_e,c(d(x).toFixed(2))+" DZD",1)])]),_:1})]),_:1})]),e("div",fe,[t(E,{icon:"",size:"x-small",color:"default",variant:"text",onClick:r},{default:s(()=>[t(Y,{size:"20",icon:"tabler-x"})]),_:1})])]),_:1})],64))}};const ye={class:"ma-sm-4"},be={class:"d-flex align-center mb-6"},he={class:"font-weight-bold text-xl"},xe={class:"mb-0"},Ve={class:"mb-0"},ge={class:"mb-0"},we={class:"mt-4 ma-sm-4"},Se={class:"d-flex align-center font-weight-medium justify-sm-end text-xl mb-3"},Ie=e("span",{class:"me-3"},"Invoice",-1),Ne={class:"d-flex align-center justify-sm-end mb-3"},Ae=e("span",{class:"me-3"},"Date Issued",-1),ke={class:"align-center mb-6"},Pe=e("h6",{class:"text-sm font-weight-medium mb-3"}," Invoice To: ",-1),Te=e("div",{class:"align-center mb-6"},[e("h6",{class:"text-sm font-weight-medium mb-3"}," City: ")],-1),Ce={class:"mt-4 ma-sm-4"},De=e("h6",{class:"text-sm font-weight-medium mb-3"}," Bill To: ",-1),Ee=e("td",{class:"pe-6"}," Invoice: ",-1),Ue={class:"font-weight-semibold"},qe=e("td",{class:"pe-6"}," Payment Method: ",-1),$e={class:"font-weight-semibold"},Re=e("td",{class:"pe-6"}," Client: ",-1),Fe={class:"font-weight-semibold"},Le=e("td",{class:"pe-6"}," Address: ",-1),je=e("td",{class:"pe-6"}," N\xB0RC: ",-1),Oe=e("td",{class:"pe-6"}," N\xB0IF: ",-1),Ke=e("td",{class:"pe-6"}," N\xB0IS: ",-1),Be=e("td",{class:"pe-6"}," N\xB0ART: ",-1),Me={class:"mt-4 ma-sm-4"},Ze=e("span",{class:"text-sm-caption mb-2"},"Products",-1),Qe=e("div",{class:"mt-7 ma-sm-7"},null,-1),Ye={class:"mx-sm-4 my-2"},ze={class:"d-flex align-center mb-4"},Ge=e("h6",{class:"text-sm font-weight-semibold me-2"}," Salesperson: ",-1),He={class:"my-2 mx-sm-4"},Je=e("td",{class:"text-end"},[e("div",{class:"me-5"},[e("p",{class:"mb-2"}," Montant HT: "),e("p",{class:"mb-2"}," TVA 19%: "),e("p",{class:"mb-2"}," Montant TTC: ")])],-1),We={class:"font-weight-semibold"},Xe={class:"mb-2"},et={class:"mb-2"},tt={class:"mb-2"},at=e("p",{class:"font-weight-semibold mb-2"}," Note: ",-1),st={__name:"InvoiceEditable",props:{data:{type:null,required:!0},loading:{type:null,required:!0}},setup(T){const a=T,m=M();let n=p(0),x=p(a.data.date);p({id:-1,name:"",brand:"",description:"",product_code:"",SKU:"",price:0,stockable:!1,tax_rate:0,product_stock:{quantity:0}}),p([]),p([]);const r=p({name:"EURL SETIFIS DETERGENTS",address:"LOT N, 6 GROUPE 51, ZONE INDUSTRIELLE, 34 SECTION, Ksar El Abtal 19220",address2:"KASR EL ABTAL 19220, SETIF, ALGERIE",phone1:"+213 0668 15 41 45",phone2:"+213 0668 15 41 45"});let i=p({quantity:0,price:0,total:0,product:{id:-1,name:"Select a product",brand:"",description:"",product_code:"",SKU:"",price:0,stockable:!1,tax_rate:0,product_stock:{quantity:0}}});const w=p({quantity:0,price:0,total:0,product:{id:-1,name:"Select a product",brand:"",description:"",product_code:"",SKU:"",price:0,stockable:!1,tax_rate:0,product_stock:{quantity:0}}});F(a.data,()=>{x.value!==a.data.date&&(x.value=a.data.date,a.loading.isActive=!0,m.getLastID({date:a.data.date}).then(o=>{a.data.id=o.data.id,a.loading.isActive=!1}).catch(o=>{a.loading.isActive=!1,console.log(o)}))});const v=o=>{V()},b=o=>(console.log("item :"),console.log(o),`${o.product.name}`);function V(){let o=a.data.certify_invoice_products.map(l=>l.price*l.quantity);n.value=o.reduce((l,h)=>l+h,0),a.data.total=o.reduce((l,h)=>l+h,0),a.data.amount=o.reduce((l,h)=>l+h,0)}const U=()=>{i.value!==void 0&&(console.log(i.value.product.id),a.data.certify_invoice_products.findIndex(l=>l.product.id===i.value.product.id)===-1&&i.value.product.id!==-1&&a.data.certify_invoice_products.push({...i.value}),V())};F(i,()=>{_()});const q=o=>{const l=a.data.certify_invoice_products.findIndex(h=>h.product.id===o.product.id);a.data.certify_invoice_products.splice(l,1),V()},y=o=>`${o.name}  ${o.surname}`,_=o=>{U(),i.value={...w.value}};return(o,l)=>{const h=X;return g(),D(j,null,{default:s(()=>[t(I,{class:"d-flex flex-wrap justify-space-between flex-column flex-sm-row"},{default:s(()=>[e("div",ye,[e("div",be,[t(d(z),{nodes:d(G).app.logo,class:"me-3"},null,8,["nodes"]),e("h6",he,c(d(r).name),1)]),e("p",xe,c(d(r).address),1),e("p",Ve,c(d(r).address2),1),e("p",ge,c(d(r).phone1)+" , "+c(d(r).phone2),1)]),e("div",we,[e("h6",Se,[Ie,e("span",null,[t(N,{modelValue:a.data.id,"onUpdate:modelValue":l[0]||(l[0]=u=>a.data.id=u),disabled:"",prefix:"#",density:"compact",style:{width:"8.9rem"}},null,8,["modelValue"])])]),e("p",Ne,[Ae,e("span",null,[t(h,{modelValue:a.data.date,"onUpdate:modelValue":l[1]||(l[1]=u=>a.data.date=u),density:"compact",placeholder:"YYYY-MM-DD",style:{width:"8.9rem"},config:{position:"auto right"}},null,8,["modelValue"])])])])]),_:1}),t(C),t(I,{class:"d-flex flex-wrap justify-space-between flex-column flex-sm-row"},{default:s(()=>[t(P,null,{default:s(()=>[t(f,{cols:"12",md:"7"},{default:s(()=>[e("div",ke,[Pe,t(d(K),{list:a.data.clients,modelValue:a.data.client,"onUpdate:modelValue":l[2]||(l[2]=u=>a.data.client=u),"option-value":"id","custom-text":y,hideSelectedOptions:!0,placeholder:"Select Client"},null,8,["list","modelValue"])]),Te]),_:1}),t(f,{cols:"12",md:"5"},{default:s(()=>[e("div",Ce,[De,e("table",null,[e("tbody",null,[e("tr",null,[Ee,e("td",Ue," FAJ/2023/"+c(a.data.id),1)]),e("tr",null,[qe,e("td",$e,c(a.data.payment_type),1)]),e("tr",null,[Re,e("td",Fe,c(a.data.client.name)+" "+c(a.data.client.surname),1)]),e("tr",null,[Le,e("td",null,c(a.data.client.address),1)]),e("tr",null,[je,e("td",null,c(a.data.client.NRC),1)]),e("tr",null,[Oe,e("td",null,c(a.data.client.NIF),1)]),e("tr",null,[Ke,e("td",null,c(a.data.client.NIS),1)]),e("tr",null,[Be,e("td",null,c(a.data.client.NART),1)])])])])]),_:1})]),_:1})]),_:1}),t(C),t(I,{class:"add-products-form"},{default:s(()=>[e("div",Me,[t(P,null,{default:s(()=>[t(f,{cols:"12",md:"12"},{default:s(()=>[Ze,t(d(K),{list:a.data.products,modelValue:d(i),"onUpdate:modelValue":l[3]||(l[3]=u=>k(i)?i.value=u:i=u),"option-value":"id","custom-text":b,placeholder:"Select Product"},null,8,["list","modelValue"])]),_:1}),t(f,{cols:"12",md:"2"})]),_:1})]),Qe,(g(!0),L(B,null,H(a.data.certify_invoice_products,(u,Z)=>(g(),L("div",{key:Z,class:"ma-sm-4"},[t(ve,{id:u.id,data:u,onRemoveProduct:q,onTotalAmount:v},null,8,["id","data"])]))),128))]),_:1}),t(C),t(I,{class:"d-flex justify-space-between flex-wrap flex-column flex-sm-row"},{default:s(()=>[e("div",Ye,[e("div",ze,[Ge,t(N,{modelValue:a.data.salesperson,"onUpdate:modelValue":l[4]||(l[4]=u=>a.data.salesperson=u),style:{width:"10rem"}},null,8,["modelValue"])]),t(N,{modelValue:a.data.thanksNote,"onUpdate:modelValue":l[5]||(l[5]=u=>a.data.thanksNote=u),placeholder:"Thanks for your business"},null,8,["modelValue"])]),e("div",He,[e("table",null,[e("tr",null,[Je,e("td",We,[e("p",Xe,c(d(n).toFixed(2))+" DZD ",1),e("p",et,c((d(n)*.19).toFixed(2))+" DZD ",1),e("p",tt,c((d(n)*1.19).toFixed(2))+" DZD ",1)])])])])]),_:1}),t(C),t(I,{class:"mx-sm-4"},{default:s(()=>[at,t(se,{modelValue:a.data.note,"onUpdate:modelValue":l[6]||(l[6]=u=>a.data.note=u),rows:2},null,8,["modelValue"])]),_:1})]),_:1})}}},ot={class:"d-flex align-center justify-space-between"},lt={class:"d-flex align-center justify-space-between"},dt={class:"d-flex align-center justify-space-between"},zt={__name:"[id]",setup(T){const a=J(),m=W(),n=p({amount:0,fac_id:3,date:"2023-11-03",client_id:1,payment_type:"Espece",amount_letter:"",client:{id:-1,name:"",surname:"",address:"",email:"",phone:"",NRC:"",NIF:"",NART:"",NIS:""},certify_invoice_products:[{price:1,quantity:20,total:20,id:1,product:{name:"Sample Product",brand:"Sample Brand",description:"Product Description",product_code:"PROD123",category_id:1,SKU:"SKU123",min_stock_level:10,price:"1.00",stockable:0,tax_rate:"0.08",product_stock:{id:1,product_id:1,quantity:20}}}],clients:[],products:[]}),x=M(),r=p({isActive:!1});x.fetchInvoice(Number(a.params.id)).then(y=>{r.isActive=!1,console.log("data"),n.value=y.data.invoice,n.value.clients=y.data.clients,n.value.products=y.data.products}).catch(y=>{r.isActive=!1,console.log(y)});const i=p(!1);p(!1);const w=p(!0),v=p(!1),b=p(!1),V=p(!1),U=["Espece","Cheque","Versement Bancaire"],q=()=>{n.value.client.id===-1||n.value.date===null||n.value.certify_invoice_products.length===0||n.value.payment_type===""?(n.client.id===-1&&A("Client Not Selected","Oops! Looks like you forgot to select a client for this invoice. Kindly pick at least one client to proceed"),n.date===null&&A("The date field is empty","Date field remains empty, and no client has been chosen for the invoice."),n.certify_invoice_products.length===0&&A("Select a least one product.","Kindly ensure you've selected at least one product before proceeding."),n.payment_type===""&&A("Choose a payment method.","Please select a payment method to complete your invoice.")):r.isActive||(r.isActive=!0,x.updateCertifyInvoice(n.value).then(y=>{r.isActive=!1,V.value=!0,ee("Invoice updated Successfully"),m.push({name:"apps-certifyInvoice-preview-id",params:{id:n.value.id}})}).catch(y=>{r.isActive=!1,console.log(y),A("Error",""),console.log(y)}))};return(y,_)=>(g(),D(P,null,{default:s(()=>[t(oe,{"model-value":d(r).isActive,class:"align-center justify-center"},{default:s(()=>[t(ae,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),t(f,{cols:"12",md:"9"},{default:s(()=>[t(st,{data:d(n)},null,8,["data"])]),_:1}),t(f,{cols:"12",md:"3"},{default:s(()=>[t(j,{class:"mb-8"},{default:s(()=>[t(I,null,{default:s(()=>[t(E,{block:"","prepend-icon":"tabler-send",class:"mb-2",onClick:_[0]||(_[0]=o=>i.value=!0)},{default:s(()=>[S(" Send Invoice ")]),_:1}),d(V)?(g(),D(E,{key:0,block:"",color:"secondary",variant:"tonal",class:"mb-2",to:{name:"apps-invoice-preview-id",params:{id:d(a).params.id}}},{default:s(()=>[S(" Preview ")]),_:1},8,["to"])):O("",!0),d(V)?O("",!0):(g(),D(E,{key:1,loading:d(r).isActive,disabled:d(r).isActive,block:"",color:"success",class:"mb-2",onClick:q},{default:s(()=>[S(" Save ")]),_:1},8,["loading","disabled"]))]),_:1})]),_:1}),t(le,{modelValue:d(n).payment_type,"onUpdate:modelValue":_[1]||(_[1]=o=>d(n).payment_type=o),items:U,label:"Accept Payment Via",class:"mb-6"},null,8,["modelValue"]),e("div",ot,[t($,{for:"payment-terms"},{default:s(()=>[S(" Payment Terms ")]),_:1}),e("div",null,[t(R,{id:"payment-terms",modelValue:d(w),"onUpdate:modelValue":_[2]||(_[2]=o=>k(w)?w.value=o:null)},null,8,["modelValue"])])]),e("div",lt,[t($,{for:"client-notes"},{default:s(()=>[S(" Client Notes ")]),_:1}),e("div",null,[t(R,{id:"client-notes",modelValue:d(v),"onUpdate:modelValue":_[3]||(_[3]=o=>k(v)?v.value=o:null)},null,8,["modelValue"])])]),e("div",dt,[t($,{for:"payment-stub"},{default:s(()=>[S(" Payment Stub ")]),_:1}),e("div",null,[t(R,{id:"payment-stub",modelValue:d(b),"onUpdate:modelValue":_[4]||(_[4]=o=>k(b)?b.value=o:null)},null,8,["modelValue"])])])]),_:1}),t(te,{isDrawerOpen:d(i),"onUpdate:isDrawerOpen":_[5]||(_[5]=o=>k(i)?i.value=o:null)},null,8,["isDrawerOpen"])]),_:1}))}};export{zt as default};
