import{k as m,Z as se,r as re,o as A,b as N,w as t,m as d,p as e,C as O,q as o,P as de,D as b,be as ie,E as D,ay as ue,bd as ce,$ as Z,A as be,c as H,F as we,a as he,x as R,y as Q,H as xe,I as Ae}from"./main.3e4a7664.js";import{_ as Ce}from"./DialogCloseBtn.861d64a0.js";import{s as M,e as B}from"./errorsMiddleware.3e8cce59.js";import{u as G}from"./useAttendanceStore.168735c3.js";import{_ as Ee}from"./AppDateTimePicker.092ee910.js";import{r as pe}from"./validators.330a354f.js";import{V as J}from"./VSpacer.c701354e.js";import{V as w,a as ae}from"./VBtn.cda7f3ff.js";import{V as L,c as P}from"./VCard.5e5240e5.js";import{V as me}from"./VForm.2c2bef0a.js";import{V as K,a as y}from"./VRow.bb367534.js";import{V as I}from"./VInput.8a9622b2.js";import{V as q}from"./VTextField.9e08004a.js";import{V as fe}from"./VNavigationDrawer.65bef4a8.js";import{V as le}from"./VFileInput.7f757e4d.js";import{a as Ue}from"./VOverlay.0742860e.js";import{V as W}from"./VDivider.b2cf7867.js";import{V as Se}from"./VSelect.d0e4adb9.js";import{V as ke}from"./VTable.27e9b22c.js";import{V as $e}from"./VMenu.59c9c2bc.js";import{V as Oe,b as oe,a as ne}from"./VList.313bf15a.js";import{V as Ne}from"./VPagination.0e110d88.js";import{V as Fe}from"./VDialog.6a261bd6.js";import"./VField.d470a36f.js";import"./index.969717a5.js";import"./position.7ef297c0.js";import"./router.edbbf26c.js";import"./easing.36b781ab.js";import"./index.b522f886.js";import"./VAvatar.8e1eaad0.js";import"./VImg.010fd1a5.js";import"./forwardRefs.c003b6b8.js";/* empty css                   */import"./VCounter.3fda8fca.js";import"./ssrBoot.4614d505.js";import"./VChip.2a43419b.js";import"./lazy.a71a3757.js";import"./dialog-transition.5f6c212d.js";import"./VCheckboxBtn.8b0eba1a.js";import"./VSelectionControl.af9e00ba.js";import"./scopeId.0ab93db8.js";const Te={class:"d-flex align-center pa-6 pb-1"},Re=d("h6",{class:"text-h6"}," Update End Date ",-1),Pe={__name:"EditEmployeeAttendanceDrawer",props:{isDrawerOpen:{type:null,required:!0},loading:{type:null,required:!0},employee:{type:Object,required:!0},disableEndDate:{type:Boolean,required:!0},disableStartDate:{type:Boolean,required:!0}},setup(F){const u=F,k=G(),f=m({start_date:"",end_date:"",real_start_date:"",real_end_date:"",position:""});se(u.isDrawerOpen,()=>{u.isDrawerOpen.open&&(console.log(u.employee),f.value.id=u.employee.id||"",f.value.start_date=u.employee.start_date||"",f.value.end_date=u.employee.end_date||"",f.value.real_start_date=u.employee.real_start_date||"",f.value.real_end_date=u.employee.real_end_date||"",f.value.position=u.employee.position||"")});const a=m(!1),C=m();m(),m({id:-1});const E=()=>{u.isDrawerOpen.open=!1,ue(()=>{var r,p;(r=C.value)==null||r.reset(),(p=C.value)==null||p.resetValidation()})},U=()=>{u.loading.isActive=!0,console.log(u.loading),k.updateEndDate(V(f.value.end_date),V(f.value.start_date),f.value.id,f.value.position,V(f.value.real_start_date),V(f.value.real_end_date)).then(r=>{u.isDrawerOpen.open=!1,u.loading.isActive=!1,u.employee.end_date=r.data.endDate,M(r.data.msg)}).catch(r=>{u.loading.isActive=!1,B("Error Occured",r.response.data.message)})},S=r=>{u.isDrawerOpen.value.open=r},V=r=>{if(r!=null&&r!==""){console.log(r);let p=new Date(r),g=p.getFullYear(),i=String(p.getMonth()+1).padStart(2,"0"),n=String(p.getDate()).padStart(2,"0");return`${g}-${i}-${n}`}return r},x=r=>{const p=r.getDate(),g=r.getMonth()+1;return`${r.getFullYear()}-${$(g)}-${$(p)}`};function $(r){return parseInt(r)<10?"0"+r:r}return(r,p)=>{const g=Ee,i=re("VueDatePicker");return A(),N(fe,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":u.isDrawerOpen.open,"onUpdate:modelValue":S},{default:t(()=>[d("div",Te,[Re,e(J),e(w,{variant:"tonal",color:"default",icon:"",size:"32",class:"rounded",onClick:E},{default:t(()=>[e(O,{size:"18",icon:"tabler-x"})]),_:1})]),e(o(de),{options:{wheelPropagation:!1}},{default:t(()=>[e(L,{flat:""},{default:t(()=>[e(P,null,{default:t(()=>[e(me,{ref_key:"refForm",ref:C,modelValue:o(a),"onUpdate:modelValue":p[5]||(p[5]=n=>b(a)?a.value=n:null),onSubmit:ie(U,["prevent"])},{default:t(()=>[e(K,null,{default:t(()=>[e(y,{cols:"12"},{default:t(()=>[e(g,{modelValue:o(f).start_date,"onUpdate:modelValue":p[0]||(p[0]=n=>o(f).start_date=n),label:"Start Date",disabled:F.disableStartDate},null,8,["modelValue","disabled"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(g,{modelValue:o(f).end_date,"onUpdate:modelValue":p[1]||(p[1]=n=>o(f).end_date=n),label:"End Date",config:{minDate:`

                  ${o(f).start_date}`},disabled:F.disableEndDate},null,8,["modelValue","config","disabled"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(I,null,{default:t(()=>[D(" REAL START DATE ")]),_:1}),e(i,{modelValue:o(f).real_start_date,"onUpdate:modelValue":[p[2]||(p[2]=n=>o(f).real_start_date=n),r.onStartDateChanged],"auto-apply":"",format:x},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(I,null,{default:t(()=>[D(" REAL END DATE ")]),_:1}),e(i,{modelValue:o(f).real_end_date,"onUpdate:modelValue":p[3]||(p[3]=n=>o(f).real_end_date=n),"auto-apply":"",format:x,"min-date":o(f).end_date_restrict},null,8,["modelValue","min-date"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(q,{modelValue:o(f).position,"onUpdate:modelValue":p[4]||(p[4]=n=>o(f).position=n),rules:[o(pe)],label:"Position"},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(w,{type:"submit",class:"me-3"},{default:t(()=>[D(" Submit ")]),_:1}),e(w,{type:"reset",variant:"tonal",color:"secondary",onClick:E},{default:t(()=>[D(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};const Ie={class:"d-flex align-center pa-6 pb-1"},ze=d("h6",{class:"text-h6"}," Add New Record ",-1),Be={__name:"AddEmployeeAttendanceDrawer",props:{isDrawerOpen:{type:null,required:!0},loading:{type:null,required:!0},employees:{type:Object,required:!0}},setup(F){const u=F,k=G(),f=ce(),a=m({start_date:new Date().getFullYear()+"-"+(new Date().getMonth()+1)+"-"+new Date().getDate(),end_date:"",end_date_restrict:new Date().getFullYear()+"-"+(new Date().getMonth()+1)+"-"+(new Date().getDate()+1),position:"",real_start_date:"",real_end_date:"",national_card:"",birth_certificate:""}),C=m(!1),E=m();m(),m({id:-1});const U=()=>{u.isDrawerOpen.open=!1,ue(()=>{var i,n;(i=E.value)==null||i.reset(),(n=E.value)==null||n.resetValidation()})},S=()=>{if(console.log(a),a.value.birth_certificate[0]===void 0&&a.value.national_card[0]===void 0&&V(null,null),a.value.birth_certificate[0]!==void 0&&a.value.national_card[0]===void 0){var i=new FileReader;i.readAsDataURL(a.value.birth_certificate[0]),i.onload=function(){let c=i.result;V(c,null)},i.onerror=function(c){return""}}if(a.value.national_card[0]!==void 0&&a.value.birth_certificate[0]===void 0){var n=new FileReader;n.readAsDataURL(a.value.national_card[0]),n.onload=function(){let c=n.result;V(null,c)},n.onerror=function(c){return""}}if(a.value.birth_certificate[0]!==void 0&&a.value.national_card[0]!==void 0){console.log("here");var v=new FileReader;v.readAsDataURL(a.value.birth_certificate[0]),v.onload=function(){let c=v.result;if(a.value.national_card[0]!==void 0){var h=new FileReader;h.readAsDataURL(a.value.national_card[0]),h.onload=function(){let Y=h.result;V(c,Y)}}},v.onerror=function(c){return""}}},V=(i,n)=>{a.value.start_date===""?B("Warning","start date must be selected"):(u.loading.isActive=!0,console.log(u.loading),k.addEmployeeAttendanceRecord(g(a.value.end_date),g(a.value.start_date),Number(f.params.id),a.value.position,i,n,g(a.value.real_start_date),g(a.value.real_end_date)).then(v=>{u.isDrawerOpen.open=!1,u.loading.isActive=!1,M(v.data.msg)}).catch(v=>{u.loading.isActive=!1,B("Error Occured",v.response.data.message)}))},x=i=>{u.isDrawerOpen.value.open=i};function $(i){return parseInt(i)<10?"0"+i:i}const r=i=>{const n=i.getDate(),v=i.getMonth()+1;return`${i.getFullYear()}-${$(v)}-${$(n)}`},p=()=>{(a.value.start_date===""||a.value.start_date>=a.value.end_date&&a.value.end_date!=="")&&(a.value.end_date=""),a.value.end_date_restrict=new Date(new Date(a.value.start_date).getTime()+24*60*60*2e3).toISOString().split("T")[0]},g=i=>{if(i!=null&&i!==""){console.log(i);let n=new Date(i),v=n.getFullYear(),c=String(n.getMonth()+1).padStart(2,"0"),h=String(n.getDate()).padStart(2,"0");return`${v}-${c}-${h}`}return i};return(i,n)=>{const v=re("VueDatePicker");return A(),N(fe,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":u.isDrawerOpen.open,"onUpdate:modelValue":x},{default:t(()=>[d("div",Ie,[ze,e(J),e(w,{variant:"tonal",color:"default",icon:"",size:"32",class:"rounded",onClick:U},{default:t(()=>[e(O,{size:"18",icon:"tabler-x"})]),_:1})]),e(o(de),{options:{wheelPropagation:!1}},{default:t(()=>[e(L,{flat:""},{default:t(()=>[e(P,null,{default:t(()=>[e(me,{ref_key:"refForm",ref:E,modelValue:o(C),"onUpdate:modelValue":n[7]||(n[7]=c=>b(C)?C.value=c:null),onSubmit:ie(S,["prevent"])},{default:t(()=>[e(K,null,{default:t(()=>[e(y,{cols:"12"},{default:t(()=>[e(I,null,{default:t(()=>[D(" CNAS START DATE ")]),_:1}),e(v,{modelValue:o(a).start_date,"onUpdate:modelValue":[n[0]||(n[0]=c=>o(a).start_date=c),p],"auto-apply":"",format:r},null,8,["modelValue"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(I,null,{default:t(()=>[D(" CNAS END DATE ")]),_:1}),e(v,{modelValue:o(a).end_date,"onUpdate:modelValue":n[1]||(n[1]=c=>o(a).end_date=c),"auto-apply":"",format:r,"min-date":o(a).end_date_restrict},null,8,["modelValue","min-date"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(I,null,{default:t(()=>[D(" REAL START DATE ")]),_:1}),e(v,{modelValue:o(a).real_start_date,"onUpdate:modelValue":[n[2]||(n[2]=c=>o(a).real_start_date=c),p],"auto-apply":"",format:r},null,8,["modelValue"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(I,null,{default:t(()=>[D(" REAL END DATE ")]),_:1}),e(v,{modelValue:o(a).real_end_date,"onUpdate:modelValue":n[3]||(n[3]=c=>o(a).real_end_date=c),"auto-apply":"",format:r,"min-date":o(a).end_date_restrict},null,8,["modelValue","min-date"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(q,{modelValue:o(a).position,"onUpdate:modelValue":n[4]||(n[4]=c=>o(a).position=c),rules:[o(pe)],label:"Position"},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(le,{modelValue:o(a).national_card,"onUpdate:modelValue":n[5]||(n[5]=c=>o(a).national_card=c),label:"National Card",variant:"filled"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(le,{modelValue:o(a).birth_certificate,"onUpdate:modelValue":n[6]||(n[6]=c=>o(a).birth_certificate=c),label:"Birth Certificate",variant:"filled"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(w,{type:"submit",class:"me-3"},{default:t(()=>[D(" Submit ")]),_:1}),e(w,{type:"reset",variant:"tonal",color:"secondary",onClick:U},{default:t(()=>[D(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};const Me={class:"me-3",style:{width:"80px"}},Le={style:{width:"12rem"}},qe={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Ye={style:{width:"9rem"}},je=d("thead",null,[d("tr",null,[d("th",{scope:"col"}," ID "),d("th",{scope:"col"}," Start Date "),d("th",{scope:"col"}," End Date "),d("th",{scope:"col"}," Period "),d("th",{scope:"col"}," Position "),d("th",{scope:"col"}," ACTIONS ")])],-1),Ze={class:"d-flex align-center"},He={class:"d-flex flex-column"},Qe={class:"text-base"},We={class:"d-flex align-center"},Ge={class:"d-flex flex-column"},Je={class:"text-base"},Ke={class:"d-flex align-center"},Xe={class:"d-flex flex-column"},et={class:"text-base"},tt={class:"d-flex align-center"},at={class:"d-flex flex-column"},lt={class:"text-base"},ot={class:"text-center",style:{width:"5rem"}},nt=d("tr",null,[d("td",{colspan:"7",class:"text-center"}," No data available ")],-1),st=[nt],rt={class:"text-sm text-disabled"},Wt={__name:"[id]",setup(F){const u=G(),k=m(""),f=m(!1),a=m({isActive:!0}),C=ce(),E=m(!0);m();const U=m("mahgounoussama23@gmail.com");m(),m();const S=m(10),V=m(1),x=m(1),$=m(0);let r=m([]),p=m({open:!1}),g=m({open:!1}),i=m({open:!1}),n=m(!1),v=m(!0);const c=()=>{a.value.isActive=!0,u.fetchEmployeesByAttendance(Number(C.params.id)).then(_=>{r.value=_.data.employees.data,x.value=_.data.totalPage,$.value=_.data.totalEmployees,f.value=!1,a.value.isActive=!1,console.log(_)}).catch(_=>{console.error(_),a.value.isActive=!1})};Z(c),Z(()=>{V.value>x.value&&(V.value=x.value)}),se(k,()=>{c()}),m(!1);let h=m(null);Z(()=>{V.value>x.value&&(V.value=x.value)});const Y=be(()=>{const _=r.value.length?(V.value-1)*S.value+1:0,s=r.value.length+(V.value-1)*S.value;return`Showing ${_} to ${s} of ${$.value} entries`}),_e=_=>{h.value=_,p.value.open=!0},ve=_=>{h.value=_,g.value.open=!0},Ve=()=>{i.value.open=!0},ge=()=>{a.value.isActive=!0,g.value.open=!1,u.deleteCareer(h.value.id).then(_=>{a.value.isActive=!1,M(_.data.message),c()}).catch(_=>{B(_.data.message),a.value.isActive=!1})},X=()=>{g.value.open=!1},De=_=>{let s=new Date(_.end_date);_.end_date||(s=new Date);const j=s-new Date(_.start_date),l=Math.floor(j/(1e3*60*60*24)),z=Math.floor(l/365),ee=Math.floor(l%365/30),te=l%30;let T="";return z>0&&(T+=("0"+z).slice(-2)+" years, "),ee>0&&(T+=("0"+ee).slice(-2)+" months, "),te>0&&(T+=("0"+te).slice(-2)+" days"),T=T.replace(/,\s*$/,""),T},ye=_=>{console.log(_),a.value.isActive=!0,u.generateEmail(_.id,U.value).then(s=>{a.value.isActive=!1,M(s.data.message)}).catch(s=>{B(s.data.message),a.value.isActive=!1})};return(_,s)=>{const j=Ce;return A(),H("section",null,[e(K,null,{default:t(()=>[e(Ue,{"model-value":o(a).isActive,class:"align-center justify-center"},{default:t(()=>[e(ae,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),e(y,{cols:"12"},{default:t(()=>[e(L,{title:"Employees"},{default:t(()=>[e(W),e(P,{class:"d-flex flex-wrap py-4 gap-4"},{default:t(()=>[d("div",Me,[e(Se,{modelValue:o(S),"onUpdate:modelValue":s[0]||(s[0]=l=>b(S)?S.value=l:null),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"])]),d("div",Le,[e(q,{onInput:s[1]||(s[1]=l=>E.value=!0),ref:"searchField",modelValue:o(U),"onUpdate:modelValue":s[2]||(s[2]=l=>b(U)?U.value=l:null),placeholder:"Email",density:"compact"},null,8,["modelValue"])]),e(J),d("div",qe,[d("div",Ye,[o(f)?(A(),N(ae,{key:0,indeterminate:"",color:"primary"})):(A(),N(q,{key:1,onInput:s[3]||(s[3]=l=>E.value=!0),ref:"searchField",modelValue:o(k),"onUpdate:modelValue":s[4]||(s[4]=l=>b(k)?k.value=l:null),placeholder:"Search",density:"compact"},null,8,["modelValue"]))]),e(w,{variant:"tonal",color:"secondary","prepend-icon":"tabler-screen-share"},{default:t(()=>[D(" Export ")]),_:1}),e(w,{color:"primary","prepend-icon":"tabler-plus",onClick:s[5]||(s[5]=l=>Ve())},{default:t(()=>[D(" New Record ")]),_:1})])]),_:1}),e(W),e(ke,{class:"text-no-wrap"},{default:t(()=>[je,d("tbody",null,[(A(!0),H(we,null,he(o(r),l=>(A(),H("tr",{key:l.id,style:{height:"3.75rem"}},[d("td",null,R(l.id),1),d("td",null,[d("div",Ze,[d("div",He,[d("h6",Qe,R(l.start_date),1)])])]),d("td",null,[d("div",We,[d("div",Ge,[d("h6",Je,R(l.end_date),1)])])]),d("td",null,[d("div",Ke,[d("div",Xe,[d("h6",et,R(De(l)),1)])])]),d("td",null,[d("div",tt,[d("div",at,[d("h6",lt,R(l.position),1)])])]),d("td",ot,[l.last?(A(),N(w,{key:0,icon:"",size:"x-small",color:"default",variant:"text",onClick:z=>_e(l)},{default:t(()=>[e(O,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"])):Q("",!0),e(w,{icon:"",size:"x-small",color:"default",variant:"text"},{default:t(()=>[e(O,{size:"22",icon:"tabler-trash",onClick:z=>ve(l)},null,8,["onClick"])]),_:2},1024),e(w,{icon:"",size:"x-small",color:"default",variant:"text"},{default:t(()=>[e(O,{size:"22",icon:"tabler-send",onClick:z=>ye(l)},null,8,["onClick"])]),_:2},1024),e(w,{icon:"",variant:"text",color:"default",size:"x-small"},{default:t(()=>[e(O,{size:22,icon:"tabler-dots-vertical"}),e($e,{activator:"parent"},{default:t(()=>[e(Oe,{density:"compact"},{default:t(()=>[l.BC?(A(),N(ne,{key:0,value:"BC",href:l.BC},{prepend:t(()=>[e(O,{size:"22",class:"me-3",icon:"tabler-download"})]),default:t(()=>[e(oe,null,{default:t(()=>[D("Birth Certificate")]),_:1})]),_:2},1032,["href"])):Q("",!0),l.NC?(A(),N(ne,{key:1,value:"NC",href:l.NC},{prepend:t(()=>[e(O,{size:"22",class:"me-3",icon:"tabler-download"})]),default:t(()=>[e(oe,null,{default:t(()=>[D("National Card")]),_:1})]),_:2},1032,["href"])):Q("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]))),128))]),xe(d("tfoot",null,st,512),[[Ae,!o(r).length]])]),_:1}),e(W),e(P,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3 px-5"},{default:t(()=>[d("span",rt,R(o(Y)),1),e(Ne,{modelValue:o(V),"onUpdate:modelValue":s[6]||(s[6]=l=>b(V)?V.value=l:null),size:"small","total-visible":5,length:o(x)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Pe,{isDrawerOpen:o(p),"onUpdate:isDrawerOpen":s[7]||(s[7]=l=>b(p)?p.value=l:p=l),employee:o(h),"onUpdate:employee":s[8]||(s[8]=l=>b(h)?h.value=l:h=l),"disable-end-date":o(n),"onUpdate:disable-end-date":s[9]||(s[9]=l=>b(n)?n.value=l:n=l),loading:o(a),"onUpdate:loading":s[10]||(s[10]=l=>b(a)?a.value=l:null),"disable-start-date":o(v),"onUpdate:disable-start-date":s[11]||(s[11]=l=>b(v)?v.value=l:v=l)},null,8,["isDrawerOpen","employee","disable-end-date","loading","disable-start-date"]),e(Be,{isDrawerOpen:o(i),"onUpdate:isDrawerOpen":s[12]||(s[12]=l=>b(i)?i.value=l:i=l),employees:o(r),"onUpdate:employees":s[13]||(s[13]=l=>b(r)?r.value=l:r=l),loading:o(a),"onUpdate:loading":s[14]||(s[14]=l=>b(a)?a.value=l:null)},null,8,["isDrawerOpen","employees","loading"]),e(Fe,{modelValue:o(g).open,"onUpdate:modelValue":s[17]||(s[17]=l=>o(g).open=l),persistent:"",class:"v-dialog-sm"},{default:t(()=>[e(j,{onClick:s[15]||(s[15]=l=>X())}),e(L,{title:"Confirmation"},{default:t(()=>[e(P,null,{default:t(()=>[D(" Are you sure you want to delete this record ? ")]),_:1}),e(P,{class:"d-flex justify-end gap-3 flex-wrap"},{default:t(()=>[e(w,{color:"secondary",variant:"tonal",onClick:s[16]||(s[16]=l=>X())},{default:t(()=>[D(" Disagree ")]),_:1}),e(w,{onClick:ge},{default:t(()=>[D(" Agree ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{Wt as default};
