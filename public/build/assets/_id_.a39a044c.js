import{bd as ie,k as u,r as ve,o as w,b as F,w as o,m as l,p as e,C,q as s,P as Ve,D as v,be as ge,E as V,ay as be,$ as q,Z as De,A as he,c as j,F as xe,a as we,x,y as Y,H as ye,I as Ae,bf as te}from"./main.80073fb3.js";import{_ as Ce}from"./DialogCloseBtn.0b4ca758.js";import{s as H}from"./successMiddleware.e1481932.js";import{e as B}from"./errorsMiddleware.7ae287f7.js";import{u as re}from"./useAttendanceStore.428182e0.js";import{_ as Ee}from"./EditEmployeeAttendanceDrawer.df63bb4f.js";import{r as ae}from"./validators.330a354f.js";import{V as de}from"./VSpacer.f6e4a849.js";import{V as b,a as le}from"./VBtn.bc513066.js";import{V as Q,c as O}from"./VCard.bed48467.js";import{V as ke}from"./VForm.afb9be88.js";import{V as ue,a as h}from"./VRow.e327326a.js";import{V as I}from"./VInput.b30e6f3e.js";import{V as L}from"./VTextField.f7f47561.js";import{V as oe}from"./VFileInput.6777d812.js";import{V as Ue}from"./VNavigationDrawer.7eedad6d.js";import{a as Se}from"./VOverlay.ba4319b9.js";import{V as Z}from"./VDivider.c8bf408f.js";import{V as Ne}from"./VSelect.eb06e1d1.js";import{V as Re}from"./VTable.6035f281.js";import{V as Fe}from"./VMenu.5e377b50.js";import{V as $e,b as ne,a as se}from"./VList.dace6270.js";import{V as Te}from"./VPagination.0ced2f02.js";import{V as Oe}from"./VDialog.809ecb4b.js";import"./AppDateTimePicker.291f7947.js";import"./VField.95c31d27.js";import"./index.4672e601.js";import"./position.a8816655.js";import"./router.9f57d7dd.js";import"./easing.36b781ab.js";import"./index.b522f886.js";import"./VAvatar.755a82ce.js";import"./VImg.19a712b4.js";import"./forwardRefs.c003b6b8.js";/* empty css                   */import"./VCounter.770fe3f3.js";import"./VChip.1cdee411.js";import"./ssrBoot.2abef11c.js";import"./lazy.172a4f89.js";import"./dialog-transition.4fc1b9b4.js";import"./VCheckboxBtn.9ec2021d.js";import"./VSelectionControl.816c4425.js";import"./scopeId.7979a6ee.js";const Pe={class:"d-flex align-center pa-6 pb-1"},ze=l("h6",{class:"text-h6"}," Add New Record ",-1),Ie={__name:"AddEmployeeAttendanceDrawer",props:{isDrawerOpen:{type:null,required:!0},loading:{type:null,required:!0},employees:{type:Object,required:!0}},setup(W){const g=W,U=re(),P=ie(),t=u({start_date:new Date().getFullYear()+"-"+(new Date().getMonth()+1)+"-"+new Date().getDate(),end_date:"",end_date_restrict:new Date().getFullYear()+"-"+(new Date().getMonth()+1)+"-"+(new Date().getDate()+1),position:"",position_ar:"",real_start_date:"",real_end_date:"",national_card:"",birth_certificate:""}),$=u(!1),S=u();u(),u({id:-1});const E=()=>{g.isDrawerOpen.open=!1,be(()=>{var d,i;(d=S.value)==null||d.reset(),(i=S.value)==null||i.resetValidation()})},k=()=>{if(console.log(t),t.value.birth_certificate[0]===void 0&&t.value.national_card[0]===void 0&&m(null,null),t.value.birth_certificate[0]!==void 0&&t.value.national_card[0]===void 0){var d=new FileReader;d.readAsDataURL(t.value.birth_certificate[0]),d.onload=function(){let r=d.result;m(r,null)},d.onerror=function(r){return""}}if(t.value.national_card[0]!==void 0&&t.value.birth_certificate[0]===void 0){var i=new FileReader;i.readAsDataURL(t.value.national_card[0]),i.onload=function(){let r=i.result;m(null,r)},i.onerror=function(r){return""}}if(t.value.birth_certificate[0]!==void 0&&t.value.national_card[0]!==void 0){console.log("here");var c=new FileReader;c.readAsDataURL(t.value.birth_certificate[0]),c.onload=function(){let r=c.result;if(t.value.national_card[0]!==void 0){var _=new FileReader;_.readAsDataURL(t.value.national_card[0]),_.onload=function(){let M=_.result;m(r,M)}}},c.onerror=function(r){return""}}},m=(d,i)=>{t.value.start_date===""?B("Warning","start date must be selected"):(g.loading.isActive=!0,console.log(g.loading),U.addEmployeeAttendanceRecord(D(t.value.end_date),D(t.value.start_date),Number(P.params.id),t.value.position,d,i,D(t.value.real_start_date),D(t.value.real_end_date),t.value.position_ar).then(c=>{g.isDrawerOpen.open=!1,g.loading.isActive=!1,H(c.data.msg),location.reload()}).catch(c=>{g.loading.isActive=!1,B("Error Occured",c.response.data.message)}))},y=d=>{g.isDrawerOpen.value.open=d};function T(d){return parseInt(d)<10?"0"+d:d}const p=d=>{const i=d.getDate(),c=d.getMonth()+1;return`${d.getFullYear()}-${T(c)}-${T(i)}`},A=()=>{(t.value.start_date===""||t.value.start_date>=t.value.end_date&&t.value.end_date!=="")&&(t.value.end_date=""),t.value.end_date_restrict=new Date(new Date(t.value.start_date).getTime()+24*60*60*2e3).toISOString().split("T")[0]},D=d=>{if(d!=null&&d!==""){console.log(d);let i=new Date(d),c=i.getFullYear(),r=String(i.getMonth()+1).padStart(2,"0"),_=String(i.getDate()).padStart(2,"0");return`${c}-${r}-${_}`}return d};return(d,i)=>{const c=ve("VueDatePicker");return w(),F(Ue,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":g.isDrawerOpen.open,"onUpdate:modelValue":y},{default:o(()=>[l("div",Pe,[ze,e(de),e(b,{variant:"tonal",color:"default",icon:"",size:"32",class:"rounded",onClick:E},{default:o(()=>[e(C,{size:"18",icon:"tabler-x"})]),_:1})]),e(s(Ve),{options:{wheelPropagation:!1}},{default:o(()=>[e(Q,{flat:""},{default:o(()=>[e(O,null,{default:o(()=>[e(ke,{ref_key:"refForm",ref:S,modelValue:s($),"onUpdate:modelValue":i[8]||(i[8]=r=>v($)?$.value=r:null),onSubmit:ge(k,["prevent"])},{default:o(()=>[e(ue,null,{default:o(()=>[e(h,{cols:"12"},{default:o(()=>[e(I,null,{default:o(()=>[V(" CNAS START DATE ")]),_:1}),e(c,{modelValue:s(t).start_date,"onUpdate:modelValue":[i[0]||(i[0]=r=>s(t).start_date=r),A],"auto-apply":"",format:p},null,8,["modelValue"])]),_:1}),e(h,{cols:"12"},{default:o(()=>[e(I,null,{default:o(()=>[V(" CNAS END DATE ")]),_:1}),e(c,{modelValue:s(t).end_date,"onUpdate:modelValue":i[1]||(i[1]=r=>s(t).end_date=r),"auto-apply":"",format:p,"min-date":s(t).end_date_restrict},null,8,["modelValue","min-date"])]),_:1}),e(h,{cols:"12"},{default:o(()=>[e(I,null,{default:o(()=>[V(" REAL START DATE ")]),_:1}),e(c,{modelValue:s(t).real_start_date,"onUpdate:modelValue":[i[2]||(i[2]=r=>s(t).real_start_date=r),A],"auto-apply":"",format:p},null,8,["modelValue"])]),_:1}),e(h,{cols:"12"},{default:o(()=>[e(I,null,{default:o(()=>[V(" REAL END DATE ")]),_:1}),e(c,{modelValue:s(t).real_end_date,"onUpdate:modelValue":i[3]||(i[3]=r=>s(t).real_end_date=r),"auto-apply":"",format:p,"min-date":s(t).end_date_restrict},null,8,["modelValue","min-date"])]),_:1}),e(h,{cols:"12"},{default:o(()=>[e(L,{modelValue:s(t).position,"onUpdate:modelValue":i[4]||(i[4]=r=>s(t).position=r),rules:[s(ae)],label:"Position"},null,8,["modelValue","rules"])]),_:1}),e(h,{cols:"12"},{default:o(()=>[e(L,{modelValue:s(t).position_ar,"onUpdate:modelValue":i[5]||(i[5]=r=>s(t).position_ar=r),rules:[s(ae)],label:"Position Arabic"},null,8,["modelValue","rules"])]),_:1}),e(h,{cols:"12"},{default:o(()=>[e(oe,{modelValue:s(t).national_card,"onUpdate:modelValue":i[6]||(i[6]=r=>s(t).national_card=r),label:"National Card",variant:"filled"},null,8,["modelValue"])]),_:1}),e(h,{cols:"12"},{default:o(()=>[e(oe,{modelValue:s(t).birth_certificate,"onUpdate:modelValue":i[7]||(i[7]=r=>s(t).birth_certificate=r),label:"Birth Certificate",variant:"filled"},null,8,["modelValue"])]),_:1}),e(h,{cols:"12"},{default:o(()=>[e(b,{type:"submit",class:"me-3"},{default:o(()=>[V(" Submit ")]),_:1}),e(b,{type:"reset",variant:"tonal",color:"secondary",onClick:E},{default:o(()=>[V(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};const Be={class:"me-3",style:{width:"80px"}},Le={style:{width:"12rem"}},Me={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},qe={style:{width:"9rem"}},je=l("thead",null,[l("tr",null,[l("th",{scope:"col"}," ID "),l("th",{scope:"col"}," Start Date "),l("th",{scope:"col"}," End Date "),l("th",{scope:"col"}," Period "),l("th",{scope:"col"}," REAL Start Date "),l("th",{scope:"col"}," REAL End Date "),l("th",{scope:"col"}," REAL Period "),l("th",{scope:"col"}," Position "),l("th",{scope:"col"}," ACTIONS ")])],-1),Ye={class:"d-flex align-center"},Ze={class:"d-flex flex-column"},He={class:"text-base"},Qe={class:"d-flex align-center"},We={class:"d-flex flex-column"},Ge={class:"text-base"},Je={class:"d-flex align-center"},Ke={class:"d-flex flex-column"},Xe={class:"text-base"},et={class:"d-flex align-center"},tt={class:"d-flex flex-column"},at={class:"text-base"},lt={class:"d-flex align-center"},ot={class:"d-flex flex-column"},nt={class:"text-base"},st={class:"d-flex align-center"},it={class:"d-flex flex-column"},rt={class:"text-base"},dt={class:"d-flex align-center"},ut={class:"d-flex flex-column"},ct={class:"text-base"},ft={class:"text-center",style:{width:"5rem"}},mt=l("tr",null,[l("td",{colspan:"7",class:"text-center"}," No data available ")],-1),pt=[mt],_t={class:"text-sm text-disabled"},vt={__name:"[id]",setup(W){const g=re(),U=u(""),P=u(!1),t=u({isActive:!0}),$=ie(),S=u(!0);u();const E=u("mahgounoussama23@gmail.com");u(),u();const k=u(10),m=u(1),y=u(1),T=u(0);let p=u([]),A=u({open:!1}),D=u({open:!1}),d=u({open:!1}),i=u(!1),c=u(!0);const r=()=>{t.value.isActive=!0,g.fetchEmployeesByAttendance(Number($.params.id)).then(f=>{p.value=f.data.employees.data,y.value=f.data.totalPage,T.value=f.data.totalEmployees,P.value=!1,t.value.isActive=!1,console.log(f)}).catch(f=>{console.error(f),t.value.isActive=!1})};q(r),q(()=>{m.value>y.value&&(m.value=y.value)}),De(U,()=>{r()}),u(!1);let _=u(null);q(()=>{m.value>y.value&&(m.value=y.value)});const M=he(()=>{const f=p.value.length?(m.value-1)*k.value+1:0,n=p.value.length+(m.value-1)*k.value;return`Showing ${f} to ${n} of ${T.value} entries`}),ce=f=>{_.value=f,A.value.open=!0},fe=f=>{_.value=f,D.value.open=!0},me=()=>{d.value.open=!0},pe=()=>{t.value.isActive=!0,D.value.open=!1,g.deleteCareer(_.value.id).then(f=>{t.value.isActive=!1,H(f.data.message),r()}).catch(f=>{B(f.data.message),t.value.isActive=!1})},G=()=>{D.value.open=!1},J=(f,n)=>{let z=new Date(n);n||(z=new Date);const a=z-new Date(f),N=Math.floor(a/(1e3*60*60*24)),K=Math.floor(N/365),X=Math.floor(N%365/30),ee=N%30;let R="";return K>0&&(R+=("0"+K).slice(-2)+" years, "),X>0&&(R+=("0"+X).slice(-2)+" months, "),ee>0&&(R+=("0"+ee).slice(-2)+" days"),R=R.replace(/,\s*$/,""),R},_e=f=>{console.log(f),t.value.isActive=!0,g.generateEmail(f.id,E.value).then(n=>{t.value.isActive=!1,H(n.data.message)}).catch(n=>{B(n.data.message),t.value.isActive=!1})};return(f,n)=>{const z=Ce;return w(),j("section",null,[e(ue,null,{default:o(()=>[e(Se,{"model-value":s(t).isActive,class:"align-center justify-center"},{default:o(()=>[e(le,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),e(h,{cols:"12"},{default:o(()=>[e(Q,{title:"Employees"},{default:o(()=>[e(Z),e(O,{class:"d-flex flex-wrap py-4 gap-4"},{default:o(()=>[l("div",Be,[e(Ne,{modelValue:s(k),"onUpdate:modelValue":n[0]||(n[0]=a=>v(k)?k.value=a:null),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"])]),l("div",Le,[e(L,{onInput:n[1]||(n[1]=a=>S.value=!0),ref:"searchField",modelValue:s(E),"onUpdate:modelValue":n[2]||(n[2]=a=>v(E)?E.value=a:null),placeholder:"Email",density:"compact"},null,8,["modelValue"])]),e(de),l("div",Me,[l("div",qe,[s(P)?(w(),F(le,{key:0,indeterminate:"",color:"primary"})):(w(),F(L,{key:1,onInput:n[3]||(n[3]=a=>S.value=!0),ref:"searchField",modelValue:s(U),"onUpdate:modelValue":n[4]||(n[4]=a=>v(U)?U.value=a:null),placeholder:"Search",density:"compact"},null,8,["modelValue"]))]),e(b,{variant:"tonal",color:"secondary","prepend-icon":"tabler-screen-share"},{default:o(()=>[V(" Export ")]),_:1}),e(b,{color:"primary","prepend-icon":"tabler-plus",onClick:n[5]||(n[5]=a=>me())},{default:o(()=>[V(" New Record ")]),_:1})])]),_:1}),e(Z),e(Re,{class:"text-no-wrap"},{default:o(()=>[je,l("tbody",null,[(w(!0),j(xe,null,we(s(p),a=>(w(),j("tr",{key:a.id,style:{height:"3.75rem"}},[l("td",null,x(a.id),1),l("td",null,[l("div",Ye,[l("div",Ze,[l("h6",He,x(a.start_date),1)])])]),l("td",null,[l("div",Qe,[l("div",We,[l("h6",Ge,x(a.end_date),1)])])]),l("td",null,[l("div",Je,[l("div",Ke,[l("h6",Xe,x(J(a.start_date,a.end_date)),1)])])]),l("td",null,[l("div",et,[l("div",tt,[l("h6",at,x(a.real_start_date),1)])])]),l("td",null,[l("div",lt,[l("div",ot,[l("h6",nt,x(a.real_end_date),1)])])]),l("td",null,[l("div",st,[l("div",it,[l("h6",rt,x(J(a.real_start_date,a.real_end_date)),1)])])]),l("td",null,[l("div",dt,[l("div",ut,[l("h6",ct,x(a.position),1)])])]),l("td",ft,[a.last?(w(),F(b,{key:0,icon:"",size:"x-small",color:"default",variant:"text",onClick:N=>ce(a)},{default:o(()=>[e(C,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"])):Y("",!0),e(b,{icon:"",size:"x-small",color:"default",variant:"text",to:{name:"apps-employee-vacation-id",params:{id:a.id}}},{default:o(()=>[e(C,{size:"22",icon:"tabler-user-check"})]),_:2},1032,["to"]),e(b,{icon:"",size:"x-small",color:"default",variant:"text"},{default:o(()=>[e(C,{size:"22",icon:"tabler-trash",onClick:N=>fe(a)},null,8,["onClick"])]),_:2},1024),e(b,{icon:"",size:"x-small",color:"default",variant:"text"},{default:o(()=>[e(C,{size:"22",icon:"tabler-send",onClick:N=>_e(a)},null,8,["onClick"])]),_:2},1024),e(b,{icon:"",variant:"text",color:"default",size:"x-small"},{default:o(()=>[e(C,{size:22,icon:"tabler-dots-vertical"}),e(Fe,{activator:"parent"},{default:o(()=>[e($e,{density:"compact"},{default:o(()=>[a.BC?(w(),F(se,{key:0,value:"BC",href:a.BC},{prepend:o(()=>[e(C,{size:"22",class:"me-3",icon:"tabler-download"})]),default:o(()=>[e(ne,null,{default:o(()=>[V("Birth Certificate")]),_:1})]),_:2},1032,["href"])):Y("",!0),a.NC?(w(),F(se,{key:1,value:"NC",href:a.NC},{prepend:o(()=>[e(C,{size:"22",class:"me-3",icon:"tabler-download"})]),default:o(()=>[e(ne,null,{default:o(()=>[V("National Card")]),_:1})]),_:2},1032,["href"])):Y("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]))),128))]),ye(l("tfoot",null,pt,512),[[Ae,!s(p).length]])]),_:1}),e(Z),e(O,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3 px-5"},{default:o(()=>[l("span",_t,x(s(M)),1),e(Te,{modelValue:s(m),"onUpdate:modelValue":n[6]||(n[6]=a=>v(m)?m.value=a:null),size:"small","total-visible":5,length:s(y)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Ee,{isDrawerOpen:s(A),"onUpdate:isDrawerOpen":n[7]||(n[7]=a=>v(A)?A.value=a:A=a),employee:s(_),"onUpdate:employee":n[8]||(n[8]=a=>v(_)?_.value=a:_=a),"disable-end-date":s(i),"onUpdate:disable-end-date":n[9]||(n[9]=a=>v(i)?i.value=a:i=a),loading:s(t),"onUpdate:loading":n[10]||(n[10]=a=>v(t)?t.value=a:null),"disable-start-date":s(c),"onUpdate:disable-start-date":n[11]||(n[11]=a=>v(c)?c.value=a:c=a)},null,8,["isDrawerOpen","employee","disable-end-date","loading","disable-start-date"]),e(Ie,{isDrawerOpen:s(d),"onUpdate:isDrawerOpen":n[12]||(n[12]=a=>v(d)?d.value=a:d=a),employees:s(p),"onUpdate:employees":n[13]||(n[13]=a=>v(p)?p.value=a:p=a),loading:s(t),"onUpdate:loading":n[14]||(n[14]=a=>v(t)?t.value=a:null)},null,8,["isDrawerOpen","employees","loading"]),e(Oe,{modelValue:s(D).open,"onUpdate:modelValue":n[17]||(n[17]=a=>s(D).open=a),persistent:"",class:"v-dialog-sm"},{default:o(()=>[e(z,{onClick:n[15]||(n[15]=a=>G())}),e(Q,{title:"Confirmation"},{default:o(()=>[e(O,null,{default:o(()=>[V(" Are you sure you want to delete this record ? ")]),_:1}),e(O,{class:"d-flex justify-end gap-3 flex-wrap"},{default:o(()=>[e(b,{color:"secondary",variant:"tonal",onClick:n[16]||(n[16]=a=>G())},{default:o(()=>[V(" Disagree ")]),_:1}),e(b,{onClick:pe},{default:o(()=>[V(" Agree ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};typeof te=="function"&&te(vt);export{vt as default};
