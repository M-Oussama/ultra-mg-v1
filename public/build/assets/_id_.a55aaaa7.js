import{k as i,Z as oe,r as ne,o as U,b as z,w as t,m as s,p as e,C as k,q as a,P as se,D as b,be as de,E as D,ay as re,bd as ie,$ as Y,A as ye,c as Z,F as be,a as we,x as P,y as xe,H as Ae,I as he}from"./main.7b19b172.js";import{_ as Ce}from"./DialogCloseBtn.28c416d8.js";import{s as B,e as I}from"./errorsMiddleware.bd419519.js";import{u as Q}from"./useAttendanceStore.e6d81dee.js";import{_ as Ee}from"./AppDateTimePicker.11ef7da8.js";import{r as ue}from"./validators.330a354f.js";import{V as W}from"./VSpacer.a799046a.js";import{V as w,a as ee}from"./VBtn.904b12e9.js";import{V as M,c as $}from"./VCard.03d99681.js";import{V as me}from"./VForm.d1fbb96f.js";import{V as G,a as y}from"./VRow.b3e69ea1.js";import{V as F}from"./VInput.62d5391d.js";import{V as L}from"./VTextField.871d1b5f.js";import{V as pe}from"./VNavigationDrawer.c5bfb176.js";import{V as te}from"./VFileInput.2be8e48b.js";import{a as Se}from"./VOverlay.4470c445.js";import{V as H}from"./VDivider.6c7da95a.js";import{V as Ue}from"./VSelect.8008ac98.js";import{V as ke}from"./VTable.22f27e68.js";import{V as Oe}from"./VMenu.44654eb5.js";import{V as Ne,a as ae,b as le}from"./VList.e47c8594.js";import{V as Te}from"./VPagination.d2d87bbe.js";import{V as Pe}from"./VDialog.072640f0.js";import"./VField.eff87378.js";import"./index.52c0e09a.js";import"./position.c9d72007.js";import"./router.1e54b0b6.js";import"./easing.36b781ab.js";import"./index.b522f886.js";import"./VAvatar.f5851687.js";import"./VImg.59c8e4a2.js";import"./forwardRefs.c003b6b8.js";/* empty css                   */import"./VCounter.1da14a61.js";import"./ssrBoot.8e1c269c.js";import"./VChip.f21b7501.js";import"./lazy.dceec4d7.js";import"./dialog-transition.8bee46e3.js";import"./VCheckboxBtn.309c0e7a.js";import"./VSelectionControl.04732578.js";import"./scopeId.f3c34555.js";const $e={class:"d-flex align-center pa-6 pb-1"},Fe=s("h6",{class:"text-h6"}," Update End Date ",-1),Re={__name:"EditEmployeeAttendanceDrawer",props:{isDrawerOpen:{type:null,required:!0},loading:{type:null,required:!0},employee:{type:Object,required:!0},disableEndDate:{type:Boolean,required:!0},disableStartDate:{type:Boolean,required:!0}},setup(N){const r=N,E=Q(),u=i({start_date:"",end_date:"",real_start_date:"",real_end_date:"",position:""});oe(r.isDrawerOpen,()=>{r.isDrawerOpen.open&&(console.log(r.employee),u.value.id=r.employee.id||"",u.value.start_date=r.employee.start_date||"",u.value.end_date=r.employee.end_date||"",u.value.real_start_date=r.employee.real_start_date||"",u.value.real_end_date=r.employee.real_end_date||"",u.value.position=r.employee.position||"")});const o=i(!1),x=i();i(),i({id:-1});const A=()=>{r.isDrawerOpen.open=!1,re(()=>{var p,c;(p=x.value)==null||p.reset(),(c=x.value)==null||c.resetValidation()})},h=()=>{r.loading.isActive=!0,console.log(r.loading),E.updateEndDate(u.value.end_date,u.value.start_date,u.value.id,u.value.position).then(p=>{r.isDrawerOpen.open=!1,r.loading.isActive=!1,r.employee.end_date=p.data.endDate,B(p.data.msg)}).catch(p=>{r.loading.isActive=!1,I("Error Occured",p.response.data.message)})},C=p=>{r.isDrawerOpen.value.open=p};return(p,c)=>{const S=Ee,g=ne("VueDatePicker");return U(),z(pe,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":r.isDrawerOpen.open,"onUpdate:modelValue":C},{default:t(()=>[s("div",$e,[Fe,e(W),e(w,{variant:"tonal",color:"default",icon:"",size:"32",class:"rounded",onClick:A},{default:t(()=>[e(k,{size:"18",icon:"tabler-x"})]),_:1})]),e(a(se),{options:{wheelPropagation:!1}},{default:t(()=>[e(M,{flat:""},{default:t(()=>[e($,null,{default:t(()=>[e(me,{ref_key:"refForm",ref:x,modelValue:a(o),"onUpdate:modelValue":c[5]||(c[5]=v=>b(o)?o.value=v:null),onSubmit:de(h,["prevent"])},{default:t(()=>[e(G,null,{default:t(()=>[e(y,{cols:"12"},{default:t(()=>[e(S,{modelValue:a(u).start_date,"onUpdate:modelValue":c[0]||(c[0]=v=>a(u).start_date=v),label:"Start Date",disabled:N.disableStartDate},null,8,["modelValue","disabled"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(S,{modelValue:a(u).end_date,"onUpdate:modelValue":c[1]||(c[1]=v=>a(u).end_date=v),label:"End Date",config:{minDate:`

                  ${a(u).start_date}`},disabled:N.disableEndDate},null,8,["modelValue","config","disabled"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(F,null,{default:t(()=>[D(" REAL START DATE ")]),_:1}),e(g,{modelValue:a(u).real_start_date,"onUpdate:modelValue":[c[2]||(c[2]=v=>a(u).real_start_date=v),p.onStartDateChanged],"auto-apply":"",format:p.format},null,8,["modelValue","format","onUpdate:modelValue"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(F,null,{default:t(()=>[D(" REAL END DATE ")]),_:1}),e(g,{modelValue:a(u).real_end_date,"onUpdate:modelValue":c[3]||(c[3]=v=>a(u).real_end_date=v),"auto-apply":"",format:p.format,"min-date":a(u).end_date_restrict},null,8,["modelValue","format","min-date"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(L,{modelValue:a(u).position,"onUpdate:modelValue":c[4]||(c[4]=v=>a(u).position=v),rules:[a(ue)],label:"Position"},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(w,{type:"submit",class:"me-3"},{default:t(()=>[D(" Submit ")]),_:1}),e(w,{type:"reset",variant:"tonal",color:"secondary",onClick:A},{default:t(()=>[D(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};const ze={class:"d-flex align-center pa-6 pb-1"},Ie=s("h6",{class:"text-h6"}," Add New Record ",-1),Be={__name:"AddEmployeeAttendanceDrawer",props:{isDrawerOpen:{type:null,required:!0},loading:{type:null,required:!0},employees:{type:Object,required:!0}},setup(N){const r=N,E=Q(),u=ie(),o=i({start_date:new Date().getFullYear()+"-"+(new Date().getMonth()+1)+"-"+new Date().getDate(),end_date:"",end_date_restrict:new Date().getFullYear()+"-"+(new Date().getMonth()+1)+"-"+(new Date().getDate()+1),position:"",real_start_date:"",real_end_date:"",national_card:"",birth_certificate:""}),x=i(!1),A=i();i(),i({id:-1});const h=()=>{r.isDrawerOpen.open=!1,re(()=>{var m,d;(m=A.value)==null||m.reset(),(d=A.value)==null||d.resetValidation()})},C=()=>{var m=new FileReader;m.readAsDataURL(o.value.birth_certificate[0]),m.onload=function(){let d=m.result;var V=new FileReader;V.readAsDataURL(o.value.national_card[0]),V.onload=function(){let _=m.result;p(d,_)}},m.onerror=function(d){return""}},p=(m,d)=>{o.value.start_date===""?I("Warning","start date must be selected"):(r.loading.isActive=!0,console.log(r.loading),E.addEmployeeAttendanceRecord(o.value.end_date,o.value.start_date,Number(u.params.id),o.value.position,m,d).then(V=>{r.isDrawerOpen.open=!1,r.loading.isActive=!1,B(V.data.msg)}).catch(V=>{r.loading.isActive=!1,I("Error Occured",V.response.data.message)}))},c=m=>{r.isDrawerOpen.value.open=m};function S(m){return parseInt(m)<10?"0"+m:m}const g=m=>{const d=m.getDate(),V=m.getMonth()+1;return`${m.getFullYear()}-${S(V)}-${S(d)}`},v=()=>{(o.value.start_date===""||o.value.start_date>=o.value.end_date&&o.value.end_date!=="")&&(o.value.end_date=""),o.value.end_date_restrict=new Date(new Date(o.value.start_date).getTime()+24*60*60*2e3).toISOString().split("T")[0]};return(m,d)=>{const V=ne("VueDatePicker");return U(),z(pe,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":r.isDrawerOpen.open,"onUpdate:modelValue":c},{default:t(()=>[s("div",ze,[Ie,e(W),e(w,{variant:"tonal",color:"default",icon:"",size:"32",class:"rounded",onClick:h},{default:t(()=>[e(k,{size:"18",icon:"tabler-x"})]),_:1})]),e(a(se),{options:{wheelPropagation:!1}},{default:t(()=>[e(M,{flat:""},{default:t(()=>[e($,null,{default:t(()=>[e(me,{ref_key:"refForm",ref:A,modelValue:a(x),"onUpdate:modelValue":d[7]||(d[7]=_=>b(x)?x.value=_:null),onSubmit:de(C,["prevent"])},{default:t(()=>[e(G,null,{default:t(()=>[e(y,{cols:"12"},{default:t(()=>[e(F,null,{default:t(()=>[D(" CNAS START DATE ")]),_:1}),e(V,{modelValue:a(o).start_date,"onUpdate:modelValue":[d[0]||(d[0]=_=>a(o).start_date=_),v],"auto-apply":"",format:g},null,8,["modelValue"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(F,null,{default:t(()=>[D(" CNAS END DATE ")]),_:1}),e(V,{modelValue:a(o).end_date,"onUpdate:modelValue":d[1]||(d[1]=_=>a(o).end_date=_),"auto-apply":"",format:g,"min-date":a(o).end_date_restrict},null,8,["modelValue","min-date"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(F,null,{default:t(()=>[D(" REAL START DATE ")]),_:1}),e(V,{modelValue:a(o).real_start_date,"onUpdate:modelValue":[d[2]||(d[2]=_=>a(o).real_start_date=_),v],"auto-apply":"",format:g},null,8,["modelValue"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(F,null,{default:t(()=>[D(" REAL END DATE ")]),_:1}),e(V,{modelValue:a(o).real_end_date,"onUpdate:modelValue":d[3]||(d[3]=_=>a(o).real_end_date=_),"auto-apply":"",format:g,"min-date":a(o).end_date_restrict},null,8,["modelValue","min-date"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(L,{modelValue:a(o).position,"onUpdate:modelValue":d[4]||(d[4]=_=>a(o).position=_),rules:[a(ue)],label:"Position"},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(te,{modelValue:a(o).national_card,"onUpdate:modelValue":d[5]||(d[5]=_=>a(o).national_card=_),label:"National Card",variant:"filled"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(te,{modelValue:a(o).birth_certificate,"onUpdate:modelValue":d[6]||(d[6]=_=>a(o).birth_certificate=_),label:"Birth Certificate",variant:"filled"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(w,{type:"submit",class:"me-3"},{default:t(()=>[D(" Submit ")]),_:1}),e(w,{type:"reset",variant:"tonal",color:"secondary",onClick:h},{default:t(()=>[D(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};const Me={class:"me-3",style:{width:"80px"}},Le={style:{width:"12rem"}},qe={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},je={style:{width:"9rem"}},Ye=s("thead",null,[s("tr",null,[s("th",{scope:"col"}," ID "),s("th",{scope:"col"}," Start Date "),s("th",{scope:"col"}," End Date "),s("th",{scope:"col"}," Period "),s("th",{scope:"col"}," Position "),s("th",{scope:"col"}," ACTIONS ")])],-1),Ze={class:"d-flex align-center"},He={class:"d-flex flex-column"},Qe={class:"text-base"},We={class:"d-flex align-center"},Ge={class:"d-flex flex-column"},Je={class:"text-base"},Ke={class:"d-flex align-center"},Xe={class:"d-flex flex-column"},et={class:"text-base"},tt={class:"d-flex align-center"},at={class:"d-flex flex-column"},lt={class:"text-base"},ot={class:"text-center",style:{width:"5rem"}},nt=s("tr",null,[s("td",{colspan:"7",class:"text-center"}," No data available ")],-1),st=[nt],dt={class:"text-sm text-disabled"},Wt={__name:"[id]",setup(N){const r=Q(),E=i(""),u=i(!1),o=i({isActive:!0}),x=ie(),A=i(!0);i();const h=i("mahgounoussama23@gmail.com");i(),i();const C=i(10),p=i(1),c=i(1),S=i(0);let g=i([]),v=i({open:!1}),m=i({open:!1}),d=i({open:!1}),V=i(!1),_=i(!0);const q=()=>{o.value.isActive=!0,r.fetchEmployeesByAttendance(Number(x.params.id)).then(f=>{g.value=f.data.employees.data,c.value=f.data.totalPage,S.value=f.data.totalEmployees,u.value=!1,o.value.isActive=!1,console.log(f)}).catch(f=>{console.error(f),o.value.isActive=!1})};Y(q),Y(()=>{p.value>c.value&&(p.value=c.value)}),oe(E,()=>{q()}),i(!1);let O=i(null);Y(()=>{p.value>c.value&&(p.value=c.value)});const ce=ye(()=>{const f=g.value.length?(p.value-1)*C.value+1:0,n=g.value.length+(p.value-1)*C.value;return`Showing ${f} to ${n} of ${S.value} entries`}),fe=f=>{O.value=f,v.value.open=!0},_e=f=>{O.value=f,m.value.open=!0},ve=()=>{d.value.open=!0},Ve=()=>{o.value.isActive=!0,m.value.open=!1,r.deleteCareer(O.value.id).then(f=>{o.value.isActive=!1,B(f.data.message),q()}).catch(f=>{I(f.data.message),o.value.isActive=!1})},J=()=>{m.value.open=!1},ge=f=>{let n=new Date(f.end_date);f.end_date||(n=new Date);const j=n-new Date(f.start_date),l=Math.floor(j/(1e3*60*60*24)),R=Math.floor(l/365),K=Math.floor(l%365/30),X=l%30;let T="";return R>0&&(T+=("0"+R).slice(-2)+" years, "),K>0&&(T+=("0"+K).slice(-2)+" months, "),X>0&&(T+=("0"+X).slice(-2)+" days"),T=T.replace(/,\s*$/,""),T},De=f=>{console.log(f),o.value.isActive=!0,r.generateEmail(f.id,h.value).then(n=>{o.value.isActive=!1,B(n.data.message)}).catch(n=>{I(n.data.message),o.value.isActive=!1})};return(f,n)=>{const j=Ce;return U(),Z("section",null,[e(G,null,{default:t(()=>[e(Se,{"model-value":a(o).isActive,class:"align-center justify-center"},{default:t(()=>[e(ee,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),e(y,{cols:"12"},{default:t(()=>[e(M,{title:"Employees"},{default:t(()=>[e(H),e($,{class:"d-flex flex-wrap py-4 gap-4"},{default:t(()=>[s("div",Me,[e(Ue,{modelValue:a(C),"onUpdate:modelValue":n[0]||(n[0]=l=>b(C)?C.value=l:null),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"])]),s("div",Le,[e(L,{onInput:n[1]||(n[1]=l=>A.value=!0),ref:"searchField",modelValue:a(h),"onUpdate:modelValue":n[2]||(n[2]=l=>b(h)?h.value=l:null),placeholder:"Email",density:"compact"},null,8,["modelValue"])]),e(W),s("div",qe,[s("div",je,[a(u)?(U(),z(ee,{key:0,indeterminate:"",color:"primary"})):(U(),z(L,{key:1,onInput:n[3]||(n[3]=l=>A.value=!0),ref:"searchField",modelValue:a(E),"onUpdate:modelValue":n[4]||(n[4]=l=>b(E)?E.value=l:null),placeholder:"Search",density:"compact"},null,8,["modelValue"]))]),e(w,{variant:"tonal",color:"secondary","prepend-icon":"tabler-screen-share"},{default:t(()=>[D(" Export ")]),_:1}),e(w,{color:"primary","prepend-icon":"tabler-plus",onClick:n[5]||(n[5]=l=>ve())},{default:t(()=>[D(" New Record ")]),_:1})])]),_:1}),e(H),e(ke,{class:"text-no-wrap"},{default:t(()=>[Ye,s("tbody",null,[(U(!0),Z(be,null,we(a(g),l=>(U(),Z("tr",{key:l.id,style:{height:"3.75rem"}},[s("td",null,P(l.id),1),s("td",null,[s("div",Ze,[s("div",He,[s("h6",Qe,P(l.start_date),1)])])]),s("td",null,[s("div",We,[s("div",Ge,[s("h6",Je,P(l.end_date),1)])])]),s("td",null,[s("div",Ke,[s("div",Xe,[s("h6",et,P(ge(l)),1)])])]),s("td",null,[s("div",tt,[s("div",at,[s("h6",lt,P(l.position),1)])])]),s("td",ot,[l.last?(U(),z(w,{key:0,icon:"",size:"x-small",color:"default",variant:"text",onClick:R=>fe(l)},{default:t(()=>[e(k,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"])):xe("",!0),e(w,{icon:"",size:"x-small",color:"default",variant:"text"},{default:t(()=>[e(k,{size:"22",icon:"tabler-trash",onClick:R=>_e(l)},null,8,["onClick"])]),_:2},1024),e(w,{icon:"",size:"x-small",color:"default",variant:"text"},{default:t(()=>[e(k,{size:"22",icon:"tabler-send",onClick:R=>De(l)},null,8,["onClick"])]),_:2},1024),e(w,{icon:"",variant:"text",color:"default",size:"x-small"},{default:t(()=>[e(k,{size:22,icon:"tabler-dots-vertical"}),e(Oe,{activator:"parent"},{default:t(()=>[e(Ne,{density:"compact"},{default:t(()=>[e(ae,{value:"BC",href:l.BC},{prepend:t(()=>[e(k,{size:"22",class:"me-3",icon:"tabler-download"})]),default:t(()=>[e(le,null,{default:t(()=>[D("Birth Certificate")]),_:1})]),_:2},1032,["href"]),e(ae,{value:"NC",href:l.NC},{prepend:t(()=>[e(k,{size:"22",class:"me-3",icon:"tabler-download"})]),default:t(()=>[e(le,null,{default:t(()=>[D("National Card")]),_:1})]),_:2},1032,["href"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])]))),128))]),Ae(s("tfoot",null,st,512),[[he,!a(g).length]])]),_:1}),e(H),e($,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3 px-5"},{default:t(()=>[s("span",dt,P(a(ce)),1),e(Te,{modelValue:a(p),"onUpdate:modelValue":n[6]||(n[6]=l=>b(p)?p.value=l:null),size:"small","total-visible":5,length:a(c)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Re,{isDrawerOpen:a(v),"onUpdate:isDrawerOpen":n[7]||(n[7]=l=>b(v)?v.value=l:v=l),employee:a(O),"onUpdate:employee":n[8]||(n[8]=l=>b(O)?O.value=l:O=l),"disable-end-date":a(V),"onUpdate:disable-end-date":n[9]||(n[9]=l=>b(V)?V.value=l:V=l),loading:a(o),"onUpdate:loading":n[10]||(n[10]=l=>b(o)?o.value=l:null),"disable-start-date":a(_),"onUpdate:disable-start-date":n[11]||(n[11]=l=>b(_)?_.value=l:_=l)},null,8,["isDrawerOpen","employee","disable-end-date","loading","disable-start-date"]),e(Be,{isDrawerOpen:a(d),"onUpdate:isDrawerOpen":n[12]||(n[12]=l=>b(d)?d.value=l:d=l),employees:a(g),"onUpdate:employees":n[13]||(n[13]=l=>b(g)?g.value=l:g=l),loading:a(o),"onUpdate:loading":n[14]||(n[14]=l=>b(o)?o.value=l:null)},null,8,["isDrawerOpen","employees","loading"]),e(Pe,{modelValue:a(m).open,"onUpdate:modelValue":n[17]||(n[17]=l=>a(m).open=l),persistent:"",class:"v-dialog-sm"},{default:t(()=>[e(j,{onClick:n[15]||(n[15]=l=>J())}),e(M,{title:"Confirmation"},{default:t(()=>[e($,null,{default:t(()=>[D(" Are you sure you want to delete this record ? ")]),_:1}),e($,{class:"d-flex justify-end gap-3 flex-wrap"},{default:t(()=>[e(w,{color:"secondary",variant:"tonal",onClick:n[16]||(n[16]=l=>J())},{default:t(()=>[D(" Disagree ")]),_:1}),e(w,{onClick:Ve},{default:t(()=>[D(" Agree ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{Wt as default};
