import{bd as oe,k as u,r as pe,o as w,b as F,w as l,m as i,p as e,C as A,q as n,P as ve,D as _,be as _e,E as V,ay as Ve,$ as q,Z as ge,A as De,c as j,F as be,a as ye,x as N,y as Y,H as we,I as xe}from"./main.f953bb32.js";import{_ as he}from"./DialogCloseBtn.d8d8323c.js";import{s as H}from"./successMiddleware.cdacaeb5.js";import{e as P}from"./errorsMiddleware.9f89ec9d.js";import{u as ne}from"./useAttendanceStore.94a8335b.js";import{_ as Ae}from"./EditEmployeeAttendanceDrawer.e9434b83.js";import{r as X}from"./validators.330a354f.js";import{V as se}from"./VSpacer.97180599.js";import{V as D,a as ee}from"./VBtn.53826497.js";import{V as Q,c as O}from"./VCard.7307dc50.js";import{V as Ce}from"./VForm.4c472cc7.js";import{V as ie,a as y}from"./VRow.463c82a5.js";import{V as I}from"./VInput.1c807576.js";import{V as B}from"./VTextField.b3fcc6a6.js";import{V as te}from"./VFileInput.a4424bca.js";import{V as Ee}from"./VNavigationDrawer.81f726b4.js";import{a as Ue}from"./VOverlay.00baf023.js";import{V as Z}from"./VDivider.0296d5ca.js";import{V as ke}from"./VSelect.64bf3f05.js";import{V as Se}from"./VTable.69dd1c1a.js";import{V as Ne}from"./VMenu.4462e6e8.js";import{V as Fe,b as ae,a as le}from"./VList.b77b6faf.js";import{V as Re}from"./VPagination.0b1cb419.js";import{V as $e}from"./VDialog.c5a0cc45.js";import"./AppDateTimePicker.220e8818.js";import"./VField.f20494b5.js";import"./index.bcea3609.js";import"./position.20814070.js";import"./router.392dd72d.js";import"./easing.36b781ab.js";import"./index.b522f886.js";import"./VAvatar.cb499833.js";import"./VImg.4ecfe5db.js";import"./forwardRefs.c003b6b8.js";/* empty css                   */import"./VCounter.7a557e1b.js";import"./VChip.713d6306.js";import"./ssrBoot.9eb188de.js";import"./lazy.16b1c569.js";import"./dialog-transition.d5a03f10.js";import"./VCheckboxBtn.2d0ad59f.js";import"./VSelectionControl.8ce3f773.js";import"./scopeId.26638b4f.js";const Te={class:"d-flex align-center pa-6 pb-1"},Oe=i("h6",{class:"text-h6"}," Add New Record ",-1),ze={__name:"AddEmployeeAttendanceDrawer",props:{isDrawerOpen:{type:null,required:!0},loading:{type:null,required:!0},employees:{type:Object,required:!0}},setup(W){const g=W,U=ne(),z=oe(),t=u({start_date:new Date().getFullYear()+"-"+(new Date().getMonth()+1)+"-"+new Date().getDate(),end_date:"",end_date_restrict:new Date().getFullYear()+"-"+(new Date().getMonth()+1)+"-"+(new Date().getDate()+1),position:"",position_ar:"",real_start_date:"",real_end_date:"",national_card:"",birth_certificate:""}),R=u(!1),k=u();u(),u({id:-1});const C=()=>{g.isDrawerOpen.open=!1,Ve(()=>{var d,s;(d=k.value)==null||d.reset(),(s=k.value)==null||s.resetValidation()})},E=()=>{if(console.log(t),t.value.birth_certificate[0]===void 0&&t.value.national_card[0]===void 0&&f(null,null),t.value.birth_certificate[0]!==void 0&&t.value.national_card[0]===void 0){var d=new FileReader;d.readAsDataURL(t.value.birth_certificate[0]),d.onload=function(){let r=d.result;f(r,null)},d.onerror=function(r){return""}}if(t.value.national_card[0]!==void 0&&t.value.birth_certificate[0]===void 0){var s=new FileReader;s.readAsDataURL(t.value.national_card[0]),s.onload=function(){let r=s.result;f(null,r)},s.onerror=function(r){return""}}if(t.value.birth_certificate[0]!==void 0&&t.value.national_card[0]!==void 0){console.log("here");var m=new FileReader;m.readAsDataURL(t.value.birth_certificate[0]),m.onload=function(){let r=m.result;if(t.value.national_card[0]!==void 0){var v=new FileReader;v.readAsDataURL(t.value.national_card[0]),v.onload=function(){let M=v.result;f(r,M)}}},m.onerror=function(r){return""}}},f=(d,s)=>{t.value.start_date===""?P("Warning","start date must be selected"):(g.loading.isActive=!0,console.log(g.loading),U.addEmployeeAttendanceRecord(b(t.value.end_date),b(t.value.start_date),Number(z.params.id),t.value.position,d,s,b(t.value.real_start_date),b(t.value.real_end_date),t.value.position_ar).then(m=>{g.isDrawerOpen.open=!1,g.loading.isActive=!1,H(m.data.msg),location.reload()}).catch(m=>{g.loading.isActive=!1,P("Error Occured",m.response.data.message)}))},x=d=>{g.isDrawerOpen.value.open=d};function $(d){return parseInt(d)<10?"0"+d:d}const p=d=>{const s=d.getDate(),m=d.getMonth()+1;return`${d.getFullYear()}-${$(m)}-${$(s)}`},h=()=>{(t.value.start_date===""||t.value.start_date>=t.value.end_date&&t.value.end_date!=="")&&(t.value.end_date=""),t.value.end_date_restrict=new Date(new Date(t.value.start_date).getTime()+24*60*60*2e3).toISOString().split("T")[0]},b=d=>{if(d!=null&&d!==""){console.log(d);let s=new Date(d),m=s.getFullYear(),r=String(s.getMonth()+1).padStart(2,"0"),v=String(s.getDate()).padStart(2,"0");return`${m}-${r}-${v}`}return d};return(d,s)=>{const m=pe("VueDatePicker");return w(),F(Ee,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":g.isDrawerOpen.open,"onUpdate:modelValue":x},{default:l(()=>[i("div",Te,[Oe,e(se),e(D,{variant:"tonal",color:"default",icon:"",size:"32",class:"rounded",onClick:C},{default:l(()=>[e(A,{size:"18",icon:"tabler-x"})]),_:1})]),e(n(ve),{options:{wheelPropagation:!1}},{default:l(()=>[e(Q,{flat:""},{default:l(()=>[e(O,null,{default:l(()=>[e(Ce,{ref_key:"refForm",ref:k,modelValue:n(R),"onUpdate:modelValue":s[8]||(s[8]=r=>_(R)?R.value=r:null),onSubmit:_e(E,["prevent"])},{default:l(()=>[e(ie,null,{default:l(()=>[e(y,{cols:"12"},{default:l(()=>[e(I,null,{default:l(()=>[V(" CNAS START DATE ")]),_:1}),e(m,{modelValue:n(t).start_date,"onUpdate:modelValue":[s[0]||(s[0]=r=>n(t).start_date=r),h],"auto-apply":"",format:p},null,8,["modelValue"])]),_:1}),e(y,{cols:"12"},{default:l(()=>[e(I,null,{default:l(()=>[V(" CNAS END DATE ")]),_:1}),e(m,{modelValue:n(t).end_date,"onUpdate:modelValue":s[1]||(s[1]=r=>n(t).end_date=r),"auto-apply":"",format:p,"min-date":n(t).end_date_restrict},null,8,["modelValue","min-date"])]),_:1}),e(y,{cols:"12"},{default:l(()=>[e(I,null,{default:l(()=>[V(" REAL START DATE ")]),_:1}),e(m,{modelValue:n(t).real_start_date,"onUpdate:modelValue":[s[2]||(s[2]=r=>n(t).real_start_date=r),h],"auto-apply":"",format:p},null,8,["modelValue"])]),_:1}),e(y,{cols:"12"},{default:l(()=>[e(I,null,{default:l(()=>[V(" REAL END DATE ")]),_:1}),e(m,{modelValue:n(t).real_end_date,"onUpdate:modelValue":s[3]||(s[3]=r=>n(t).real_end_date=r),"auto-apply":"",format:p,"min-date":n(t).end_date_restrict},null,8,["modelValue","min-date"])]),_:1}),e(y,{cols:"12"},{default:l(()=>[e(B,{modelValue:n(t).position,"onUpdate:modelValue":s[4]||(s[4]=r=>n(t).position=r),rules:[n(X)],label:"Position"},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12"},{default:l(()=>[e(B,{modelValue:n(t).position_ar,"onUpdate:modelValue":s[5]||(s[5]=r=>n(t).position_ar=r),rules:[n(X)],label:"Position Arabic"},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12"},{default:l(()=>[e(te,{modelValue:n(t).national_card,"onUpdate:modelValue":s[6]||(s[6]=r=>n(t).national_card=r),label:"National Card",variant:"filled"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12"},{default:l(()=>[e(te,{modelValue:n(t).birth_certificate,"onUpdate:modelValue":s[7]||(s[7]=r=>n(t).birth_certificate=r),label:"Birth Certificate",variant:"filled"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12"},{default:l(()=>[e(D,{type:"submit",class:"me-3"},{default:l(()=>[V(" Submit ")]),_:1}),e(D,{type:"reset",variant:"tonal",color:"secondary",onClick:C},{default:l(()=>[V(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};const Ie={class:"me-3",style:{width:"80px"}},Pe={style:{width:"12rem"}},Be={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Me={style:{width:"9rem"}},Le=i("thead",null,[i("tr",null,[i("th",{scope:"col"}," ID "),i("th",{scope:"col"}," Start Date "),i("th",{scope:"col"}," End Date "),i("th",{scope:"col"}," Period "),i("th",{scope:"col"}," Position "),i("th",{scope:"col"}," ACTIONS ")])],-1),qe={class:"d-flex align-center"},je={class:"d-flex flex-column"},Ye={class:"text-base"},Ze={class:"d-flex align-center"},He={class:"d-flex flex-column"},Qe={class:"text-base"},We={class:"d-flex align-center"},Ge={class:"d-flex flex-column"},Je={class:"text-base"},Ke={class:"d-flex align-center"},Xe={class:"d-flex flex-column"},et={class:"text-base"},tt={class:"text-center",style:{width:"5rem"}},at=i("tr",null,[i("td",{colspan:"7",class:"text-center"}," No data available ")],-1),lt=[at],ot={class:"text-sm text-disabled"},Qt={__name:"[id]",setup(W){const g=ne(),U=u(""),z=u(!1),t=u({isActive:!0}),R=oe(),k=u(!0);u();const C=u("mahgounoussama23@gmail.com");u(),u();const E=u(10),f=u(1),x=u(1),$=u(0);let p=u([]),h=u({open:!1}),b=u({open:!1}),d=u({open:!1}),s=u(!1),m=u(!0);const r=()=>{t.value.isActive=!0,g.fetchEmployeesByAttendance(Number(R.params.id)).then(c=>{p.value=c.data.employees.data,x.value=c.data.totalPage,$.value=c.data.totalEmployees,z.value=!1,t.value.isActive=!1,console.log(c)}).catch(c=>{console.error(c),t.value.isActive=!1})};q(r),q(()=>{f.value>x.value&&(f.value=x.value)}),ge(U,()=>{r()}),u(!1);let v=u(null);q(()=>{f.value>x.value&&(f.value=x.value)});const M=De(()=>{const c=p.value.length?(f.value-1)*E.value+1:0,o=p.value.length+(f.value-1)*E.value;return`Showing ${c} to ${o} of ${$.value} entries`}),re=c=>{v.value=c,h.value.open=!0},de=c=>{v.value=c,b.value.open=!0},ue=()=>{d.value.open=!0},ce=()=>{t.value.isActive=!0,b.value.open=!1,g.deleteCareer(v.value.id).then(c=>{t.value.isActive=!1,H(c.data.message),r()}).catch(c=>{P(c.data.message),t.value.isActive=!1})},G=()=>{b.value.open=!1},me=c=>{let o=new Date(c.end_date);c.end_date||(o=new Date);const L=o-new Date(c.start_date),a=Math.floor(L/(1e3*60*60*24)),T=Math.floor(a/365),J=Math.floor(a%365/30),K=a%30;let S="";return T>0&&(S+=("0"+T).slice(-2)+" years, "),J>0&&(S+=("0"+J).slice(-2)+" months, "),K>0&&(S+=("0"+K).slice(-2)+" days"),S=S.replace(/,\s*$/,""),S},fe=c=>{console.log(c),t.value.isActive=!0,g.generateEmail(c.id,C.value).then(o=>{t.value.isActive=!1,H(o.data.message)}).catch(o=>{P(o.data.message),t.value.isActive=!1})};return(c,o)=>{const L=he;return w(),j("section",null,[e(ie,null,{default:l(()=>[e(Ue,{"model-value":n(t).isActive,class:"align-center justify-center"},{default:l(()=>[e(ee,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),e(y,{cols:"12"},{default:l(()=>[e(Q,{title:"Employees"},{default:l(()=>[e(Z),e(O,{class:"d-flex flex-wrap py-4 gap-4"},{default:l(()=>[i("div",Ie,[e(ke,{modelValue:n(E),"onUpdate:modelValue":o[0]||(o[0]=a=>_(E)?E.value=a:null),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"])]),i("div",Pe,[e(B,{onInput:o[1]||(o[1]=a=>k.value=!0),ref:"searchField",modelValue:n(C),"onUpdate:modelValue":o[2]||(o[2]=a=>_(C)?C.value=a:null),placeholder:"Email",density:"compact"},null,8,["modelValue"])]),e(se),i("div",Be,[i("div",Me,[n(z)?(w(),F(ee,{key:0,indeterminate:"",color:"primary"})):(w(),F(B,{key:1,onInput:o[3]||(o[3]=a=>k.value=!0),ref:"searchField",modelValue:n(U),"onUpdate:modelValue":o[4]||(o[4]=a=>_(U)?U.value=a:null),placeholder:"Search",density:"compact"},null,8,["modelValue"]))]),e(D,{variant:"tonal",color:"secondary","prepend-icon":"tabler-screen-share"},{default:l(()=>[V(" Export ")]),_:1}),e(D,{color:"primary","prepend-icon":"tabler-plus",onClick:o[5]||(o[5]=a=>ue())},{default:l(()=>[V(" New Record ")]),_:1})])]),_:1}),e(Z),e(Se,{class:"text-no-wrap"},{default:l(()=>[Le,i("tbody",null,[(w(!0),j(be,null,ye(n(p),a=>(w(),j("tr",{key:a.id,style:{height:"3.75rem"}},[i("td",null,N(a.id),1),i("td",null,[i("div",qe,[i("div",je,[i("h6",Ye,N(a.start_date),1)])])]),i("td",null,[i("div",Ze,[i("div",He,[i("h6",Qe,N(a.end_date),1)])])]),i("td",null,[i("div",We,[i("div",Ge,[i("h6",Je,N(me(a)),1)])])]),i("td",null,[i("div",Ke,[i("div",Xe,[i("h6",et,N(a.position),1)])])]),i("td",tt,[a.last?(w(),F(D,{key:0,icon:"",size:"x-small",color:"default",variant:"text",onClick:T=>re(a)},{default:l(()=>[e(A,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"])):Y("",!0),e(D,{icon:"",size:"x-small",color:"default",variant:"text",to:{name:"apps-employee-vacation-id",params:{id:a.id}}},{default:l(()=>[e(A,{size:"22",icon:"tabler-user-check"})]),_:2},1032,["to"]),e(D,{icon:"",size:"x-small",color:"default",variant:"text"},{default:l(()=>[e(A,{size:"22",icon:"tabler-trash",onClick:T=>de(a)},null,8,["onClick"])]),_:2},1024),e(D,{icon:"",size:"x-small",color:"default",variant:"text"},{default:l(()=>[e(A,{size:"22",icon:"tabler-send",onClick:T=>fe(a)},null,8,["onClick"])]),_:2},1024),e(D,{icon:"",variant:"text",color:"default",size:"x-small"},{default:l(()=>[e(A,{size:22,icon:"tabler-dots-vertical"}),e(Ne,{activator:"parent"},{default:l(()=>[e(Fe,{density:"compact"},{default:l(()=>[a.BC?(w(),F(le,{key:0,value:"BC",href:a.BC},{prepend:l(()=>[e(A,{size:"22",class:"me-3",icon:"tabler-download"})]),default:l(()=>[e(ae,null,{default:l(()=>[V("Birth Certificate")]),_:1})]),_:2},1032,["href"])):Y("",!0),a.NC?(w(),F(le,{key:1,value:"NC",href:a.NC},{prepend:l(()=>[e(A,{size:"22",class:"me-3",icon:"tabler-download"})]),default:l(()=>[e(ae,null,{default:l(()=>[V("National Card")]),_:1})]),_:2},1032,["href"])):Y("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]))),128))]),we(i("tfoot",null,lt,512),[[xe,!n(p).length]])]),_:1}),e(Z),e(O,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3 px-5"},{default:l(()=>[i("span",ot,N(n(M)),1),e(Re,{modelValue:n(f),"onUpdate:modelValue":o[6]||(o[6]=a=>_(f)?f.value=a:null),size:"small","total-visible":5,length:n(x)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Ae,{isDrawerOpen:n(h),"onUpdate:isDrawerOpen":o[7]||(o[7]=a=>_(h)?h.value=a:h=a),employee:n(v),"onUpdate:employee":o[8]||(o[8]=a=>_(v)?v.value=a:v=a),"disable-end-date":n(s),"onUpdate:disable-end-date":o[9]||(o[9]=a=>_(s)?s.value=a:s=a),loading:n(t),"onUpdate:loading":o[10]||(o[10]=a=>_(t)?t.value=a:null),"disable-start-date":n(m),"onUpdate:disable-start-date":o[11]||(o[11]=a=>_(m)?m.value=a:m=a)},null,8,["isDrawerOpen","employee","disable-end-date","loading","disable-start-date"]),e(ze,{isDrawerOpen:n(d),"onUpdate:isDrawerOpen":o[12]||(o[12]=a=>_(d)?d.value=a:d=a),employees:n(p),"onUpdate:employees":o[13]||(o[13]=a=>_(p)?p.value=a:p=a),loading:n(t),"onUpdate:loading":o[14]||(o[14]=a=>_(t)?t.value=a:null)},null,8,["isDrawerOpen","employees","loading"]),e($e,{modelValue:n(b).open,"onUpdate:modelValue":o[17]||(o[17]=a=>n(b).open=a),persistent:"",class:"v-dialog-sm"},{default:l(()=>[e(L,{onClick:o[15]||(o[15]=a=>G())}),e(Q,{title:"Confirmation"},{default:l(()=>[e(O,null,{default:l(()=>[V(" Are you sure you want to delete this record ? ")]),_:1}),e(O,{class:"d-flex justify-end gap-3 flex-wrap"},{default:l(()=>[e(D,{color:"secondary",variant:"tonal",onClick:o[16]||(o[16]=a=>G())},{default:l(()=>[V(" Disagree ")]),_:1}),e(D,{onClick:ce},{default:l(()=>[V(" Agree ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{Qt as default};
