import{k as s,o as x,b as z,w as t,m as r,p as e,C as P,q as o,P as Q,D as y,be as G,E as g,Z as I,$ as E,A as ne,c as T,F as ie,a as se,x as C,H as re,I as ue}from"./main.d0838da3.js";import{_ as de}from"./DialogCloseBtn.dfbf179c.js";import{u as j}from"./useSaleStore.5f8d3d14.js";import{s as L}from"./successMiddleware.7810b3f1.js";import{e as b}from"./errorsMiddleware.0785696e.js";/* empty css                        */import{V as Y}from"./VSpacer.27cbae4e.js";import{V as _,a as H}from"./VBtn.d8db924d.js";import{V as F,c as A}from"./VCard.9b1f82a8.js";import{V as J}from"./VForm.47365830.js";import{V as K,a as w}from"./VRow.10fd63fa.js";import{V as Z}from"./VAutocomplete.04d7cc02.js";import{V as W}from"./VNavigationDrawer.da1e2a98.js";import{_ as me}from"./AppDateTimePicker.3a302d25.js";import{q as pe}from"./VueSearchSelect.8d3d4fb0.js";import{V as X}from"./VTextField.21e071fb.js";import{V as ce}from"./VTextarea.f1dd0859.js";import{a as fe}from"./VOverlay.75263baa.js";import{V as M}from"./VDivider.43577cc2.js";import{V as ve}from"./VSelect.4512a206.js";import{V as ye}from"./VTable.57beb093.js";import{V as _e}from"./VPagination.bb480f11.js";import{V as Ve}from"./VDialog.225916a1.js";import"./VAvatar.83fd3a57.js";import"./router.390136dd.js";import"./VImg.2be96fe3.js";import"./position.2e295d5d.js";import"./VInput.79096a8f.js";import"./index.7e79e22f.js";import"./forwardRefs.c003b6b8.js";import"./filter.91ac11e8.js";import"./VList.2104a7ae.js";import"./VMenu.b3ef4d48.js";import"./scopeId.82d3ec79.js";import"./dialog-transition.126256d7.js";import"./easing.36b781ab.js";import"./VCheckboxBtn.00c9ba0f.js";import"./VSelectionControl.9fdb71fb.js";import"./VChip.c3a21cb8.js";import"./ssrBoot.d9a330cd.js";import"./VField.b81f47ba.js";/* empty css                   */import"./VCounter.9b7bf05a.js";import"./lazy.bbc0a3b2.js";const ge={class:"d-flex align-center pa-6 pb-1"},be=r("h6",{class:"text-h6"}," Add Benefit ",-1),we={__name:"AddNewBenefitDrawer",props:{isDrawerOpen:{type:null,required:!0},data:{type:null,required:!0},months:{type:null,required:!0},years:{type:null,required:!0},loading:{type:null,required:!0}},emits:["benefitData"],setup(U,{emit:k}){const i=U,h=s(!1),a=s(),D=j(),m=s({month:null,year:null}),f=s();s({id:-1});const V=()=>{i.isDrawerOpen.open=!1},O=()=>{m.value.month===null||m.value.year===null?(m.value.client.month===null&&b("Month not selected","Oops! Looks like you forgot to select a Month. Kindly pick at least one month to proceed"),m.value.client.year===null&&b("Month not selected","Oops! Looks like you forgot to select a Year. Kindly pick at least one year to proceed")):(d(),i.loading.isActive=!0,D.storeBenefit(m.value).then(u=>{i.loading.isActive=!1,m.value.month=0,m.value.year=0,L("Benefit created Successfully"),k("benefitData",{data:f})}).catch(u=>{console.log(u),i.loading.isActive=!1,b("Error Occured","Oops! Looks like the Benefit has not been submited ")}))},d=u=>{console.log(u),i.isDrawerOpen.open=!1};return(u,v)=>(x(),z(W,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":i.isDrawerOpen.open,"onUpdate:modelValue":d},{default:t(()=>[r("div",ge,[be,e(Y),e(_,{variant:"tonal",color:"default",icon:"",size:"32",class:"rounded",onClick:V},{default:t(()=>[e(P,{size:"18",icon:"tabler-x"})]),_:1})]),e(o(Q),{options:{wheelPropagation:!1}},{default:t(()=>[e(F,{flat:""},{default:t(()=>[e(A,null,{default:t(()=>[e(J,{ref_key:"refForm",ref:a,modelValue:o(h),"onUpdate:modelValue":v[2]||(v[2]=p=>y(h)?h.value=p:null),onSubmit:G(O,["prevent"])},{default:t(()=>[e(K,null,{default:t(()=>[e(w,{cols:"12"},{default:t(()=>[e(Z,{modelValue:o(m).month,"onUpdate:modelValue":v[0]||(v[0]=p=>o(m).month=p),items:i.months,"item-value":"id","item-title":"name",label:"Month"},null,8,["modelValue","items"])]),_:1}),e(w,{cols:"12"},{default:t(()=>[e(Z,{modelValue:o(m).year,"onUpdate:modelValue":v[1]||(v[1]=p=>o(m).year=p),items:i.years,label:"Year"},null,8,["modelValue","items"])]),_:1}),e(w,{cols:"12"},{default:t(()=>[e(_,{type:"submit",class:"me-3"},{default:t(()=>[g(" Submit ")]),_:1}),e(_,{type:"reset",variant:"tonal",color:"secondary",onClick:V},{default:t(()=>[g(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"]))}},he={class:"d-flex align-center pa-6 pb-1"},De=r("h6",{class:"text-h6"}," Edit Payment ",-1),xe={__name:"EditBenefitDrawer",props:{isDrawerOpen:{type:Boolean,required:!0},payment:{type:Object,required:!0},clients:{type:Object,required:!0},loading:{type:Object,required:!0}},emits:["paymentData"],setup(U,{emit:k}){const i=U,h=j();I(()=>i.payment,d=>{console.log("newPayment"),console.log(d)}),I(i.isDrawerOpen,()=>{i.isDrawerOpen.open&&(a.value.id=i.payment.id||-1,a.value.sale_id=i.payment.sale_id||"",a.value.client_id=i.payment.client_id||"",a.value.amount_paid=i.payment.amount_paid||"",a.value.payment_date=i.payment.payment_date||"",a.value.note=i.payment.note||"")});const a=s({id:0,sale_id:"",client_id:-1,amount_paid:"",payment_date:"",note:""}),D=s(!1),m=s(),f=()=>{i.isDrawerOpen.open=!1},V=()=>{a.client_id===-1||a.amount_paid==="0"||a.payment_date===""||a.note===""?(a.client_id===-1&&b("Client not selected","Oops! Looks like you forgot to select a client. Kindly pick at least one client to proceed"),a.amount_paid==="0"&&b("Amount cannot be 0","The amount value must be higher than 0"),a.amount_paid===""&&b("Amount is Empty","You must enter a value in the amount field"),a.payment_date===""&&b("Payment Date not selected","Please select the payment date")):(i.loading.isActive=!0,h.updatePayment(a.value).then(d=>{i.isDrawerOpen.open=!1,i.loading.isActive=!1,k("paymentData",1),L("Payment updated Successfully")}).catch(d=>{console.log(d),i.loading.isActive=!1,b("Error Occured","Oops! Looks like the payment has not been submited ")}))},O=d=>`${d.name}  ${d.surname}`;return(d,u)=>{const v=me;return x(),z(W,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":i.isDrawerOpen.open},{default:t(()=>[r("div",he,[De,e(Y),e(_,{variant:"tonal",color:"default",icon:"",size:"32",class:"rounded",onClick:f},{default:t(()=>[e(P,{size:"18",icon:"tabler-x"})]),_:1})]),e(o(Q),{options:{wheelPropagation:!1}},{default:t(()=>[e(F,{flat:""},{default:t(()=>[e(A,null,{default:t(()=>[e(J,{ref_key:"refForm",ref:m,modelValue:o(D),"onUpdate:modelValue":u[4]||(u[4]=p=>y(D)?D.value=p:null),onSubmit:G(V,["prevent"])},{default:t(()=>[e(K,null,{default:t(()=>[e(w,{cols:"12"},{default:t(()=>[e(o(pe),{list:i.clients,modelValue:o(a).client_id,"onUpdate:modelValue":u[0]||(u[0]=p=>o(a).client_id=p),"option-value":"id","custom-text":O,hideSelectedOptions:!0,placeholder:"Select Client"},null,8,["list","modelValue"])]),_:1}),e(w,{cols:"12"},{default:t(()=>[e(X,{type:"number",modelValue:o(a).amount_paid,"onUpdate:modelValue":u[1]||(u[1]=p=>o(a).amount_paid=p),min:"0",label:"Payment Amount"},null,8,["modelValue"])]),_:1}),e(w,{cols:"12"},{default:t(()=>[e(v,{modelValue:o(a).payment_date,"onUpdate:modelValue":u[2]||(u[2]=p=>o(a).payment_date=p),label:"Payment Date"},null,8,["modelValue"])]),_:1}),e(w,{cols:"12"},{default:t(()=>[e(ce,{modelValue:o(a).note,"onUpdate:modelValue":u[3]||(u[3]=p=>o(a).note=p),label:"Internal Payment Note"},null,8,["modelValue"])]),_:1}),e(w,{cols:"12"},{default:t(()=>[e(_,{type:"submit",class:"me-3"},{default:t(()=>[g(" Submit ")]),_:1}),e(_,{type:"reset",variant:"tonal",color:"secondary",onClick:f},{default:t(()=>[g(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};const ke={class:"me-3",style:{width:"80px"}},Oe={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Ae={style:{width:"9rem"}},Be=r("thead",null,[r("tr",null,[r("th",{scope:"col"}," ID "),r("th",{scope:"col"}," AMOUNT "),r("th",{scope:"col"}," MONTH/YEAR "),r("th",{scope:"col"}," ACTIONS ")])],-1),Se={class:"text-capitalize text-base font-weight-semibold"},Ce={class:"text-capitalize text-base font-weight-semibold"},Pe={class:"text-center",style:{width:"5rem"}},Ue=r("tr",null,[r("td",{colspan:"7",class:"text-center"}," No data available ")],-1),$e=[Ue],Ne={class:"text-sm text-disabled"},Ot={__name:"index",setup(U){const k=j(),i=s(""),h=s(!1),a=s({isActive:!0}),D=s(!0);s(),s(),s();const m=s(10),f=s(1),V=s(1),O=s(0);let d=s([]),u=s([]),v=s([]),p=s([]);const $=()=>{a.value.isActive=!0,k.fetchBenefits({searchValue:i.value,perPage:m.value,currentPage:f.value}).then(c=>{d.value=c.data.benefits.data,u.value=c.data.months,v.value=c.data.years,V.value=c.data.totalPage,O.value=c.data.totalBenefits,h.value=!1,a.value.isActive=!1}).catch(c=>{console.error(c),a.value.isActive=!1})};E($),E(()=>{f.value>V.value&&(f.value=V.value)}),I(i,()=>{$()});const N=s({open:!1}),q=s({open:!1}),B=s({open:!1}),S=s();E(()=>{f.value>V.value&&(f.value=V.value)});const ee=ne(()=>{const c=d.value.length?(f.value-1)*m.value+1:0,n=d.value.length+(f.value-1)*m.value;return`Showing ${c} to ${n} of ${O.value} entries`}),te=c=>{$()},le=c=>{B.value.open=!0,S.value=c},R=()=>{B.value.open=!1},ae=()=>{a.value.isActive=!0,B.value.open=!1,k.deleteBenefit(S.value.id).then(c=>{a.value.isActive=!1,L(c.data.message),$()}).catch(c=>{b(c.data.message),a.value.isActive=!1})};return(c,n)=>{const oe=de;return x(),T("section",null,[e(K,null,{default:t(()=>[e(fe,{"model-value":o(a).isActive,class:"align-center justify-center"},{default:t(()=>[e(H,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),e(w,{cols:"12"},{default:t(()=>[e(F,{title:"Benefits"},{default:t(()=>[e(M),e(A,{class:"d-flex flex-wrap py-4 gap-4"},{default:t(()=>[r("div",ke,[e(ve,{modelValue:o(m),"onUpdate:modelValue":n[0]||(n[0]=l=>y(m)?m.value=l:null),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"])]),e(Y),r("div",Oe,[r("div",Ae,[o(h)?(x(),z(H,{key:0,indeterminate:"",color:"primary"})):(x(),z(X,{key:1,onInput:n[1]||(n[1]=l=>D.value=!0),ref:"searchField",modelValue:o(i),"onUpdate:modelValue":n[2]||(n[2]=l=>y(i)?i.value=l:null),placeholder:"Search",density:"compact"},null,8,["modelValue"]))]),e(_,{variant:"tonal",color:"secondary","prepend-icon":"tabler-screen-share"},{default:t(()=>[g(" Export ")]),_:1}),e(_,{"prepend-icon":"tabler-plus",onClick:n[3]||(n[3]=l=>o(N).open=!0)},{default:t(()=>[g(" Add Benefit ")]),_:1})])]),_:1}),e(M),e(ye,{class:"text-no-wrap"},{default:t(()=>[Be,r("tbody",null,[(x(!0),T(ie,null,se(o(d),l=>(x(),T("tr",{key:l.id,style:{height:"3.75rem"}},[r("td",null,C(l.id),1),r("td",null,[r("span",Se,C(parseFloat(l.benefit).toFixed(2))+" DZD",1)]),r("td",null,[r("span",Ce,C(o(u)[l.month-1].name)+" / "+C(l.year),1)]),r("td",Pe,[e(_,{icon:"",size:"x-small",color:"default",variant:"text",to:{name:"apps-POS-benefit-edit-id",params:{id:l.id}}},{default:t(()=>[e(P,{size:"22",icon:"tabler-edit"})]),_:2},1032,["to"]),e(_,{icon:"",size:"x-small",color:"default",variant:"text",onClick:ze=>le(l)},{default:t(()=>[e(P,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"]),e(_,{icon:"",size:"x-small",color:"default",variant:"text"},{default:t(()=>[e(P,{size:"22",icon:"tabler-dots-vertical"})]),_:1})])]))),128))]),re(r("tfoot",null,$e,512),[[ue,!o(d).length]])]),_:1}),e(M),e(A,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3 px-5"},{default:t(()=>[r("span",Ne,C(o(ee)),1),e(_e,{modelValue:o(f),"onUpdate:modelValue":n[4]||(n[4]=l=>y(f)?f.value=l:null),size:"small","total-visible":5,length:o(V)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1}),e(we,{isDrawerOpen:o(N),"onUpdate:isDrawerOpen":n[5]||(n[5]=l=>y(N)?N.value=l:null),months:o(u),"onUpdate:months":n[6]||(n[6]=l=>y(u)?u.value=l:u=l),years:o(v),"onUpdate:years":n[7]||(n[7]=l=>y(v)?v.value=l:v=l),benefit:o(d),"onUpdate:benefit":n[8]||(n[8]=l=>y(d)?d.value=l:d=l),loading:o(a),"onUpdate:loading":n[9]||(n[9]=l=>y(a)?a.value=l:null),onBenefitData:c.addNewBenefit},null,8,["isDrawerOpen","months","years","benefit","loading","onBenefitData"]),e(xe,{isDrawerOpen:o(q),"onUpdate:isDrawerOpen":n[10]||(n[10]=l=>y(q)?q.value=l:null),benefit:o(S),"onUpdate:benefit":n[11]||(n[11]=l=>y(S)?S.value=l:null),clients:o(p),"onUpdate:clients":n[12]||(n[12]=l=>y(p)?p.value=l:p=l),loading:o(a),"onUpdate:loading":n[13]||(n[13]=l=>y(a)?a.value=l:null),onBenefitData:te},null,8,["isDrawerOpen","benefit","clients","loading"]),e(Ve,{modelValue:o(B).open,"onUpdate:modelValue":n[16]||(n[16]=l=>o(B).open=l),persistent:"",class:"v-dialog-sm"},{default:t(()=>[e(oe,{onClick:n[14]||(n[14]=l=>R())}),e(F,{title:"Confirmation"},{default:t(()=>[e(A,null,{default:t(()=>[g(" Are you sure you want to delete this record ? ")]),_:1}),e(A,{class:"d-flex justify-end gap-3 flex-wrap"},{default:t(()=>[e(_,{color:"secondary",variant:"tonal",onClick:n[15]||(n[15]=l=>R())},{default:t(()=>[g(" Disagree ")]),_:1}),e(_,{onClick:ae},{default:t(()=>[g(" Agree ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{Ot as default};
