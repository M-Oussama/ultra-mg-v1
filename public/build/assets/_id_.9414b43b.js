import{bd as K,j as I,k as i,$ as E,o as _,b as y,w as l,p as e,q as r,be as z,E as f,c as Q,a as H,F as J,y as S,m as c,D as w}from"./main.eb2abb0f.js";import"./AppDateTimePicker.444d287c.js";import{u as W}from"./useSaleStore.aefb40c5.js";import{s as C}from"./successMiddleware.5e0a2589.js";import{_ as X}from"./InvoiceSendInvoiceDrawer.50480ee8.js";/* empty css                        *//* empty css                                                           *//* empty css                                                        */import{a as Y,V as b}from"./VBtn.4b29655b.js";import{a as Z}from"./VOverlay.8b37277a.js";import{V as R,c as B}from"./VCard.d18cee11.js";import{V as ee}from"./VForm.b7335b57.js";import{V as T,a as n}from"./VRow.fc64865f.js";import{V as v}from"./VInput.12678d62.js";import{V as p}from"./VTextField.cfaf068e.js";import{V as P}from"./VSwitch.10a5493c.js";import"./VField.d31c7729.js";import"./index.1d60d957.js";import"./position.4305ca24.js";import"./router.cee8299d.js";import"./easing.36b781ab.js";import"./VSpacer.47fd3527.js";import"./VAvatar.ef806db0.js";import"./VImg.c89b2431.js";import"./VTextarea.49536005.js";/* empty css                   */import"./forwardRefs.c003b6b8.js";import"./VCounter.28fd36d2.js";import"./VChip.574f5191.js";import"./VNavigationDrawer.5a003ebe.js";import"./ssrBoot.b678eb07.js";import"./lazy.4714770b.js";import"./VSelectionControl.b7f754bc.js";const te=c("h6",{class:"text-sm font-weight-medium mb-3"}," Payment Method: ",-1),le={class:"mt-5 d-flex align-center justify-space-between"},ae={class:"d-flex align-center justify-space-between"},oe={class:"d-flex align-center justify-space-between"},je={__name:"[id]",setup(re){const g=K(),L=I(),u=i([]),s=i({raw_material_price:0,total_profit:0,total_amount:0}),h=i(0),F=W(),m=i({isActive:!1}),M=i(null),k=()=>{F.getArticlesBenefit(Number(g.params.id)).then(a=>{m.isActive=!1,u.value=a.data.articles,s.value=a.data.benefit,s.value.total_profit=s.value.benefit}).catch(a=>{m.isActive=!1,console.log(a)})};E(k);const V=i(!1);i(!1);const U=i(!0),A=i(!1),x=i(!1),N=i(!1);i(0);const $=()=>{},j=a=>{var o=parseFloat(a.weight)*(parseFloat(s.value.raw_material_price)/1e3),t=o>0?o+5+1:0;a.benefit=parseFloat(a.product_price)-t,a.total_profit=parseFloat(a.benefit)*parseFloat(a.quantity),O()},q=()=>{for(let t=0;t<u.value.length;t++){var a=parseFloat(u.value[t].weight)*(parseFloat(s.value.raw_material_price)/1e3),o=a>0?a+5+1:0;u.value[t].benefit=parseFloat(u.value[t].product_price)-o,u.value[t].total_profit=parseFloat(u.value[t].benefit)*parseFloat(u.value[t].quantity)}O()},O=()=>{h.value=0,s.value.total_amount=0;for(let a=0;a<u.value.length;a++)h.value+=parseFloat(u.value[a].total_profit),s.value.total_amount+=parseFloat(u.value[a].total_amount);s.value.total_profit=parseFloat(h.value).toFixed(2)},D=()=>{m.value.isActive=!0,F.updateProfit(u.value,s.value,Number(g.params.id)).then(a=>{m.value.isActive=!1,C(a.data.message),L.push("/apps/pos/benefit/list")}).catch(a=>{m.value.isActive=!1,console.log(a)})},G=()=>{m.value.isActive=!0,F.refreshData(Number(g.params.id)).then(a=>{console.log(a),m.value.isActive=!1,k(),C(a.data.message)}).catch(a=>{m.value.isActive=!1,console.log(a)})};return(a,o)=>(_(),y(T,null,{default:l(()=>[e(Z,{"model-value":r(m).isActive,class:"align-center justify-center"},{default:l(()=>[e(Y,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),e(n,{cols:"12",md:"12"},{default:l(()=>[e(R,null,{default:l(()=>[e(B,{class:"d-flex flex-wrap justify-space-between flex-column"},{default:l(()=>[e(ee,{ref:"refForm",onSubmit:o[6]||(o[6]=z(()=>{},["prevent"]))},{default:l(()=>[e(T,null,{default:l(()=>[e(n,{cols:"6",md:"3",class:"mb-5 text-center"},{default:l(()=>[e(v,{title:"Raw material price per KG ",class:"mb-5"}),e(p,{modelValue:r(s).raw_material_price,"onUpdate:modelValue":[o[0]||(o[0]=t=>r(s).raw_material_price=t),o[1]||(o[1]=t=>q())],type:"number",label:"RM price KG",placeholder:"price of the raw material per KG"},null,8,["modelValue"])]),_:1}),e(n,{cols:"6",md:"3",class:"mb-5 text-center"},{default:l(()=>[e(v,{title:"Raw material price per KG ",class:"mb-5"}),e(p,{modelValue:r(s).total_amount,"onUpdate:modelValue":o[2]||(o[2]=t=>r(s).total_amount=t),type:"number",readonly:"",label:"TOTAL AMOUNT",placeholder:"TOTAL AMOUNT"},null,8,["modelValue"])]),_:1}),e(n,{cols:"6",md:"3",class:"mb-5 text-center"},{default:l(()=>[e(v,{title:"Raw material price per KG ",class:"mb-5"}),e(p,{modelValue:r(s).total_profit,"onUpdate:modelValue":o[3]||(o[3]=t=>r(s).total_profit=t),type:"number",readonly:"",label:"TOTAL PROFIT",placeholder:"TOTAL PROFIT"},null,8,["modelValue"])]),_:1}),e(n,{cols:"4",md:"1",class:"mt-7"},{default:l(()=>[e(b,{onClick:o[4]||(o[4]=t=>D())},{default:l(()=>[f(" Submit ")]),_:1})]),_:1}),e(n,{cols:"4",md:"1",class:"mt-7"},{default:l(()=>[e(b,{color:"success",onClick:o[5]||(o[5]=t=>G())},{default:l(()=>[f(" Refresh ")]),_:1})]),_:1})]),_:1}),(_(!0),Q(J,null,H(r(u),t=>(_(),y(T,null,{default:l(()=>[e(n,{cols:"12",md:"2"},{default:l(()=>[e(p,{modelValue:t.product.name,"onUpdate:modelValue":d=>t.product.name=d,label:"Name of the product",placeholder:"Name of the product",readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(n,{cols:"12",md:"2"},{default:l(()=>[e(p,{type:"number",modelValue:t.product_price,"onUpdate:modelValue":[d=>t.product_price=d,d=>j(t)],label:"Product's Price",placeholder:"price of the product"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(n,{cols:"12",md:"2"},{default:l(()=>[e(p,{type:"number",modelValue:t.benefit,"onUpdate:modelValue":d=>t.benefit=d,label:"Product's Benefit",placeholder:"Benefit of the product",readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(n,{cols:"12",md:"2"},{default:l(()=>[e(p,{type:"number",modelValue:t.quantity,"onUpdate:modelValue":d=>t.quantity=d,label:"Product's Quantity",placeholder:"quantity of the product this month",readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(n,{cols:"12",md:"2"},{default:l(()=>[e(p,{type:"number",modelValue:t.total_amount,"onUpdate:modelValue":d=>t.total_amount=d,label:"Product's total amount",placeholder:"total amount of the product",readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(n,{cols:"12",md:"2"},{default:l(()=>[e(p,{type:"number",modelValue:t.total_profit,"onUpdate:modelValue":d=>t.total_profit=d,label:"Product's total profit",placeholder:"total profit of the product",readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),256))]),_:1},512)]),_:1})]),_:1})]),_:1}),e(n,{cols:"12",md:"3"},{default:l(()=>[e(R,{class:"mb-8"},{default:l(()=>[e(B,null,{default:l(()=>[e(b,{block:"","prepend-icon":"tabler-send",class:"mb-2",onClick:o[7]||(o[7]=t=>V.value=!0)},{default:l(()=>[f(" Send Invoice ")]),_:1}),r(N)?(_(),y(b,{key:0,block:"",color:"secondary",variant:"tonal",class:"mb-2",to:{name:"apps-POS-sale-preview-id",params:{id:r(M)}}},{default:l(()=>[f(" Preview ")]),_:1},8,["to"])):S("",!0),r(N)?S("",!0):(_(),y(b,{key:1,loading:r(m).isActive,disabled:r(m).isActive,block:"",color:"success",class:"mb-2",onClick:$},{default:l(()=>[f(" Save ")]),_:1},8,["loading","disabled"]))]),_:1})]),_:1}),te,c("div",le,[e(v,{for:"payment-terms"},{default:l(()=>[f(" Payment Terms ")]),_:1}),c("div",null,[e(P,{id:"payment-terms",modelValue:r(U),"onUpdate:modelValue":o[8]||(o[8]=t=>w(U)?U.value=t:null)},null,8,["modelValue"])])]),c("div",ae,[e(v,{for:"client-notes"},{default:l(()=>[f(" Client Notes ")]),_:1}),c("div",null,[e(P,{id:"client-notes",modelValue:r(A),"onUpdate:modelValue":o[9]||(o[9]=t=>w(A)?A.value=t:null)},null,8,["modelValue"])])]),c("div",oe,[e(v,{for:"payment-stub"},{default:l(()=>[f(" Payment Stub ")]),_:1}),c("div",null,[e(P,{id:"payment-stub",modelValue:r(x),"onUpdate:modelValue":o[10]||(o[10]=t=>w(x)?x.value=t:null)},null,8,["modelValue"])])])]),_:1}),e(X,{isDrawerOpen:r(V),"onUpdate:isDrawerOpen":o[11]||(o[11]=t=>w(V)?V.value=t:null)},null,8,["isDrawerOpen"])]),_:1}))}};export{je as default};
