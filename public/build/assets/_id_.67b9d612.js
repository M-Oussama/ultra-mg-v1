import{k as u,Z as ne,r as se,o as x,b as T,w as t,m as s,p as e,C as O,q as o,P as de,D as y,be as re,E as D,ay as ie,bd as ue,$ as Y,A as ye,c as Z,F as we,a as xe,x as P,y as H,H as he,I as Ae}from"./main.9c276e41.js";import{_ as Ce}from"./DialogCloseBtn.b8cef423.js";import{s as L,e as I}from"./errorsMiddleware.942e9f7c.js";import{u as W}from"./useAttendanceStore.0d112550.js";import{_ as Ee}from"./AppDateTimePicker.277ea473.js";import{r as ce}from"./validators.330a354f.js";import{V as G}from"./VSpacer.a1b0320f.js";import{V as w,a as te}from"./VBtn.de352617.js";import{V as M,c as $}from"./VCard.3f1d48fd.js";import{V as me}from"./VForm.22db48f6.js";import{V as J,a as b}from"./VRow.ab48f544.js";import{V as z}from"./VInput.c0135511.js";import{V as q}from"./VTextField.b54119c9.js";import{V as pe}from"./VNavigationDrawer.3c48f61b.js";import{V as ae}from"./VFileInput.f8fd3ccf.js";import{a as Ue}from"./VOverlay.709d86a8.js";import{V as Q}from"./VDivider.200576a4.js";import{V as Se}from"./VSelect.fbd31a8c.js";import{V as ke}from"./VTable.72855350.js";import{V as Oe}from"./VMenu.01446e9e.js";import{V as Ne,b as le,a as oe}from"./VList.f1cd7c4f.js";import{V as Te}from"./VPagination.1832536f.js";import{V as Re}from"./VDialog.b3cf742c.js";import"./VField.a0a43eac.js";import"./index.9c468de8.js";import"./position.7cebd068.js";import"./router.2ab2db3e.js";import"./easing.36b781ab.js";import"./index.b522f886.js";import"./VAvatar.ef177926.js";import"./VImg.8b481f0f.js";import"./forwardRefs.c003b6b8.js";/* empty css                   */import"./VCounter.cba43794.js";import"./ssrBoot.251a6a1b.js";import"./VChip.72dc38cb.js";import"./lazy.e4f3cd8c.js";import"./dialog-transition.976b28f7.js";import"./VCheckboxBtn.a3ebd463.js";import"./VSelectionControl.b82159d5.js";import"./scopeId.0cdd2f0e.js";const Fe={class:"d-flex align-center pa-6 pb-1"},Pe=s("h6",{class:"text-h6"}," Update End Date ",-1),$e={__name:"EditEmployeeAttendanceDrawer",props:{isDrawerOpen:{type:null,required:!0},loading:{type:null,required:!0},employee:{type:Object,required:!0},disableEndDate:{type:Boolean,required:!0},disableStartDate:{type:Boolean,required:!0}},setup(R){const r=R,S=W(),m=u({start_date:"",end_date:"",real_start_date:"",real_end_date:"",position:""});ne(r.isDrawerOpen,()=>{r.isDrawerOpen.open&&(console.log(r.employee),m.value.id=r.employee.id||"",m.value.start_date=r.employee.start_date||"",m.value.end_date=r.employee.end_date||"",m.value.real_start_date=r.employee.real_start_date||"",m.value.real_end_date=r.employee.real_end_date||"",m.value.position=r.employee.position||"")});const a=u(!1),h=u();u(),u({id:-1});const A=()=>{r.isDrawerOpen.open=!1,ie(()=>{var c,f;(c=h.value)==null||c.reset(),(f=h.value)==null||f.resetValidation()})},C=()=>{r.loading.isActive=!0,console.log(r.loading),S.updateEndDate(m.value.end_date,m.value.start_date,m.value.id,m.value.position).then(c=>{r.isDrawerOpen.open=!1,r.loading.isActive=!1,r.employee.end_date=c.data.endDate,L(c.data.msg)}).catch(c=>{r.loading.isActive=!1,I("Error Occured",c.response.data.message)})},E=c=>{r.isDrawerOpen.value.open=c};return(c,f)=>{const k=Ee,g=se("VueDatePicker");return x(),T(pe,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":r.isDrawerOpen.open,"onUpdate:modelValue":E},{default:t(()=>[s("div",Fe,[Pe,e(G),e(w,{variant:"tonal",color:"default",icon:"",size:"32",class:"rounded",onClick:A},{default:t(()=>[e(O,{size:"18",icon:"tabler-x"})]),_:1})]),e(o(de),{options:{wheelPropagation:!1}},{default:t(()=>[e(M,{flat:""},{default:t(()=>[e($,null,{default:t(()=>[e(me,{ref_key:"refForm",ref:h,modelValue:o(a),"onUpdate:modelValue":f[5]||(f[5]=v=>y(a)?a.value=v:null),onSubmit:re(C,["prevent"])},{default:t(()=>[e(J,null,{default:t(()=>[e(b,{cols:"12"},{default:t(()=>[e(k,{modelValue:o(m).start_date,"onUpdate:modelValue":f[0]||(f[0]=v=>o(m).start_date=v),label:"Start Date",disabled:R.disableStartDate},null,8,["modelValue","disabled"])]),_:1}),e(b,{cols:"12"},{default:t(()=>[e(k,{modelValue:o(m).end_date,"onUpdate:modelValue":f[1]||(f[1]=v=>o(m).end_date=v),label:"End Date",config:{minDate:`

                  ${o(m).start_date}`},disabled:R.disableEndDate},null,8,["modelValue","config","disabled"])]),_:1}),e(b,{cols:"12"},{default:t(()=>[e(z,null,{default:t(()=>[D(" REAL START DATE ")]),_:1}),e(g,{modelValue:o(m).real_start_date,"onUpdate:modelValue":[f[2]||(f[2]=v=>o(m).real_start_date=v),c.onStartDateChanged],"auto-apply":"",format:c.format},null,8,["modelValue","format","onUpdate:modelValue"])]),_:1}),e(b,{cols:"12"},{default:t(()=>[e(z,null,{default:t(()=>[D(" REAL END DATE ")]),_:1}),e(g,{modelValue:o(m).real_end_date,"onUpdate:modelValue":f[3]||(f[3]=v=>o(m).real_end_date=v),"auto-apply":"",format:c.format,"min-date":o(m).end_date_restrict},null,8,["modelValue","format","min-date"])]),_:1}),e(b,{cols:"12"},{default:t(()=>[e(q,{modelValue:o(m).position,"onUpdate:modelValue":f[4]||(f[4]=v=>o(m).position=v),rules:[o(ce)],label:"Position"},null,8,["modelValue","rules"])]),_:1}),e(b,{cols:"12"},{default:t(()=>[e(w,{type:"submit",class:"me-3"},{default:t(()=>[D(" Submit ")]),_:1}),e(w,{type:"reset",variant:"tonal",color:"secondary",onClick:A},{default:t(()=>[D(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};const ze={class:"d-flex align-center pa-6 pb-1"},Be=s("h6",{class:"text-h6"}," Add New Record ",-1),Ie={__name:"AddEmployeeAttendanceDrawer",props:{isDrawerOpen:{type:null,required:!0},loading:{type:null,required:!0},employees:{type:Object,required:!0}},setup(R){const r=R,S=W(),m=ue(),a=u({start_date:new Date().getFullYear()+"-"+(new Date().getMonth()+1)+"-"+new Date().getDate(),end_date:"",end_date_restrict:new Date().getFullYear()+"-"+(new Date().getMonth()+1)+"-"+(new Date().getDate()+1),position:"",real_start_date:"",real_end_date:"",national_card:"",birth_certificate:""}),h=u(!1),A=u();u(),u({id:-1});const C=()=>{r.isDrawerOpen.open=!1,ie(()=>{var p,d;(p=A.value)==null||p.reset(),(d=A.value)==null||d.resetValidation()})},E=()=>{if(a.value.birth_certificate[0]===void 0&&a.value.national_card[0]===void 0&&c(null,null),a.value.birth_certificate[0]!==void 0&&a.value.national_card[0]===void 0){var p=new FileReader;p.readAsDataURL(a.value.birth_certificate[0]),p.onload=function(){let i=p.result;c(i,null)},p.onerror=function(i){return""}}if(a.value.national_card[0]!==void 0&&a.value.birth_certificate[0]===void 0){var d=new FileReader;d.readAsDataURL(a.value.national_card[0]),d.onload=function(){let i=d.result;c(null,i)},d.onerror=function(i){return""}}if(a.value.birth_certificate[0]!==void 0&&a.value.national_card[0]!==void 0){console.log("here");var V=new FileReader;V.readAsDataURL(a.value.birth_certificate[0]),V.onload=function(){let i=V.result;if(a.value.national_card[0]!==void 0){var N=new FileReader;N.readAsDataURL(a.value.national_card[0]),N.onload=function(){let U=N.result;c(i,U)}}},V.onerror=function(i){return""}}},c=(p,d)=>{a.value.start_date===""?I("Warning","start date must be selected"):(r.loading.isActive=!0,console.log(r.loading),S.addEmployeeAttendanceRecord(a.value.end_date,a.value.start_date,Number(m.params.id),a.value.position,p,d).then(V=>{r.isDrawerOpen.open=!1,r.loading.isActive=!1,L(V.data.msg)}).catch(V=>{r.loading.isActive=!1,I("Error Occured",V.response.data.message)}))},f=p=>{r.isDrawerOpen.value.open=p};function k(p){return parseInt(p)<10?"0"+p:p}const g=p=>{const d=p.getDate(),V=p.getMonth()+1;return`${p.getFullYear()}-${k(V)}-${k(d)}`},v=()=>{(a.value.start_date===""||a.value.start_date>=a.value.end_date&&a.value.end_date!=="")&&(a.value.end_date=""),a.value.end_date_restrict=new Date(new Date(a.value.start_date).getTime()+24*60*60*2e3).toISOString().split("T")[0]};return(p,d)=>{const V=se("VueDatePicker");return x(),T(pe,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":r.isDrawerOpen.open,"onUpdate:modelValue":f},{default:t(()=>[s("div",ze,[Be,e(G),e(w,{variant:"tonal",color:"default",icon:"",size:"32",class:"rounded",onClick:C},{default:t(()=>[e(O,{size:"18",icon:"tabler-x"})]),_:1})]),e(o(de),{options:{wheelPropagation:!1}},{default:t(()=>[e(M,{flat:""},{default:t(()=>[e($,null,{default:t(()=>[e(me,{ref_key:"refForm",ref:A,modelValue:o(h),"onUpdate:modelValue":d[7]||(d[7]=i=>y(h)?h.value=i:null),onSubmit:re(E,["prevent"])},{default:t(()=>[e(J,null,{default:t(()=>[e(b,{cols:"12"},{default:t(()=>[e(z,null,{default:t(()=>[D(" CNAS START DATE ")]),_:1}),e(V,{modelValue:o(a).start_date,"onUpdate:modelValue":[d[0]||(d[0]=i=>o(a).start_date=i),v],"auto-apply":"",format:g},null,8,["modelValue"])]),_:1}),e(b,{cols:"12"},{default:t(()=>[e(z,null,{default:t(()=>[D(" CNAS END DATE ")]),_:1}),e(V,{modelValue:o(a).end_date,"onUpdate:modelValue":d[1]||(d[1]=i=>o(a).end_date=i),"auto-apply":"",format:g,"min-date":o(a).end_date_restrict},null,8,["modelValue","min-date"])]),_:1}),e(b,{cols:"12"},{default:t(()=>[e(z,null,{default:t(()=>[D(" REAL START DATE ")]),_:1}),e(V,{modelValue:o(a).real_start_date,"onUpdate:modelValue":[d[2]||(d[2]=i=>o(a).real_start_date=i),v],"auto-apply":"",format:g},null,8,["modelValue"])]),_:1}),e(b,{cols:"12"},{default:t(()=>[e(z,null,{default:t(()=>[D(" REAL END DATE ")]),_:1}),e(V,{modelValue:o(a).real_end_date,"onUpdate:modelValue":d[3]||(d[3]=i=>o(a).real_end_date=i),"auto-apply":"",format:g,"min-date":o(a).end_date_restrict},null,8,["modelValue","min-date"])]),_:1}),e(b,{cols:"12"},{default:t(()=>[e(q,{modelValue:o(a).position,"onUpdate:modelValue":d[4]||(d[4]=i=>o(a).position=i),rules:[o(ce)],label:"Position"},null,8,["modelValue","rules"])]),_:1}),e(b,{cols:"12"},{default:t(()=>[e(ae,{modelValue:o(a).national_card,"onUpdate:modelValue":d[5]||(d[5]=i=>o(a).national_card=i),label:"National Card",variant:"filled"},null,8,["modelValue"])]),_:1}),e(b,{cols:"12"},{default:t(()=>[e(ae,{modelValue:o(a).birth_certificate,"onUpdate:modelValue":d[6]||(d[6]=i=>o(a).birth_certificate=i),label:"Birth Certificate",variant:"filled"},null,8,["modelValue"])]),_:1}),e(b,{cols:"12"},{default:t(()=>[e(w,{type:"submit",class:"me-3"},{default:t(()=>[D(" Submit ")]),_:1}),e(w,{type:"reset",variant:"tonal",color:"secondary",onClick:C},{default:t(()=>[D(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};const Le={class:"me-3",style:{width:"80px"}},Me={style:{width:"12rem"}},qe={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},je={style:{width:"9rem"}},Ye=s("thead",null,[s("tr",null,[s("th",{scope:"col"}," ID "),s("th",{scope:"col"}," Start Date "),s("th",{scope:"col"}," End Date "),s("th",{scope:"col"}," Period "),s("th",{scope:"col"}," Position "),s("th",{scope:"col"}," ACTIONS ")])],-1),Ze={class:"d-flex align-center"},He={class:"d-flex flex-column"},Qe={class:"text-base"},We={class:"d-flex align-center"},Ge={class:"d-flex flex-column"},Je={class:"text-base"},Ke={class:"d-flex align-center"},Xe={class:"d-flex flex-column"},et={class:"text-base"},tt={class:"d-flex align-center"},at={class:"d-flex flex-column"},lt={class:"text-base"},ot={class:"text-center",style:{width:"5rem"}},nt=s("tr",null,[s("td",{colspan:"7",class:"text-center"}," No data available ")],-1),st=[nt],dt={class:"text-sm text-disabled"},Wt={__name:"[id]",setup(R){const r=W(),S=u(""),m=u(!1),a=u({isActive:!0}),h=ue(),A=u(!0);u();const C=u("mahgounoussama23@gmail.com");u(),u();const E=u(10),c=u(1),f=u(1),k=u(0);let g=u([]),v=u({open:!1}),p=u({open:!1}),d=u({open:!1}),V=u(!1),i=u(!0);const N=()=>{a.value.isActive=!0,r.fetchEmployeesByAttendance(Number(h.params.id)).then(_=>{g.value=_.data.employees.data,f.value=_.data.totalPage,k.value=_.data.totalEmployees,m.value=!1,a.value.isActive=!1,console.log(_)}).catch(_=>{console.error(_),a.value.isActive=!1})};Y(N),Y(()=>{c.value>f.value&&(c.value=f.value)}),ne(S,()=>{N()}),u(!1);let U=u(null);Y(()=>{c.value>f.value&&(c.value=f.value)});const fe=ye(()=>{const _=g.value.length?(c.value-1)*E.value+1:0,n=g.value.length+(c.value-1)*E.value;return`Showing ${_} to ${n} of ${k.value} entries`}),_e=_=>{U.value=_,v.value.open=!0},ve=_=>{U.value=_,p.value.open=!0},Ve=()=>{d.value.open=!0},ge=()=>{a.value.isActive=!0,p.value.open=!1,r.deleteCareer(U.value.id).then(_=>{a.value.isActive=!1,L(_.data.message),N()}).catch(_=>{I(_.data.message),a.value.isActive=!1})},K=()=>{p.value.open=!1},De=_=>{let n=new Date(_.end_date);_.end_date||(n=new Date);const j=n-new Date(_.start_date),l=Math.floor(j/(1e3*60*60*24)),B=Math.floor(l/365),X=Math.floor(l%365/30),ee=l%30;let F="";return B>0&&(F+=("0"+B).slice(-2)+" years, "),X>0&&(F+=("0"+X).slice(-2)+" months, "),ee>0&&(F+=("0"+ee).slice(-2)+" days"),F=F.replace(/,\s*$/,""),F},be=_=>{console.log(_),a.value.isActive=!0,r.generateEmail(_.id,C.value).then(n=>{a.value.isActive=!1,L(n.data.message)}).catch(n=>{I(n.data.message),a.value.isActive=!1})};return(_,n)=>{const j=Ce;return x(),Z("section",null,[e(J,null,{default:t(()=>[e(Ue,{"model-value":o(a).isActive,class:"align-center justify-center"},{default:t(()=>[e(te,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),e(b,{cols:"12"},{default:t(()=>[e(M,{title:"Employees"},{default:t(()=>[e(Q),e($,{class:"d-flex flex-wrap py-4 gap-4"},{default:t(()=>[s("div",Le,[e(Se,{modelValue:o(E),"onUpdate:modelValue":n[0]||(n[0]=l=>y(E)?E.value=l:null),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"])]),s("div",Me,[e(q,{onInput:n[1]||(n[1]=l=>A.value=!0),ref:"searchField",modelValue:o(C),"onUpdate:modelValue":n[2]||(n[2]=l=>y(C)?C.value=l:null),placeholder:"Email",density:"compact"},null,8,["modelValue"])]),e(G),s("div",qe,[s("div",je,[o(m)?(x(),T(te,{key:0,indeterminate:"",color:"primary"})):(x(),T(q,{key:1,onInput:n[3]||(n[3]=l=>A.value=!0),ref:"searchField",modelValue:o(S),"onUpdate:modelValue":n[4]||(n[4]=l=>y(S)?S.value=l:null),placeholder:"Search",density:"compact"},null,8,["modelValue"]))]),e(w,{variant:"tonal",color:"secondary","prepend-icon":"tabler-screen-share"},{default:t(()=>[D(" Export ")]),_:1}),e(w,{color:"primary","prepend-icon":"tabler-plus",onClick:n[5]||(n[5]=l=>Ve())},{default:t(()=>[D(" New Record ")]),_:1})])]),_:1}),e(Q),e(ke,{class:"text-no-wrap"},{default:t(()=>[Ye,s("tbody",null,[(x(!0),Z(we,null,xe(o(g),l=>(x(),Z("tr",{key:l.id,style:{height:"3.75rem"}},[s("td",null,P(l.id),1),s("td",null,[s("div",Ze,[s("div",He,[s("h6",Qe,P(l.start_date),1)])])]),s("td",null,[s("div",We,[s("div",Ge,[s("h6",Je,P(l.end_date),1)])])]),s("td",null,[s("div",Ke,[s("div",Xe,[s("h6",et,P(De(l)),1)])])]),s("td",null,[s("div",tt,[s("div",at,[s("h6",lt,P(l.position),1)])])]),s("td",ot,[l.last?(x(),T(w,{key:0,icon:"",size:"x-small",color:"default",variant:"text",onClick:B=>_e(l)},{default:t(()=>[e(O,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"])):H("",!0),e(w,{icon:"",size:"x-small",color:"default",variant:"text"},{default:t(()=>[e(O,{size:"22",icon:"tabler-trash",onClick:B=>ve(l)},null,8,["onClick"])]),_:2},1024),e(w,{icon:"",size:"x-small",color:"default",variant:"text"},{default:t(()=>[e(O,{size:"22",icon:"tabler-send",onClick:B=>be(l)},null,8,["onClick"])]),_:2},1024),e(w,{icon:"",variant:"text",color:"default",size:"x-small"},{default:t(()=>[e(O,{size:22,icon:"tabler-dots-vertical"}),e(Oe,{activator:"parent"},{default:t(()=>[e(Ne,{density:"compact"},{default:t(()=>[l.BC?(x(),T(oe,{key:0,value:"BC",href:l.BC},{prepend:t(()=>[e(O,{size:"22",class:"me-3",icon:"tabler-download"})]),default:t(()=>[e(le,null,{default:t(()=>[D("Birth Certificate")]),_:1})]),_:2},1032,["href"])):H("",!0),l.NC?(x(),T(oe,{key:1,value:"NC",href:l.NC},{prepend:t(()=>[e(O,{size:"22",class:"me-3",icon:"tabler-download"})]),default:t(()=>[e(le,null,{default:t(()=>[D("National Card")]),_:1})]),_:2},1032,["href"])):H("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]))),128))]),he(s("tfoot",null,st,512),[[Ae,!o(g).length]])]),_:1}),e(Q),e($,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3 px-5"},{default:t(()=>[s("span",dt,P(o(fe)),1),e(Te,{modelValue:o(c),"onUpdate:modelValue":n[6]||(n[6]=l=>y(c)?c.value=l:null),size:"small","total-visible":5,length:o(f)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1}),e($e,{isDrawerOpen:o(v),"onUpdate:isDrawerOpen":n[7]||(n[7]=l=>y(v)?v.value=l:v=l),employee:o(U),"onUpdate:employee":n[8]||(n[8]=l=>y(U)?U.value=l:U=l),"disable-end-date":o(V),"onUpdate:disable-end-date":n[9]||(n[9]=l=>y(V)?V.value=l:V=l),loading:o(a),"onUpdate:loading":n[10]||(n[10]=l=>y(a)?a.value=l:null),"disable-start-date":o(i),"onUpdate:disable-start-date":n[11]||(n[11]=l=>y(i)?i.value=l:i=l)},null,8,["isDrawerOpen","employee","disable-end-date","loading","disable-start-date"]),e(Ie,{isDrawerOpen:o(d),"onUpdate:isDrawerOpen":n[12]||(n[12]=l=>y(d)?d.value=l:d=l),employees:o(g),"onUpdate:employees":n[13]||(n[13]=l=>y(g)?g.value=l:g=l),loading:o(a),"onUpdate:loading":n[14]||(n[14]=l=>y(a)?a.value=l:null)},null,8,["isDrawerOpen","employees","loading"]),e(Re,{modelValue:o(p).open,"onUpdate:modelValue":n[17]||(n[17]=l=>o(p).open=l),persistent:"",class:"v-dialog-sm"},{default:t(()=>[e(j,{onClick:n[15]||(n[15]=l=>K())}),e(M,{title:"Confirmation"},{default:t(()=>[e($,null,{default:t(()=>[D(" Are you sure you want to delete this record ? ")]),_:1}),e($,{class:"d-flex justify-end gap-3 flex-wrap"},{default:t(()=>[e(w,{color:"secondary",variant:"tonal",onClick:n[16]||(n[16]=l=>K())},{default:t(()=>[D(" Disagree ")]),_:1}),e(w,{onClick:ge},{default:t(()=>[D(" Agree ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{Wt as default};
