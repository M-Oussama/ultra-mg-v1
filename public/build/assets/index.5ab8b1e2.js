import{k as n,Z as oe,o as r,b as c,w as l,p as t,E as x,$ as F,A as se,r as ie,q as o,m as a,D as f,y as b,C as v,c as I,a as ne,x as u,O as re,F as ce,H as de,I as ue,bf as Y}from"./main.c6a9724c.js";import{_ as me}from"./AppDateTimePicker.effadfa0.js";import{a as pe}from"./formatters.4acf44a4.js";import{u as fe}from"./useSaleStore.2fbe7104.js";import{_ as ve}from"./InvoiceAddPaymentDrawer.46ba8729.js";import{_ as _e}from"./DialogCloseBtn.19a72d91.js";import{V as G,c as B}from"./VCard.f64c0a01.js";import{V as D,a as Ve}from"./VBtn.e7c07512.js";import{V as ge}from"./VDialog.6f70ea41.js";import{P as m}from"./permissions.bafe5f34.js";import{a as he}from"./VOverlay.01171e20.js";import{V as Z}from"./VSelect.f71ec185.js";import{V as be}from"./VAutocomplete.02abd51f.js";import{V as H}from"./VDivider.8e59889f.js";import{V as xe}from"./VTable.ee980c27.js";import{V as Se}from"./VTooltip.9d0940eb.js";import{V as Q}from"./VAvatar.6f1bab4f.js";import{V as De}from"./VImg.ed211343.js";import{V as ye}from"./VMenu.b523d10a.js";import{V as ke,a as R,b as J}from"./VList.d03d65eb.js";import{V as Ce}from"./VSpacer.e083bbdb.js";import{V as we}from"./VPagination.b3436b20.js";import{a as Ae,V as Pe}from"./VRow.ecaee667.js";import"./VField.d7dc540f.js";import"./index.cb3fbeaa.js";import"./VInput.ab935992.js";import"./router.8721ce32.js";import"./position.262cc80a.js";import"./easing.36b781ab.js";import"./index.b522f886.js";import"./errorsMiddleware.a5bff1e6.js";import"./successMiddleware.c29016f5.js";import"./VForm.821cf149.js";import"./forwardRefs.c003b6b8.js";import"./VTextField.0d61a0d0.js";/* empty css                   */import"./VCounter.92e789e6.js";import"./VTextarea.ae10c2b5.js";import"./VNavigationDrawer.ef81bf50.js";import"./ssrBoot.6ecdcdd2.js";import"./scopeId.b6fae753.js";import"./dialog-transition.29115eac.js";import"./lazy.55ef32ef.js";import"./VCheckboxBtn.a2176904.js";import"./VSelectionControl.3b08e1e2.js";import"./VChip.7e863aa4.js";import"./filter.db9c5770.js";const Ee={__name:"ConfirmationDialog",props:{isDialogVisible:{type:Boolean,required:!0},sale:{type:Object,required:!0}},emits:["update:isDrawerOpen","saleData"],setup(M,{emit:_}){const y=M,k=n(),V=()=>{_("update:isDialogVisible",!1)};oe(()=>y.sale,g=>{g&&(k.value=g.id||0)});const d=()=>{_("saleData",{id:y.sale.id}),_("update:isDialogVisible",!1)};return(g,p)=>{const h=_e;return r(),c(ge,{modelValue:y.isDialogVisible,"onUpdate:modelValue":p[2]||(p[2]=C=>y.isDialogVisible=C),persistent:"",class:"v-dialog-sm"},{default:l(()=>[t(h,{onClick:p[0]||(p[0]=C=>V())}),t(G,{title:"Confirmation"},{default:l(()=>[t(B,null,{default:l(()=>[x(" Are you sure you want to delete this record ? ")]),_:1}),t(B,{class:"d-flex justify-end gap-3 flex-wrap"},{default:l(()=>[t(D,{color:"secondary",variant:"tonal",onClick:p[1]||(p[1]=C=>_("update:isDialogVisible",!1))},{default:l(()=>[x(" Disagree ")]),_:1}),t(D,{onClick:d},{default:l(()=>[x(" Agree ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};const Te={class:"d-flex align-center",style:{width:"135px"}},Ie=a("span",{class:"text-no-wrap me-3"},"Show:",-1),Le={class:"d-flex align-center",style:{width:"30%"}},$e={class:"d-flex align-center flex-wrap gap-4"},ze={class:"invoice-list-filter"},Oe={class:"invoice-list-filter"},Ue={class:"invoice-list-filter"},Be={class:"me-3"},Ne={class:"text-uppercase"},Re=a("th",{scope:"col"}," #ID ",-1),Je={scope:"col",class:"text-center"},Me=a("th",{scope:"col"}," CLIENT ",-1),je=a("th",{scope:"col",class:"text-center"}," TOTAL ",-1),qe=a("th",{scope:"col"}," Issued Date ",-1),Fe=a("th",{scope:"col"}," Driver ",-1),Ye=a("th",{scope:"col"}," Picked ",-1),Ze=a("th",{scope:"col"}," Picked up ",-1),He=a("th",{scope:"col"}," ACTIONS ",-1),Qe={class:"text-center"},Ge={class:"mb-0"},Ke={class:"mb-0"},We={class:"d-flex align-center"},Xe={key:1},et={class:"d-flex flex-column"},tt={class:"text-base font-weight-medium mb-0"},at={class:"text-disabled text-sm"},lt={class:"text-center"},ot={key:0,class:"badge badge-success"},st={key:1,class:"badge badge-danger"},it={class:"switch"},nt=["checked","onChange"],rt=a("span",{class:"slider round"},null,-1),ct={style:{width:"8rem"}},dt=a("tr",null,[a("td",{colspan:"8",class:"text-center text-body-1"}," No data available ")],-1),ut=[dt],mt={class:"text-sm text-disabled"},pt={__name:"index",setup(M){const _=fe(),y=n(""),k=n(),V=n(10),d=n(1),g=n(1),p=n(0),h=n([]),C=n([]),L=n(""),j=n([]),$=n(""),z=n(""),A=n(!1),P=n(!1);let w=n();const K=n([{id:1,name:"Paid"},{id:2,name:"Not Paid"}]),O=()=>{_.fetchSales({searchValue:y.value,status:k.value,perPage:V.value,currentPage:d.value,client_id:L.value,from:$.value,to:z.value}).then(i=>{S.value.isActive=!1,h.value=i.data.sales,C.value=i.data.clients,g.value=i.data.totalPage,p.value=i.data.totalSales}).catch(i=>{S.value.isActive=!1,console.log(i)})};F(()=>{O()}),F(()=>{d.value>g.value&&(d.value=g.value)});const W=se(()=>{const i=h.value.length?(d.value-1)*V.value+1:0,s=h.value.length+(d.value-1)*V.value;return`Showing ${i} to ${s} of ${p.value} entries`}),N=i=>i.balance>0?i.balance==i.total_amount?{variant:"error",icon:"tabler-x"}:{variant:"info",icon:"tabler-circle-half-2"}:i.balance<0?{variant:"warning",icon:"tabler-alert-circle"}:i.balance==0?{variant:"success",icon:"tabler-circle-check"}:{variant:"error",icon:"tabler-chart-pie"},q=n(),X=i=>{A.value=!0,q.value=i},S=n({isActive:!0}),ee=i=>{P.value=!0,w=i,console.log(w)},te=i=>{_.deleteSale(i).then(s=>{O()}).catch(s=>{console.log(s)})},U=()=>{S.value.isActive=!0,O()},ae=i=>{const s=event.target.checked;i.picked_up=s,S.value.isActive=!0,_.updatePickup(i,s).then(E=>{O()}).catch(E=>{S.value.isActive=!1,console.log(E)})};return(i,s)=>{const E=me,le=ie("RouterLink");return r(),c(Pe,null,{default:l(()=>[t(he,{"model-value":o(S).isActive,class:"align-center justify-center"},{default:l(()=>[t(Ve,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),t(Ae,null,{default:l(()=>[o(h)?(r(),c(G,{key:0,id:"invoice-list"},{default:l(()=>[t(B,{class:"d-flex align-center flex-wrap gap-4"},{default:l(()=>[a("div",Te,[Ie,t(Z,{modelValue:o(V),"onUpdate:modelValue":s[0]||(s[0]=e=>f(V)?V.value=e:null),density:"compact",items:[10,20,30,50,100,500,1e3,5e3]},null,8,["modelValue"])]),a("div",Le,[t(be,{clearable:"",modelValue:o(L),"onUpdate:modelValue":[s[1]||(s[1]=e=>f(L)?L.value=e:null),U],items:o(C),"item-value":"id","item-title":"name",label:"Client",placeholder:"Client"},null,8,["modelValue","items"])]),a("div",$e,[a("div",ze,[t(E,{modelValue:o($),"onUpdate:modelValue":[s[2]||(s[2]=e=>f($)?$.value=e:null),U],label:"From Date"},null,8,["modelValue"])]),a("div",Oe,[t(E,{modelValue:o(z),"onUpdate:modelValue":[s[3]||(s[3]=e=>f(z)?z.value=e:null),U],label:"To Date"},null,8,["modelValue"])]),a("div",Ue,[t(Z,{modelValue:o(k),"onUpdate:modelValue":[s[4]||(s[4]=e=>f(k)?k.value=e:null),U],label:"Select Status",clearable:"","item-value":"id","item-title":"name","clear-icon":"tabler-x","single-line":"",items:o(K)},null,8,["modelValue","items"])]),a("div",Be,[i.$can(o(m).SALE.ADD,o(m).SALE.SUBJECT)?(r(),c(D,{key:0,"prepend-icon":"tabler-plus",to:{name:"apps-POS-sale-add"}},{default:l(()=>[x(" Create ")]),_:1})):b("",!0)])])]),_:1}),t(H),t(xe,{class:"text-no-wrap invoice-list-table"},{default:l(()=>[a("thead",Ne,[a("tr",null,[Re,a("th",Je,[t(v,{icon:"tabler-trending-up"})]),Me,je,qe,Fe,Ye,Ze,He])]),a("tbody",null,[(r(!0),I(ce,null,ne(o(h),e=>(r(),I("tr",{key:e.id,style:{height:"3.75rem"}},[a("td",null,[t(le,{to:{name:"apps-POS-sale-preview-id",params:{id:e.id}}},{default:l(()=>[x(" #"+u(e.id),1)]),_:2},1032,["to"])]),a("td",Qe,[t(Se,null,{activator:l(({props:T})=>[t(Q,re({size:30},T,{color:N(e).variant,variant:"tonal"}),{default:l(()=>[t(v,{size:20,icon:N(e).icon},null,8,["icon"])]),_:2},1040,["color"])]),default:l(()=>[a("p",Ge,u(e.invoiceStatus),1),a("p",Ke," Balance: "+u(e.balance),1)]),_:2},1024)]),a("td",null,[a("div",We,[t(Q,{size:"34",color:N(e).variant,variant:"tonal",class:"me-3"},{default:l(()=>[e.avatar?(r(),c(De,{key:0,src:e.avatar},null,8,["src"])):(r(),I("span",Xe,u(o(pe)(e.client.name)),1))]),_:2},1032,["color"]),a("div",et,[a("h6",tt,u(e.client.name),1),a("span",at,u(e.client.email),1)])])]),a("td",lt,u(e.total_amount)+" DZD ",1),a("td",null,u(e.sale_date),1),a("td",null,u(e.driver?e.driver.full_name:""),1),a("td",null,[e.picked_up?(r(),I("span",ot,"YES")):(r(),I("span",st,"NO"))]),a("td",null,[a("label",it,[a("input",{type:"checkbox",checked:!!e.picked_up,onChange:T=>ae(e,T)},null,40,nt),rt])]),a("td",ct,[t(D,{icon:"",variant:"text",color:"default",size:"x-small"},{default:l(()=>[t(v,{icon:"tabler-mail",size:22})]),_:1}),i.$can(o(m).SALE.DELETE,o(m).SALE.SUBJECT)?(r(),c(D,{key:0,icon:"",variant:"text",color:"default",size:"x-small",onClick:T=>ee(e)},{default:l(()=>[t(v,{size:22,icon:"tabler-trash"})]),_:2},1032,["onClick"])):b("",!0),i.$can(o(m).SALE.LIST,o(m).SALE.SUBJECT)?(r(),c(D,{key:1,icon:"",variant:"text",color:"default",size:"x-small",to:{name:"apps-POS-sale-preview-id",params:{id:e.id}}},{default:l(()=>[t(v,{size:22,icon:"tabler-eye"})]),_:2},1032,["to"])):b("",!0),t(D,{icon:"",variant:"text",color:"default",size:"x-small"},{default:l(()=>[t(v,{size:22,icon:"tabler-dots-vertical"}),t(ye,{activator:"parent"},{default:l(()=>[t(ke,null,{default:l(()=>[t(R,{value:"download"},{prepend:l(()=>[t(v,{size:"24",class:"me-3",icon:"tabler-download"})]),default:l(()=>[t(J,null,{default:l(()=>[x("Download")]),_:1})]),_:1}),i.$can(o(m).SALE.EDIT,o(m).SALE.SUBJECT)?(r(),c(R,{key:0,to:{name:"apps-POS-sale-edit-id",params:{id:e.id}}},{prepend:l(()=>[t(v,{size:"24",class:"me-3",icon:"tabler-pencil"})]),default:l(()=>[t(J,null,{default:l(()=>[x("Edit")]),_:1})]),_:2},1032,["to"])):b("",!0),i.$can(o(m).PAYMENT.ADD,o(m).PAYMENT.SUBJECT)?(r(),c(R,{key:1,value:"payment",onClick:T=>X(e)},{prepend:l(()=>[t(v,{size:"24",class:"me-3",icon:"tabler-credit-card"})]),default:l(()=>[t(J,null,{default:l(()=>[x("Payment")]),_:1})]),_:2},1032,["onClick"])):b("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]))),128))]),de(a("tfoot",null,ut,512),[[ue,!o(h).length]])]),_:1}),t(H),t(B,{class:"d-flex align-center flex-wrap gap-4 py-3"},{default:l(()=>[a("span",mt,u(o(W)),1),t(Ce),t(we,{modelValue:o(d),"onUpdate:modelValue":s[5]||(s[5]=e=>f(d)?d.value=e:null),size:"small","total-visible":5,length:o(g),onNext:s[6]||(s[6]=e=>j.value=[]),onPrev:s[7]||(s[7]=e=>j.value=[])},null,8,["modelValue","length"])]),_:1}),o(P)?(r(),c(Ee,{key:0,isDialogVisible:o(P),"onUpdate:isDialogVisible":s[8]||(s[8]=e=>f(P)?P.value=e:null),sale:o(w),"onUpdate:sale":s[9]||(s[9]=e=>f(w)?w.value=e:w=e),onSaleData:te},null,8,["isDialogVisible","sale"])):b("",!0)]),_:1})):b("",!0)]),_:1}),o(A)?(r(),c(ve,{key:0,loading:o(S),data:o(q),isDrawerOpen:o(A),"onUpdate:isDrawerOpen":s[10]||(s[10]=e=>f(A)?A.value=e:null)},null,8,["loading","data","isDrawerOpen"])):b("",!0)]),_:1})}}};typeof Y=="function"&&Y(pt);export{pt as default};
