import{k as s,o as w,b as S,w as a,m as u,p as e,C as N,q as o,P as Z,D as y,be as Q,E as O,Z as I,$ as T,A as ae,c as M,F as oe,a as ne,x as P,H as ie,I as se,y as re}from"./main.3b71879b.js";import{u as z}from"./useSaleStore.b8cf9583.js";import{e as x,s as L}from"./errorsMiddleware.b2e242d4.js";/* empty css                        */import{V as Y}from"./VSpacer.5caba3e1.js";import{V as g,a as R}from"./VBtn.d800b652.js";import{V as F,c as U}from"./VCard.bb3ef269.js";import{V as G}from"./VForm.6348b5cb.js";import{V as K,a as h}from"./VRow.9f658dda.js";import{V as H}from"./VAutocomplete.c03d7df7.js";import{V as J}from"./VNavigationDrawer.063300b1.js";import{_ as de}from"./AppDateTimePicker.44316835.js";import{q as ue}from"./VueSearchSelect.b7c1bfc2.js";import{V as W}from"./VTextField.400a1cda.js";import{V as pe}from"./VTextarea.74bd7095.js";import{_ as me}from"./DialogCloseBtn.702af0ba.js";import{V as fe}from"./VDialog.f0348b72.js";import{a as ce}from"./VOverlay.67ba7c7a.js";import{V as j}from"./VDivider.4e84bd5e.js";import{V as ye}from"./VSelect.3c75d105.js";import{V as ve}from"./VTable.01134d2f.js";import{V as Ve}from"./VPagination.86f58f2d.js";import"./VAvatar.02cdd356.js";import"./router.1b5492c7.js";import"./VImg.1082014e.js";import"./position.38bf95c5.js";import"./VInput.6314292f.js";import"./index.db28d725.js";import"./forwardRefs.c003b6b8.js";import"./filter.632dd7bd.js";import"./VList.27c20723.js";import"./VMenu.381eef27.js";import"./scopeId.90dbec0f.js";import"./dialog-transition.00a8b510.js";import"./easing.36b781ab.js";import"./VCheckboxBtn.272d23a9.js";import"./VSelectionControl.043545df.js";import"./VChip.3f4aa48b.js";import"./ssrBoot.5d5196f4.js";import"./VField.965a93e8.js";/* empty css                   */import"./VCounter.70e97725.js";import"./lazy.c33cce4c.js";const ge={class:"d-flex align-center pa-6 pb-1"},_e=u("h6",{class:"text-h6"}," Add Benefit ",-1),be={__name:"AddNewBenefitDrawer",props:{isDrawerOpen:{type:null,required:!0},data:{type:null,required:!0},months:{type:null,required:!0},years:{type:null,required:!0},loading:{type:null,required:!0}},emits:["benefitData"],setup(B,{emit:A}){const l=B,_=s(!1),n=s(),D=z(),p=s({month:null,year:null}),r=s();s({id:-1});const c=()=>{l.isDrawerOpen.open=!1},b=()=>{p.value.month===null||p.value.year===null?(p.value.client.month===null&&x("Month not selected","Oops! Looks like you forgot to select a Month. Kindly pick at least one month to proceed"),p.value.client.year===null&&x("Month not selected","Oops! Looks like you forgot to select a Year. Kindly pick at least one year to proceed")):(d(),l.loading.isActive=!0,D.storeBenefit(p.value).then(m=>{l.loading.isActive=!1,p.value.month=0,p.value.year=0,L("Benefit created Successfully"),A("benefitData",{data:r})}).catch(m=>{console.log(m),l.loading.isActive=!1,x("Error Occured","Oops! Looks like the Benefit has not been submited ")}))},d=m=>{console.log(m),l.isDrawerOpen.open=!1};return(m,V)=>(w(),S(J,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":l.isDrawerOpen.open,"onUpdate:modelValue":d},{default:a(()=>[u("div",ge,[_e,e(Y),e(g,{variant:"tonal",color:"default",icon:"",size:"32",class:"rounded",onClick:c},{default:a(()=>[e(N,{size:"18",icon:"tabler-x"})]),_:1})]),e(o(Z),{options:{wheelPropagation:!1}},{default:a(()=>[e(F,{flat:""},{default:a(()=>[e(U,null,{default:a(()=>[e(G,{ref_key:"refForm",ref:n,modelValue:o(_),"onUpdate:modelValue":V[2]||(V[2]=f=>y(_)?_.value=f:null),onSubmit:Q(b,["prevent"])},{default:a(()=>[e(K,null,{default:a(()=>[e(h,{cols:"12"},{default:a(()=>[e(H,{modelValue:o(p).month,"onUpdate:modelValue":V[0]||(V[0]=f=>o(p).month=f),items:l.months,"item-value":"id","item-title":"name",label:"Month"},null,8,["modelValue","items"])]),_:1}),e(h,{cols:"12"},{default:a(()=>[e(H,{modelValue:o(p).year,"onUpdate:modelValue":V[1]||(V[1]=f=>o(p).year=f),items:l.years,label:"Year"},null,8,["modelValue","items"])]),_:1}),e(h,{cols:"12"},{default:a(()=>[e(g,{type:"submit",class:"me-3"},{default:a(()=>[O(" Submit ")]),_:1}),e(g,{type:"reset",variant:"tonal",color:"secondary",onClick:c},{default:a(()=>[O(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"]))}},De={class:"d-flex align-center pa-6 pb-1"},we=u("h6",{class:"text-h6"}," Edit Payment ",-1),xe={__name:"EditBenefitDrawer",props:{isDrawerOpen:{type:Boolean,required:!0},payment:{type:Object,required:!0},clients:{type:Object,required:!0},loading:{type:Object,required:!0}},emits:["paymentData"],setup(B,{emit:A}){const l=B,_=z();I(()=>l.payment,d=>{console.log("newPayment"),console.log(d)}),I(l.isDrawerOpen,()=>{l.isDrawerOpen.open&&(n.value.id=l.payment.id||-1,n.value.sale_id=l.payment.sale_id||"",n.value.client_id=l.payment.client_id||"",n.value.amount_paid=l.payment.amount_paid||"",n.value.payment_date=l.payment.payment_date||"",n.value.note=l.payment.note||"")});const n=s({id:0,sale_id:"",client_id:-1,amount_paid:"",payment_date:"",note:""}),D=s(!1),p=s(),r=()=>{l.isDrawerOpen.open=!1},c=()=>{n.client_id===-1||n.amount_paid==="0"||n.payment_date===""||n.note===""?(n.client_id===-1&&x("Client not selected","Oops! Looks like you forgot to select a client. Kindly pick at least one client to proceed"),n.amount_paid==="0"&&x("Amount cannot be 0","The amount value must be higher than 0"),n.amount_paid===""&&x("Amount is Empty","You must enter a value in the amount field"),n.payment_date===""&&x("Payment Date not selected","Please select the payment date")):(l.loading.isActive=!0,_.updatePayment(n.value).then(d=>{l.isDrawerOpen.open=!1,l.loading.isActive=!1,A("paymentData",1),L("Payment updated Successfully")}).catch(d=>{console.log(d),l.loading.isActive=!1,x("Error Occured","Oops! Looks like the payment has not been submited ")}))},b=d=>`${d.name}  ${d.surname}`;return(d,m)=>{const V=de;return w(),S(J,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":l.isDrawerOpen.open},{default:a(()=>[u("div",De,[we,e(Y),e(g,{variant:"tonal",color:"default",icon:"",size:"32",class:"rounded",onClick:r},{default:a(()=>[e(N,{size:"18",icon:"tabler-x"})]),_:1})]),e(o(Z),{options:{wheelPropagation:!1}},{default:a(()=>[e(F,{flat:""},{default:a(()=>[e(U,null,{default:a(()=>[e(G,{ref_key:"refForm",ref:p,modelValue:o(D),"onUpdate:modelValue":m[4]||(m[4]=f=>y(D)?D.value=f:null),onSubmit:Q(c,["prevent"])},{default:a(()=>[e(K,null,{default:a(()=>[e(h,{cols:"12"},{default:a(()=>[e(o(ue),{list:l.clients,modelValue:o(n).client_id,"onUpdate:modelValue":m[0]||(m[0]=f=>o(n).client_id=f),"option-value":"id","custom-text":b,hideSelectedOptions:!0,placeholder:"Select Client"},null,8,["list","modelValue"])]),_:1}),e(h,{cols:"12"},{default:a(()=>[e(W,{type:"number",modelValue:o(n).amount_paid,"onUpdate:modelValue":m[1]||(m[1]=f=>o(n).amount_paid=f),min:"0",label:"Payment Amount"},null,8,["modelValue"])]),_:1}),e(h,{cols:"12"},{default:a(()=>[e(V,{modelValue:o(n).payment_date,"onUpdate:modelValue":m[2]||(m[2]=f=>o(n).payment_date=f),label:"Payment Date"},null,8,["modelValue"])]),_:1}),e(h,{cols:"12"},{default:a(()=>[e(pe,{modelValue:o(n).note,"onUpdate:modelValue":m[3]||(m[3]=f=>o(n).note=f),label:"Internal Payment Note"},null,8,["modelValue"])]),_:1}),e(h,{cols:"12"},{default:a(()=>[e(g,{type:"submit",class:"me-3"},{default:a(()=>[O(" Submit ")]),_:1}),e(g,{type:"reset",variant:"tonal",color:"secondary",onClick:r},{default:a(()=>[O(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},he={__name:"ConfirmationDialog",props:{isDialogVisible:{type:Boolean,required:!0},payment:{type:Object,required:!0},loading:{type:Object,required:!0},payments:{type:Object,required:!0}},emits:["paymentData"],setup(B,{emit:A}){const l=B,_=z();s();const n=()=>{l.isDialogVisible.open=!1},D=()=>{l.loading.isActive=!0;const p=l.payment.id,r=l.payments.findIndex(c=>c.id===p);_.deletePayment(l.payment).then(c=>{l.isDialogVisible.open=!1,l.loading.isActive=!1,L("Payment Deleted Successfully"),l.payments.splice(r,1),console.log("index: "+r)}).catch(c=>{console.log(c),l.loading.isActive=!1,x("Error Occured","Oops! Looks like the payment has not been deleted ")}),l.isDialogVisible.open=!1};return(p,r)=>{const c=me;return w(),S(fe,{modelValue:l.isDialogVisible,"onUpdate:modelValue":r[2]||(r[2]=b=>l.isDialogVisible=b),persistent:"",class:"v-dialog-sm"},{default:a(()=>[e(c,{onClick:r[0]||(r[0]=b=>n())}),e(F,{title:"Confirmation"},{default:a(()=>[e(U,null,{default:a(()=>[O(" Are you sure you want to delete this payment ? ")]),_:1}),e(U,{class:"d-flex justify-end gap-3 flex-wrap"},{default:a(()=>[e(g,{color:"secondary",variant:"tonal",onClick:r[1]||(r[1]=b=>l.isDialogVisible.open=!1)},{default:a(()=>[O(" Disagree ")]),_:1}),e(g,{onClick:D},{default:a(()=>[O(" Agree ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};const Oe={class:"me-3",style:{width:"80px"}},ke={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Be={style:{width:"9rem"}},Ae=u("thead",null,[u("tr",null,[u("th",{scope:"col"}," ID "),u("th",{scope:"col"}," AMOUNT "),u("th",{scope:"col"}," MONTH/YEAR "),u("th",{scope:"col"}," ACTIONS ")])],-1),Se={class:"text-capitalize text-base font-weight-semibold"},Ue={class:"text-capitalize text-base font-weight-semibold"},Ce={class:"text-center",style:{width:"5rem"}},Pe=u("tr",null,[u("td",{colspan:"7",class:"text-center"}," No data available ")],-1),Ne=[Pe],$e={class:"text-sm text-disabled"},Ot={__name:"index",setup(B){const A=z(),l=s(""),_=s(!1),n=s({isActive:!0}),D=s(!0);s(),s(),s();const p=s(10),r=s(1),c=s(1),b=s(0);let d=s([]),m=s([]),V=s([]),f=s([]);const $=()=>{n.value.isActive=!0,A.fetchBenefits({searchValue:l.value,perPage:p.value,currentPage:r.value}).then(v=>{d.value=v.data.benefits.data,m.value=v.data.months,V.value=v.data.years,c.value=v.data.totalPage,b.value=v.data.totalBenefits,_.value=!1,n.value.isActive=!1}).catch(v=>{console.error(v),n.value.isActive=!1})};T($),T(()=>{r.value>c.value&&(r.value=c.value)}),I(l,()=>{$()});const q=s({open:!1}),E=s({open:!1}),C=s({open:!1}),k=s();T(()=>{r.value>c.value&&(r.value=c.value)});const X=ae(()=>{const v=d.value.length?(r.value-1)*p.value+1:0,i=d.value.length+(r.value-1)*p.value;return`Showing ${v} to ${i} of ${b.value} entries`}),ee=v=>{$()},te=v=>{$()},le=v=>{C.value.open=!0,k.value=v};return(v,i)=>(w(),M("section",null,[e(K,null,{default:a(()=>[e(ce,{"model-value":o(n).isActive,class:"align-center justify-center"},{default:a(()=>[e(R,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),e(h,{cols:"12"},{default:a(()=>[e(F,{title:"Benefits"},{default:a(()=>[e(j),e(U,{class:"d-flex flex-wrap py-4 gap-4"},{default:a(()=>[u("div",Oe,[e(ye,{modelValue:o(p),"onUpdate:modelValue":i[0]||(i[0]=t=>y(p)?p.value=t:null),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"])]),e(Y),u("div",ke,[u("div",Be,[o(_)?(w(),S(R,{key:0,indeterminate:"",color:"primary"})):(w(),S(W,{key:1,onInput:i[1]||(i[1]=t=>D.value=!0),ref:"searchField",modelValue:o(l),"onUpdate:modelValue":i[2]||(i[2]=t=>y(l)?l.value=t:null),placeholder:"Search",density:"compact"},null,8,["modelValue"]))]),e(g,{variant:"tonal",color:"secondary","prepend-icon":"tabler-screen-share"},{default:a(()=>[O(" Export ")]),_:1}),e(g,{"prepend-icon":"tabler-plus",onClick:i[3]||(i[3]=t=>o(q).open=!0)},{default:a(()=>[O(" Add Benefit ")]),_:1})])]),_:1}),e(j),e(ve,{class:"text-no-wrap"},{default:a(()=>[Ae,u("tbody",null,[(w(!0),M(oe,null,ne(o(d),t=>(w(),M("tr",{key:t.id,style:{height:"3.75rem"}},[u("td",null,P(t.id),1),u("td",null,[u("span",Se,P(parseFloat(t.benefit).toFixed(2))+" DZD",1)]),u("td",null,[u("span",Ue,P(o(m)[t.month-1].name)+" / "+P(t.year),1)]),u("td",Ce,[e(g,{icon:"",size:"x-small",color:"default",variant:"text",to:{name:"apps-POS-benefit-edit-id",params:{id:t.id}}},{default:a(()=>[e(N,{size:"22",icon:"tabler-edit"})]),_:2},1032,["to"]),e(g,{icon:"",size:"x-small",color:"default",variant:"text",onClick:qe=>le(t)},{default:a(()=>[e(N,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"]),e(g,{icon:"",size:"x-small",color:"default",variant:"text"},{default:a(()=>[e(N,{size:"22",icon:"tabler-dots-vertical"})]),_:1})])]))),128))]),ie(u("tfoot",null,Ne,512),[[se,!o(d).length]])]),_:1}),e(j),e(U,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3 px-5"},{default:a(()=>[u("span",$e,P(o(X)),1),e(Ve,{modelValue:o(r),"onUpdate:modelValue":i[4]||(i[4]=t=>y(r)?r.value=t:null),size:"small","total-visible":5,length:o(c)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1}),e(be,{isDrawerOpen:o(q),"onUpdate:isDrawerOpen":i[5]||(i[5]=t=>y(q)?q.value=t:null),months:o(m),"onUpdate:months":i[6]||(i[6]=t=>y(m)?m.value=t:m=t),years:o(V),"onUpdate:years":i[7]||(i[7]=t=>y(V)?V.value=t:V=t),benefit:o(d),"onUpdate:benefit":i[8]||(i[8]=t=>y(d)?d.value=t:d=t),loading:o(n),"onUpdate:loading":i[9]||(i[9]=t=>y(n)?n.value=t:null),onBenefitData:v.addNewBenefit},null,8,["isDrawerOpen","months","years","benefit","loading","onBenefitData"]),e(xe,{isDrawerOpen:o(E),"onUpdate:isDrawerOpen":i[10]||(i[10]=t=>y(E)?E.value=t:null),benefit:o(k),"onUpdate:benefit":i[11]||(i[11]=t=>y(k)?k.value=t:null),clients:o(f),"onUpdate:clients":i[12]||(i[12]=t=>y(f)?f.value=t:f=t),loading:o(n),"onUpdate:loading":i[13]||(i[13]=t=>y(n)?n.value=t:null),onBenefitData:ee},null,8,["isDrawerOpen","benefit","clients","loading"]),o(C).open?(w(),S(he,{key:0,isDialogVisible:o(C),"onUpdate:isDialogVisible":i[14]||(i[14]=t=>y(C)?C.value=t:null),benefit:o(k),"onUpdate:benefit":i[15]||(i[15]=t=>y(k)?k.value=t:null),loading:o(n),"onUpdate:loading":i[16]||(i[16]=t=>y(n)?n.value=t:null),benefits:o(d),"onUpdate:benefits":i[17]||(i[17]=t=>y(d)?d.value=t:d=t),onBenefitData:te},null,8,["isDialogVisible","benefit","loading","benefits"])):re("",!0)]))}};export{Ot as default};
