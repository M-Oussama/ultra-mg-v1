import{bd as I,j as K,k as d,$ as E,o as v,b as y,w as a,p as t,q as s,be as z,E as p,c as Q,a as H,F as J,y as N,m as c,D as w}from"./main.d0838da3.js";import"./AppDateTimePicker.3a302d25.js";import{u as W}from"./useSaleStore.5f8d3d14.js";import{s as R}from"./successMiddleware.7810b3f1.js";import{_ as X}from"./InvoiceSendInvoiceDrawer.dba89d90.js";/* empty css                        *//* empty css                                                           *//* empty css                                                        */import{a as Y,V as _}from"./VBtn.d8db924d.js";import{a as Z}from"./VOverlay.75263baa.js";import{V as O,c as B}from"./VCard.9b1f82a8.js";import{V as ee}from"./VForm.47365830.js";import{V as P,a as i}from"./VRow.10fd63fa.js";import{V as b}from"./VInput.79096a8f.js";import{V as f}from"./VTextField.21e071fb.js";import{V as k}from"./VSwitch.c4034b57.js";import"./VField.b81f47ba.js";import"./index.7e79e22f.js";import"./position.2e295d5d.js";import"./router.390136dd.js";import"./easing.36b781ab.js";import"./VSpacer.27cbae4e.js";import"./VAvatar.83fd3a57.js";import"./VImg.2be96fe3.js";import"./VTextarea.f1dd0859.js";/* empty css                   */import"./forwardRefs.c003b6b8.js";import"./VCounter.9b7bf05a.js";import"./VChip.c3a21cb8.js";import"./VNavigationDrawer.da1e2a98.js";import"./ssrBoot.d9a330cd.js";import"./lazy.bbc0a3b2.js";import"./VSelectionControl.9fdb71fb.js";const te=c("h6",{class:"text-sm font-weight-medium mb-3"}," Payment Method: ",-1),le={class:"mt-5 d-flex align-center justify-space-between"},ae={class:"d-flex align-center justify-space-between"},oe={class:"d-flex align-center justify-space-between"},De={__name:"[id]",setup(se){const g=I(),$=K(),r=d([]),u=d({raw_material_price:0,total_profit:0}),h=d(0),F=W(),m=d({isActive:!1}),j=d(null),S=()=>{F.getArticlesBenefit(Number(g.params.id)).then(l=>{m.isActive=!1,r.value=l.data.articles,u.value=l.data.benefit,console.log(u.value.benefit),u.value.total_profit=u.value.benefit}).catch(l=>{m.isActive=!1,console.log(l)})};E(S);const V=d(!1);d(!1);const U=d(!0),x=d(!1),A=d(!1),C=d(!1);d(0);const q=()=>{},D=l=>{var o=parseFloat(l.weight)*(parseFloat(u.value.raw_material_price)/1e3),e=o>0?o+5+1:0;l.benefit=parseFloat(l.product_price)-e,l.total_profit=parseFloat(l.total_amount)-parseFloat(l.benefit)*parseFloat(l.quantity),T()},L=()=>{for(let e=0;e<r.value.length;e++){var l=parseFloat(r.value[e].weight)*(parseFloat(u.value.raw_material_price)/1e3),o=l>0?l+5+1:0;r.value[e].benefit=parseFloat(r.value[e].product_price)-o,r.value[e].total_profit=parseFloat(r.value[e].total_amount)-parseFloat(r.value[e].benefit)*parseFloat(r.value[e].quantity)}T()},T=()=>{h.value=0;for(let l=0;l<r.value.length;l++)h.value+=parseFloat(r.value[l].total_profit);u.value.total_profit=parseFloat(h.value).toFixed(2)},M=()=>{m.value.isActive=!0,F.updateProfit(r.value,u.value,Number(g.params.id)).then(l=>{m.value.isActive=!1,R(l.data.message),$.push("/apps/pos/benefit/list")}).catch(l=>{m.value.isActive=!1,console.log(l)})},G=()=>{m.value.isActive=!0,F.refreshData(Number(g.params.id)).then(l=>{console.log(l),m.value.isActive=!1,S(),R(l.data.message)}).catch(l=>{m.value.isActive=!1,console.log(l)})};return(l,o)=>(v(),y(P,null,{default:a(()=>[t(Z,{"model-value":s(m).isActive,class:"align-center justify-center"},{default:a(()=>[t(Y,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),t(i,{cols:"12",md:"12"},{default:a(()=>[t(O,null,{default:a(()=>[t(B,{class:"d-flex flex-wrap justify-space-between flex-column"},{default:a(()=>[t(ee,{ref:"refForm",onSubmit:o[5]||(o[5]=z(()=>{},["prevent"]))},{default:a(()=>[t(P,null,{default:a(()=>[t(i,{cols:"6",md:"4",class:"mb-5 text-center"},{default:a(()=>[t(b,{title:"Raw material price per KG ",class:"mb-5"}),t(f,{modelValue:s(u).raw_material_price,"onUpdate:modelValue":[o[0]||(o[0]=e=>s(u).raw_material_price=e),o[1]||(o[1]=e=>L())],type:"number",label:"RM price KG",placeholder:"price of the raw material per KG"},null,8,["modelValue"])]),_:1}),t(i,{cols:"6",md:"4",class:"mb-5 text-center"},{default:a(()=>[t(b,{title:"Raw material price per KG ",class:"mb-5"}),t(f,{modelValue:s(u).total_profit,"onUpdate:modelValue":o[2]||(o[2]=e=>s(u).total_profit=e),type:"number",readonly:"",label:"TOTAL PROFIT",placeholder:"TOTAL PROFIT"},null,8,["modelValue"])]),_:1}),t(i,{cols:"4",md:"1",class:"mt-7"},{default:a(()=>[t(_,{onClick:o[3]||(o[3]=e=>M())},{default:a(()=>[p(" Submit ")]),_:1})]),_:1}),t(i,{cols:"4",md:"1",class:"mt-7"},{default:a(()=>[t(_,{color:"success",onClick:o[4]||(o[4]=e=>G())},{default:a(()=>[p(" Refresh ")]),_:1})]),_:1})]),_:1}),(v(!0),Q(J,null,H(s(r),e=>(v(),y(P,null,{default:a(()=>[t(i,{cols:"12",md:"2"},{default:a(()=>[t(f,{modelValue:e.product.name,"onUpdate:modelValue":n=>e.product.name=n,label:"Name of the product",placeholder:"Name of the product",readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(i,{cols:"12",md:"2"},{default:a(()=>[t(f,{type:"number",modelValue:e.product_price,"onUpdate:modelValue":[n=>e.product_price=n,n=>D(e)],label:"Product's Price",placeholder:"price of the product"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(i,{cols:"12",md:"2"},{default:a(()=>[t(f,{type:"number",modelValue:e.benefit,"onUpdate:modelValue":n=>e.benefit=n,label:"Product's Benefit",placeholder:"Benefit of the product",readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(i,{cols:"12",md:"2"},{default:a(()=>[t(f,{type:"number",modelValue:e.quantity,"onUpdate:modelValue":n=>e.quantity=n,label:"Product's Quantity",placeholder:"quantity of the product this month",readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(i,{cols:"12",md:"2"},{default:a(()=>[t(f,{type:"number",modelValue:e.total_amount,"onUpdate:modelValue":n=>e.total_amount=n,label:"Product's total amount",placeholder:"total amount of the product",readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(i,{cols:"12",md:"2"},{default:a(()=>[t(f,{type:"number",modelValue:e.total_profit,"onUpdate:modelValue":n=>e.total_profit=n,label:"Product's total profit",placeholder:"total profit of the product",readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),256))]),_:1},512)]),_:1})]),_:1})]),_:1}),t(i,{cols:"12",md:"3"},{default:a(()=>[t(O,{class:"mb-8"},{default:a(()=>[t(B,null,{default:a(()=>[t(_,{block:"","prepend-icon":"tabler-send",class:"mb-2",onClick:o[6]||(o[6]=e=>V.value=!0)},{default:a(()=>[p(" Send Invoice ")]),_:1}),s(C)?(v(),y(_,{key:0,block:"",color:"secondary",variant:"tonal",class:"mb-2",to:{name:"apps-POS-sale-preview-id",params:{id:s(j)}}},{default:a(()=>[p(" Preview ")]),_:1},8,["to"])):N("",!0),s(C)?N("",!0):(v(),y(_,{key:1,loading:s(m).isActive,disabled:s(m).isActive,block:"",color:"success",class:"mb-2",onClick:q},{default:a(()=>[p(" Save ")]),_:1},8,["loading","disabled"]))]),_:1})]),_:1}),te,c("div",le,[t(b,{for:"payment-terms"},{default:a(()=>[p(" Payment Terms ")]),_:1}),c("div",null,[t(k,{id:"payment-terms",modelValue:s(U),"onUpdate:modelValue":o[7]||(o[7]=e=>w(U)?U.value=e:null)},null,8,["modelValue"])])]),c("div",ae,[t(b,{for:"client-notes"},{default:a(()=>[p(" Client Notes ")]),_:1}),c("div",null,[t(k,{id:"client-notes",modelValue:s(x),"onUpdate:modelValue":o[8]||(o[8]=e=>w(x)?x.value=e:null)},null,8,["modelValue"])])]),c("div",oe,[t(b,{for:"payment-stub"},{default:a(()=>[p(" Payment Stub ")]),_:1}),c("div",null,[t(k,{id:"payment-stub",modelValue:s(A),"onUpdate:modelValue":o[9]||(o[9]=e=>w(A)?A.value=e:null)},null,8,["modelValue"])])])]),_:1}),t(X,{isDrawerOpen:s(V),"onUpdate:isDrawerOpen":o[10]||(o[10]=e=>w(V)?V.value=e:null)},null,8,["isDrawerOpen"])]),_:1}))}};export{De as default};
