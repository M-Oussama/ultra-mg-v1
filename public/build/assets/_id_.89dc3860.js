import{k as n,bd as ut,$ as j,Z as dt,A as ct,r as pt,o as u,c as x,p as o,w as i,q as s,m as t,D as c,b as V,E as I,F as z,a as L,x as r,H as mt,I as _t,y as ft}from"./main.6ddfa6b7.js";import{_ as vt}from"./DialogCloseBtn.286a0e3d.js";import{_ as ht}from"./AppDateTimePicker.343c4091.js";import{u as xt,_ as Vt,a as bt,b as yt,c as wt}from"./ClientMonthlyReport.0fad22f0.js";import{E as gt}from"./jspdf.es.min.91293511.js";import{a as Dt}from"./jspdf.plugin.autotable.153437d5.js";import{a as Ct}from"./VOverlay.2d6bdfb2.js";import{a as J,V as q}from"./VBtn.376421a6.js";import{a as Z,V as K}from"./VRow.09821601.js";import{V as X,c as G}from"./VCard.0bfd53b9.js";import{V as B}from"./VDivider.8642c1cc.js";import{V as kt}from"./VSelect.ce0e37ca.js";import{V as St}from"./VSpacer.892b8e7d.js";import{V as Ft}from"./VTextField.84b2ab9a.js";import{V as M}from"./VTable.5aa25187.js";import{V as At}from"./VAvatar.de0a6008.js";import{V as Pt}from"./VPagination.71eff5f3.js";import{V as Tt,a as Ut}from"./VTabs.b00e525b.js";import{V as It,a as E}from"./VWindowItem.9862e387.js";import{V as zt}from"./VDialog.09415bef.js";import"./VField.b42ed233.js";import"./index.312d6846.js";import"./VInput.5e24232f.js";import"./router.6776eb4e.js";import"./VImg.000ebbd2.js";import"./position.e19bf76f.js";import"./easing.36b781ab.js";import"./validators.330a354f.js";import"./index.b522f886.js";import"./VForm.116cc20e.js";import"./forwardRefs.c003b6b8.js";import"./VAutocomplete.1560c082.js";import"./filter.c8007da4.js";import"./VList.9a90da75.js";import"./VMenu.f5c9e339.js";import"./scopeId.8423e22b.js";import"./dialog-transition.0e92eaa3.js";import"./VCheckboxBtn.6755e995.js";import"./VSelectionControl.3c10b28a.js";import"./VChip.4b7cce73.js";import"./VNavigationDrawer.31b7f178.js";import"./ssrBoot.c790042d.js";import"./vue3-apexcharts.common.afcc4ec2.js";import"./vue.runtime.esm-bundler.3172115d.js";import"./lazy.f12e00d0.js";/* empty css                   */import"./VCounter.7ab3dccf.js";import"./VSlideGroup.c6e68dbb.js";const Lt={class:"me-3",style:{width:"80px"}},Nt={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Wt={style:{width:"9rem"}},Bt=t("thead",null,[t("tr",null,[t("th",{scope:"col"}," ID "),t("th",{scope:"col"}," Date "),t("th",{scope:"col"}," Achat "),t("th",{scope:"col"}," Regulation "),t("th",{scope:"col"}," Payment "),t("th",{scope:"col"}," Balance ")])],-1),Et={class:"d-flex align-center"},Ot={class:"d-flex flex-column"},$t={class:"text-base"},Rt={class:"text-sm text-disabled"},jt={class:"text-capitalize text-base font-weight-semibold"},qt={class:"text-capitalize text-base font-weight-semibold"},Gt={class:"text-capitalize text-base font-weight-semibold"},Mt={class:"text-capitalize text-base font-weight-semibold"},Qt=t("tr",null,[t("td",{colspan:"7",class:"text-center"}," No data available ")],-1),Yt=[Qt],Ht={class:"text-sm text-disabled"},Jt=t("thead",null,[t("tr",null,[t("th",{class:"text-caption"}," Product "),t("th",{class:"text-caption"}," Date "),t("th",{class:"text-caption"}," Quantity "),t("th",{class:"text-caption"}," Price "),t("th",{class:"text-caption"}," Total ")])],-1),Zt={class:"text-caption"},Kt={class:"text-caption"},Xt={class:"text-caption"},te={class:"text-caption"},ee={class:"text-caption"},ae=t("td",null,null,-1),le=t("td",null,null,-1),oe=t("td",null,null,-1),se=t("td",{class:"text-caption"}," Total ",-1),ne={class:"text-caption"},ie=t("td",null,null,-1),re=t("td",null,null,-1),ue=t("td",null,null,-1),de=t("td",{class:"text-caption"}," Payment ",-1),ce={class:"text-caption"},pe=t("td",null,null,-1),me=t("td",null,null,-1),_e=t("td",null,null,-1),fe=t("td",{class:"text-caption"}," Rest ",-1),ve={class:"text-caption"},he=t("thead",null,[t("tr",null,[t("th",null," Date "),t("th",null," Amount ")])],-1),ma={__name:"[id]",setup(xe){const S=xt(),F=n(""),Q=n(!1),tt=n(!0),D=n(!1);n(),n(),n();const C=n(10),_=n(1),k=n(1),Y=n(0),w=n([]);let d=n([]),b=n(),y=n("Appetizers"),g=n({isActive:!1});const A=n(),P=n();n("Sample PDF Generator"),n(["This is another few sentences of text to look at it.","Just testing the paragraphs to see how they format.","jsPDF likes arrays for sentences.","Do paragraphs wrap properly?","Yes, they do!","What does it look like?","Not bad at all."]);const h=n([{title:"Item 1",body:"I am item 1 body text"},{title:"Item 2",body:"I am item 2 body text"},{title:"Item 3",body:"I am item 3 body text"},{title:"Item 4",body:"I am item 4 body text"}]);let N=n(0);const H=ut(),T=()=>{g.value.isActive=!0,S.fetchClientLog({client_id:Number(H.params.id),from_date:A.value,to_date:P.value,searchValue:F.value,perPage:C.value,currentPage:_.value}).then(l=>{console.log(l),g.value.isActive=!1,d.value=l.data.logs.data,b.value=l.data.client,k.value=l.data.totalPage,w.value=l.data.cities,Y.value=l.data.totalLogs,Q.value=!1}).catch(l=>{console.error(l),g.value.isActive=!1})};j(T),j(()=>{_.value>k.value&&(_.value=k.value)}),dt(F,()=>{T()});const O=n(!1),$=n(!1),W=n(!1);let f=n();j(()=>{_.value>k.value&&(_.value=k.value)});const et=ct(()=>{const l=d.value.length?(_.value-1)*C.value+1:0,a=d.value.length+(_.value-1)*C.value;return`Showing ${l} to ${a} of ${Y.value} entries`}),at=l=>{S.addClient(l).then(a=>{T()}).catch(a=>{console.log(a)})},lt=l=>{S.updateClient(l).then(a=>{T()}).catch(a=>{console.log(a)})},ot=l=>{S.deleteClient(l).then(a=>{T()}).catch(a=>{console.log(a)})},st=l=>(l.type==="sale"?l.counted||(l.total_balance=N.value,parseFloat(l.amount)>0?l.total_balance+=parseFloat(l.amount):l.total_balance-=parseFloat(l.amount),l.counted=!0,N.value=l.total_balance):l.counted||(l.total_balance=N.value,parseFloat(l.amount)>0?l.total_balance-=parseFloat(l.amount):l.total_balance+=parseFloat(l.amount),l.counted=!0,N.value=l.total_balance),l.total_balance),nt=()=>{g.value.isActive=!0,S.exportAllLog({client_id:Number(H.params.id),from_date:A.value,to_date:P.value}).then(l=>{g.value.isActive=!1}).catch(l=>{console.error(l),g.value.isActive=!1})},it=()=>{var l=[],a=1;l.push(["ID","Date","Sale","Payment","Balance"]);for(let m=0;m<d._rawValue.length;m++)d._rawValue[m].type==="sale"?l.push([a,d._rawValue[m].date,d._rawValue[m].amount,d._rawValue[m].regulation>0?d._rawValue[m].regulation:"",d._rawValue[m].total_balance]):l.push([a,d._rawValue[m].date,"",d._rawValue[m].amount,d._rawValue[m].total_balance]),a++;console.log(l),l.push([a,"","","",d._rawValue[d._rawValue.length-1].total_balance]);const p=new gt({orientation:"portrait",format:"letter"});let U=new Date,R=String(U.getDate()).padStart(2,"0"),e=String(U.getMonth()+1).padStart(2,"0"),v=U.getFullYear(),rt=R+"/"+e+"/"+v;p.setFontSize(16).text("CUSTOMER LOG",100,15,{align:"center",maxWidth:"100"}),p.setFontSize(8).text("Client: "+b.value.name+" "+b.value.surname,15,25,{align:"left",maxWidth:"100"}),p.setFontSize(8).text("Address: "+b.value.address,100,25,{align:"center",maxWidth:"100"}),p.setFontSize(8).text("Email: "+(b.value.email===null?"":b.value.email),195,25,{align:"right",maxWidth:"100"}),p.setFontSize(8).text("Phone: "+(b.value.phone===null?"":b.value.phone),15,35,{align:"left",maxWidth:"100"}),p.setFontSize(8).text("From:        To:      ",97,35,{align:"center",maxWidth:"100"}),p.setFontSize(8).text("Date: "+rt,187,35,{align:"right",maxWidth:"100"}),Dt(p,{columnStyles:{0:{halign:"center"}},margin:{top:40,left:10},body:l}),p.save("table.pdf")};return(l,a)=>{const p=ht,U=pt("RouterLink"),R=vt;return u(),x("section",null,[o(K,null,{default:i(()=>[o(Ct,{"model-value":s(g).isActive,class:"align-center justify-center"},{default:i(()=>[o(J,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),o(Z,{cols:"12"},{default:i(()=>[o(X,{title:"logs"},{default:i(()=>[o(B),o(G,{class:"d-flex flex-wrap py-4 gap-4"},{default:i(()=>[t("div",Lt,[o(kt,{modelValue:s(C),"onUpdate:modelValue":a[0]||(a[0]=e=>c(C)?C.value=e:null),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"])]),o(p,{modelValue:s(A),"onUpdate:modelValue":a[1]||(a[1]=e=>c(A)?A.value=e:null),label:"From"},null,8,["modelValue"]),o(p,{modelValue:s(P),"onUpdate:modelValue":a[2]||(a[2]=e=>c(P)?P.value=e:null),label:"To"},null,8,["modelValue"]),o(St),t("div",Nt,[t("div",Wt,[s(Q)?(u(),V(J,{key:0,indeterminate:"",color:"primary"})):(u(),V(Ft,{key:1,onInput:a[3]||(a[3]=e=>tt.value=!0),ref:"searchField",modelValue:s(F),"onUpdate:modelValue":a[4]||(a[4]=e=>c(F)?F.value=e:null),placeholder:"Search",density:"compact"},null,8,["modelValue"]))]),o(q,{variant:"tonal",color:"secondary","prepend-icon":"tabler-screen-share",onClick:it},{default:i(()=>[I(" Export ")]),_:1}),o(q,{variant:"tonal",color:"secondary","prepend-icon":"tabler-screen-share",onClick:nt},{default:i(()=>[I(" ExportAll ")]),_:1})])]),_:1}),o(B),o(M,{class:"text-no-wrap"},{default:i(()=>[Bt,t("tbody",null,[(u(!0),x(z,null,L(s(d),(e,v)=>(u(),x("tr",{key:e.id,style:{height:"3.75rem"}},[t("td",null,r(parseInt(v)+1),1),t("td",null,[t("div",Et,[o(At,{variant:"tonal",class:"me-3",size:"38"},{default:i(()=>[t("span",null,r(e.type.toUpperCase().charAt(0)),1)]),_:2},1024),t("div",Ot,[t("h6",$t,[o(U,{to:{name:"apps-user-view-id",params:{id:e.id}},class:"font-weight-medium user-list-name"},{default:i(()=>[I(r(e.date),1)]),_:2},1032,["to"])]),t("span",Rt,r(),1)])])]),t("td",null,[t("span",jt,r(e.type==="sale"?e.amount:""),1)]),t("td",null,[t("span",qt,r(e.type==="sale"?e.regulation:""),1)]),t("td",null,[t("span",Gt,r(e.type==="payment"?e.amount:""),1)]),t("td",null,[t("span",Mt,r(st(e)),1)])]))),128))]),mt(t("tfoot",null,Yt,512),[[_t,!s(d).length]])]),_:1}),o(B),o(G,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3 px-5"},{default:i(()=>[t("span",Ht,r(s(et)),1),o(Pt,{modelValue:s(_),"onUpdate:modelValue":a[5]||(a[5]=e=>c(_)?_.value=e:null),size:"small","total-visible":5,length:s(k)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1}),o(zt,{modelValue:s(D),"onUpdate:modelValue":a[10]||(a[10]=e=>c(D)?D.value=e:null),scrollable:"",class:"v-dialog-sm","max-width":"700",width:"auto","content-class":"scrollable-dialog"},{default:i(()=>[o(R,{onClick:a[6]||(a[6]=e=>D.value=!s(D))}),o(X,{title:" "},{default:i(()=>[o(G,{class:"d-flex justify-end gap-3 flex-wrap"},{default:i(()=>[o(Tt,{modelValue:s(y),"onUpdate:modelValue":a[7]||(a[7]=e=>c(y)?y.value=e:y=e),grow:""},{default:i(()=>[(u(!0),x(z,null,L(s(h),e=>(u(),V(Ut,{key:e.id,value:e.id},{default:i(()=>[I(r(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),o(B),o(It,{modelValue:s(y),"onUpdate:modelValue":a[8]||(a[8]=e=>c(y)?y.value=e:y=e),class:"mt-6 pl-3 pa-1"},{default:i(()=>[(u(),V(E,{key:s(h)[0].id,value:s(h)[0].id,width:"150%"},{default:i(()=>[o(K,null,{default:i(()=>[o(Z,{cols:"6",md:"6"},{default:i(()=>[o(Vt)]),_:1})]),_:1})]),_:1},8,["value"])),(u(),V(E,{key:s(h)[1].id,value:s(h)[1].id,class:"mt-0",style:{"margin-top":"0 !important"}},{default:i(()=>[(u(!0),x(z,null,L(s(f).sales,e=>(u(),V(M,{class:"text-no-wrap mt-0 mb-10"},{default:i(()=>[Jt,t("tbody",null,[(u(!0),x(z,null,L(e.sale_items,v=>(u(),x("tr",{key:v.id},[t("td",Zt,r(v.product.name),1),t("td",Kt,r(v.sale_date),1),t("td",Xt,r(v.quantity),1),t("td",te,r(v.price),1),t("td",ee,r(v.total_price),1)]))),128)),t("tr",null,[ae,le,oe,se,t("td",ne,r(e.amount),1)]),t("tr",null,[ie,re,ue,de,t("td",ce,r(e.regulation),1)]),t("tr",null,[pe,me,_e,fe,t("td",ve,r(e.balance),1)])])]),_:2},1024))),256))]),_:1},8,["value"])),(u(),V(E,{key:s(h)[2].id,value:s(h)[2].id,class:"mt-0",style:{width:"-webkit-fill-available"},width:"100%"},{default:i(()=>[o(M,{class:"text-no-wrap mt-0",style:{width:"-webkit-fill-available"}},{default:i(()=>[he,t("tbody",null,[(u(!0),x(z,null,L(s(f).payments,e=>(u(),x("tr",{key:e.id},[t("td",null,r(e.payment_date),1),t("td",null,r(e.amount),1)]))),128))])]),_:1})]),_:1},8,["value"])),(u(),V(E,{key:s(h)[3].id,value:s(h)[3].id},null,8,["value"]))]),_:1},8,["modelValue"]),o(q,{onClick:a[9]||(a[9]=e=>D.value=!1)},{default:i(()=>[I(" Close ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(bt,{isDrawerOpen:s(O),"onUpdate:isDrawerOpen":a[11]||(a[11]=e=>c(O)?O.value=e:null),cities:s(w),"onUpdate:cities":a[12]||(a[12]=e=>c(w)?w.value=e:null),onClientData:at},null,8,["isDrawerOpen","cities"]),o(yt,{isDrawerOpen:s($),"onUpdate:isDrawerOpen":a[13]||(a[13]=e=>c($)?$.value=e:null),client:s(f),"onUpdate:client":a[14]||(a[14]=e=>c(f)?f.value=e:f=e),cities:s(w),"onUpdate:cities":a[15]||(a[15]=e=>c(w)?w.value=e:null),onClientData:lt},null,8,["isDrawerOpen","client","cities"]),s(W)?(u(),V(wt,{key:0,isDialogVisible:s(W),"onUpdate:isDialogVisible":a[16]||(a[16]=e=>c(W)?W.value=e:null),client:s(f),"onUpdate:client":a[17]||(a[17]=e=>c(f)?f.value=e:f=e),onClientData:ot},null,8,["isDialogVisible","client"])):ft("",!0)])}}};export{ma as default};
