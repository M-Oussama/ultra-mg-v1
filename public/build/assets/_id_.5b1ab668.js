import{A as Y,Z as F,o as g,c as L,m as e,p as t,w as s,x as c,q as d,C as z,F as M,k as p,b as D,V as G,v as H,D as k,a as J,bd as W,j as X,E as S,y as O,bf as K}from"./main.8fd45797.js";import{_ as ee}from"./AppDateTimePicker.0cf194f6.js";import"./useSaleStore.80c0054f.js";import{e as A}from"./errorsMiddleware.62ad9a36.js";import{s as te}from"./successMiddleware.e3195395.js";import{_ as ae}from"./InvoiceSendInvoiceDrawer.c7f1919c.js";/* empty css                        */import{a as f,V as P}from"./VRow.3025d440.js";import{V as N}from"./VTextField.2ac73a6a.js";import{V as E,a as se}from"./VBtn.c93b5ba3.js";import{V as j,c as I}from"./VCard.1123f389.js";import{u as Z}from"./useCertifyInvoiceListStore.5e9c200a.js";import{q as B}from"./VueSearchSelect.1286e7d9.js";import{V as C}from"./VDivider.32b554c9.js";import{V as oe}from"./VTextarea.92726099.js";import{a as le}from"./VOverlay.8a102fa4.js";import{V as de}from"./VSelect.29a13347.js";import{V as $}from"./VInput.011a97ea.js";import{V as R}from"./VSwitch.9b9452c8.js";import"./VField.b2abde9d.js";import"./index.96d998ca.js";import"./position.e593359d.js";import"./router.62fd2ce6.js";import"./easing.36b781ab.js";import"./VSpacer.9ecb754a.js";import"./VAvatar.579b8c09.js";import"./VImg.3f9a9712.js";import"./VForm.b5dcb977.js";import"./forwardRefs.c003b6b8.js";import"./VChip.0f94ba81.js";import"./VNavigationDrawer.400678f5.js";import"./ssrBoot.6384c20c.js";/* empty css                   */import"./VCounter.3f3650c6.js";import"./lazy.495b6b1b.js";import"./VList.82cd140d.js";import"./dialog-transition.979db23a.js";import"./VMenu.18127d92.js";import"./scopeId.54218c30.js";import"./VCheckboxBtn.5e6b3514.js";import"./VSelectionControl.a0e35569.js";const ne={class:"add-products-header mb-2 d-none d-md-flex"},ie=e("span",{class:"text-sm"}," Item ",-1),ce=e("span",{class:"text-sm"}," Price ",-1),re=e("span",{class:"text-sm"}," Quantity ",-1),ue=e("span",{class:"text-sm"}," Total ",-1),me={class:"pa-5 flex-grow-1"},pe={class:"text-sm-center my-2"},_e=e("span",{class:"d-inline d-md-none"},"Price: ",-1),fe={class:"text-body-1"},ve={class:"d-flex flex-column justify-space-between border-s pa-1"},ye={__name:"InvoiceProductEdit",props:{id:{type:Number,required:!0},data:{type:Object,required:!0,default:()=>({id:"",name:"",brand:"",description:"",product_code:"",SKU:"",price:15,stockable:!1,tax_rate:.5,product_stock:{quantity:0}})}},emits:["removeProduct","totalAmount"],setup(T,{emit:a}){const m=T,n=m.data.quantity;m.data.oldQuantity=n;const x=Y(()=>Number(m.data.price)*Number(m.data.quantity)),r=()=>{a("removeProduct",m.data)},i=()=>{a("totalAmount",m.data)};return F(x,()=>{i()},{immediate:!0}),(w,v)=>(g(),L(M,null,[e("div",ne,[t(P,{class:"font-weight-medium px-4"},{default:s(()=>[t(f,{cols:"12",md:"6"},{default:s(()=>[ie]),_:1}),t(f,{cols:"12",md:"2"},{default:s(()=>[ce]),_:1}),t(f,{cols:"12",md:"2"},{default:s(()=>[re]),_:1}),t(f,{cols:"12",md:"2"},{default:s(()=>[ue]),_:1})]),_:1})]),t(j,{flat:"",border:"",class:"d-flex flex-row"},{default:s(()=>[e("div",me,[t(P,null,{default:s(()=>[t(f,{cols:"12",md:"6",sm:"4"},{default:s(()=>[t(N,{modelValue:m.data.product.name,"onUpdate:modelValue":v[0]||(v[0]=b=>m.data.product.name=b),type:"string",label:"Product",disabled:""},null,8,["modelValue"])]),_:1}),t(f,{cols:"12",md:"2",sm:"4"},{default:s(()=>[t(N,{modelValue:m.data.price,"onUpdate:modelValue":v[1]||(v[1]=b=>m.data.price=b),type:"number",label:"Price"},null,8,["modelValue"])]),_:1}),t(f,{cols:"12",md:"2",sm:"4"},{default:s(()=>[t(N,{modelValue:m.data.quantity,"onUpdate:modelValue":v[2]||(v[2]=b=>m.data.quantity=b),type:"number",label:"Quantity"},null,8,["modelValue"])]),_:1}),t(f,{cols:"12",md:"2",sm:"4"},{default:s(()=>[e("p",pe,[_e,e("span",fe,c(d(x).toFixed(2))+" DZD",1)])]),_:1})]),_:1})]),e("div",ve,[t(E,{icon:"",size:"x-small",color:"default",variant:"text",onClick:r},{default:s(()=>[t(z,{size:"20",icon:"tabler-x"})]),_:1})])]),_:1})],64))}};const be={class:"ma-sm-4"},he={class:"d-flex align-center mb-6"},xe={class:"font-weight-bold text-xl"},Ve={class:"mb-0"},ge={class:"mb-0"},we={class:"mb-0"},Se={class:"mt-4 ma-sm-4"},Ie={class:"d-flex align-center font-weight-medium justify-sm-end text-xl mb-3"},Ne=e("span",{class:"me-3"},"Invoice",-1),Ae={class:"d-flex align-center justify-sm-end mb-3"},ke=e("span",{class:"me-3"},"Date Issued",-1),Pe={class:"align-center mb-6"},Te=e("h6",{class:"text-sm font-weight-medium mb-3"}," Invoice To: ",-1),Ce=e("div",{class:"align-center mb-6"},[e("h6",{class:"text-sm font-weight-medium mb-3"}," City: ")],-1),De={class:"mt-4 ma-sm-4"},Ee=e("h6",{class:"text-sm font-weight-medium mb-3"}," Bill To: ",-1),Ue=e("td",{class:"pe-6"}," Invoice: ",-1),qe={class:"font-weight-semibold"},$e=e("td",{class:"pe-6"}," Payment Method: ",-1),Re={class:"font-weight-semibold"},Fe=e("td",{class:"pe-6"}," Client: ",-1),Le={class:"font-weight-semibold"},je=e("td",{class:"pe-6"}," Address: ",-1),Oe=e("td",{class:"pe-6"}," N\xB0RC: ",-1),Ke=e("td",{class:"pe-6"}," N\xB0IF: ",-1),Be=e("td",{class:"pe-6"}," N\xB0IS: ",-1),Me=e("td",{class:"pe-6"}," N\xB0ART: ",-1),Ze={class:"mt-4 ma-sm-4"},Qe=e("span",{class:"text-sm-caption mb-2"},"Products",-1),Ye=e("div",{class:"mt-7 ma-sm-7"},null,-1),ze={class:"mx-sm-4 my-2"},Ge={class:"d-flex align-center mb-4"},He=e("h6",{class:"text-sm font-weight-semibold me-2"}," Salesperson: ",-1),Je={class:"my-2 mx-sm-4"},We=e("td",{class:"text-end"},[e("div",{class:"me-5"},[e("p",{class:"mb-2"}," Montant HT: "),e("p",{class:"mb-2"}," TVA 19%: "),e("p",{class:"mb-2"}," Montant TTC: ")])],-1),Xe={class:"font-weight-semibold"},et={class:"mb-2"},tt={class:"mb-2"},at={class:"mb-2"},st=e("p",{class:"font-weight-semibold mb-2"}," Note: ",-1),ot={__name:"InvoiceEditable",props:{data:{type:null,required:!0},loading:{type:null,required:!0}},setup(T){const a=T,m=Z();let n=p(0),x=p(a.data.date);p({id:-1,name:"",brand:"",description:"",product_code:"",SKU:"",price:0,stockable:!1,tax_rate:0,product_stock:{quantity:0}}),p([]),p([]);const r=p({name:"EURL SETIFIS DETERGENTS",address:"LOT N, 6 GROUPE 51, ZONE INDUSTRIELLE, 34 SECTION, Ksar El Abtal 19220",address2:"KASR EL ABTAL 19220, SETIF, ALGERIE",phone1:"+213 0668 15 41 45",phone2:"+213 0668 15 41 45"});let i=p({quantity:0,price:0,total:0,product:{id:-1,name:"Select a product",brand:"",description:"",product_code:"",SKU:"",price:0,stockable:!1,tax_rate:0,product_stock:{quantity:0}}});const w=p({quantity:0,price:0,total:0,product:{id:-1,name:"Select a product",brand:"",description:"",product_code:"",SKU:"",price:0,stockable:!1,tax_rate:0,product_stock:{quantity:0}}});F(a.data,()=>{x.value!==a.data.date&&(x.value=a.data.date,a.loading.isActive=!0,m.getLastID({date:a.data.date}).then(o=>{a.data.id=o.data.id,a.loading.isActive=!1}).catch(o=>{a.loading.isActive=!1,console.log(o)}))});const v=o=>{V()},b=o=>(console.log("item :"),console.log(o),`${o.product.name}`);function V(){let o=a.data.certify_invoice_products.map(l=>l.price*l.quantity);n.value=o.reduce((l,h)=>l+h,0),a.data.total=o.reduce((l,h)=>l+h,0),a.data.amount=o.reduce((l,h)=>l+h,0)}const U=()=>{i.value!==void 0&&(console.log(i.value.product.id),a.data.certify_invoice_products.findIndex(l=>l.product.id===i.value.product.id)===-1&&i.value.product.id!==-1&&a.data.certify_invoice_products.push({...i.value}),V())};F(i,()=>{_()});const q=o=>{const l=a.data.certify_invoice_products.findIndex(h=>h.product.id===o.product.id);a.data.certify_invoice_products.splice(l,1),V()},y=o=>`${o.name}  ${o.surname}`,_=o=>{U(),i.value={...w.value}};return(o,l)=>{const h=ee;return g(),D(j,null,{default:s(()=>[t(I,{class:"d-flex flex-wrap justify-space-between flex-column flex-sm-row"},{default:s(()=>[e("div",be,[e("div",he,[t(d(G),{nodes:d(H).app.logo,class:"me-3"},null,8,["nodes"]),e("h6",xe,c(d(r).name),1)]),e("p",Ve,c(d(r).address),1),e("p",ge,c(d(r).address2),1),e("p",we,c(d(r).phone1)+" , "+c(d(r).phone2),1)]),e("div",Se,[e("h6",Ie,[Ne,e("span",null,[t(N,{modelValue:a.data.id,"onUpdate:modelValue":l[0]||(l[0]=u=>a.data.id=u),disabled:"",prefix:"#",density:"compact",style:{width:"8.9rem"}},null,8,["modelValue"])])]),e("p",Ae,[ke,e("span",null,[t(h,{modelValue:a.data.date,"onUpdate:modelValue":l[1]||(l[1]=u=>a.data.date=u),density:"compact",placeholder:"YYYY-MM-DD",style:{width:"8.9rem"},config:{position:"auto right"}},null,8,["modelValue"])])])])]),_:1}),t(C),t(I,{class:"d-flex flex-wrap justify-space-between flex-column flex-sm-row"},{default:s(()=>[t(P,null,{default:s(()=>[t(f,{cols:"12",md:"7"},{default:s(()=>[e("div",Pe,[Te,t(d(B),{list:a.data.clients,modelValue:a.data.client,"onUpdate:modelValue":l[2]||(l[2]=u=>a.data.client=u),"option-value":"id","custom-text":y,hideSelectedOptions:!0,placeholder:"Select Client"},null,8,["list","modelValue"])]),Ce]),_:1}),t(f,{cols:"12",md:"5"},{default:s(()=>[e("div",De,[Ee,e("table",null,[e("tbody",null,[e("tr",null,[Ue,e("td",qe," FAJ/2023/"+c(a.data.id),1)]),e("tr",null,[$e,e("td",Re,c(a.data.payment_type),1)]),e("tr",null,[Fe,e("td",Le,c(a.data.client.name)+" "+c(a.data.client.surname),1)]),e("tr",null,[je,e("td",null,c(a.data.client.address),1)]),e("tr",null,[Oe,e("td",null,c(a.data.client.NRC),1)]),e("tr",null,[Ke,e("td",null,c(a.data.client.NIF),1)]),e("tr",null,[Be,e("td",null,c(a.data.client.NIS),1)]),e("tr",null,[Me,e("td",null,c(a.data.client.NART),1)])])])])]),_:1})]),_:1})]),_:1}),t(C),t(I,{class:"add-products-form"},{default:s(()=>[e("div",Ze,[t(P,null,{default:s(()=>[t(f,{cols:"12",md:"12"},{default:s(()=>[Qe,t(d(B),{list:a.data.products,modelValue:d(i),"onUpdate:modelValue":l[3]||(l[3]=u=>k(i)?i.value=u:i=u),"option-value":"id","custom-text":b,placeholder:"Select Product"},null,8,["list","modelValue"])]),_:1}),t(f,{cols:"12",md:"2"})]),_:1})]),Ye,(g(!0),L(M,null,J(a.data.certify_invoice_products,(u,Q)=>(g(),L("div",{key:Q,class:"ma-sm-4"},[t(ye,{id:u.id,data:u,onRemoveProduct:q,onTotalAmount:v},null,8,["id","data"])]))),128))]),_:1}),t(C),t(I,{class:"d-flex justify-space-between flex-wrap flex-column flex-sm-row"},{default:s(()=>[e("div",ze,[e("div",Ge,[He,t(N,{modelValue:a.data.salesperson,"onUpdate:modelValue":l[4]||(l[4]=u=>a.data.salesperson=u),style:{width:"10rem"}},null,8,["modelValue"])]),t(N,{modelValue:a.data.thanksNote,"onUpdate:modelValue":l[5]||(l[5]=u=>a.data.thanksNote=u),placeholder:"Thanks for your business"},null,8,["modelValue"])]),e("div",Je,[e("table",null,[e("tr",null,[We,e("td",Xe,[e("p",et,c(d(n).toFixed(2))+" DZD ",1),e("p",tt,c((d(n)*.19).toFixed(2))+" DZD ",1),e("p",at,c((d(n)*1.19).toFixed(2))+" DZD ",1)])])])])]),_:1}),t(C),t(I,{class:"mx-sm-4"},{default:s(()=>[st,t(oe,{modelValue:a.data.note,"onUpdate:modelValue":l[6]||(l[6]=u=>a.data.note=u),rows:2},null,8,["modelValue"])]),_:1})]),_:1})}}},lt={class:"d-flex align-center justify-space-between"},dt={class:"d-flex align-center justify-space-between"},nt={class:"d-flex align-center justify-space-between"},it={__name:"[id]",setup(T){const a=W(),m=X(),n=p({amount:0,fac_id:3,date:"2023-11-03",client_id:1,payment_type:"Espece",amount_letter:"",client:{id:-1,name:"",surname:"",address:"",email:"",phone:"",NRC:"",NIF:"",NART:"",NIS:""},certify_invoice_products:[{price:1,quantity:20,total:20,id:1,product:{name:"Sample Product",brand:"Sample Brand",description:"Product Description",product_code:"PROD123",category_id:1,SKU:"SKU123",min_stock_level:10,price:"1.00",stockable:0,tax_rate:"0.08",product_stock:{id:1,product_id:1,quantity:20}}}],clients:[],products:[]}),x=Z(),r=p({isActive:!1});x.fetchInvoice(Number(a.params.id)).then(y=>{r.isActive=!1,console.log("data"),n.value=y.data.invoice,n.value.clients=y.data.clients,n.value.products=y.data.products}).catch(y=>{r.isActive=!1,console.log(y)});const i=p(!1);p(!1);const w=p(!0),v=p(!1),b=p(!1),V=p(!1),U=["Espece","Cheque","Versement Bancaire"],q=()=>{n.value.client.id===-1||n.value.date===null||n.value.certify_invoice_products.length===0||n.value.payment_type===""?(n.client.id===-1&&A("Client Not Selected","Oops! Looks like you forgot to select a client for this invoice. Kindly pick at least one client to proceed"),n.date===null&&A("The date field is empty","Date field remains empty, and no client has been chosen for the invoice."),n.certify_invoice_products.length===0&&A("Select a least one product.","Kindly ensure you've selected at least one product before proceeding."),n.payment_type===""&&A("Choose a payment method.","Please select a payment method to complete your invoice.")):r.isActive||(r.isActive=!0,x.updateCertifyInvoice(n.value).then(y=>{r.isActive=!1,V.value=!0,te("Invoice updated Successfully"),m.push({name:"apps-certifyInvoice-preview-id",params:{id:n.value.id}})}).catch(y=>{r.isActive=!1,console.log(y),A("Error",""),console.log(y)}))};return(y,_)=>(g(),D(P,null,{default:s(()=>[t(le,{"model-value":d(r).isActive,class:"align-center justify-center"},{default:s(()=>[t(se,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),t(f,{cols:"12",md:"9"},{default:s(()=>[t(ot,{data:d(n)},null,8,["data"])]),_:1}),t(f,{cols:"12",md:"3"},{default:s(()=>[t(j,{class:"mb-8"},{default:s(()=>[t(I,null,{default:s(()=>[t(E,{block:"","prepend-icon":"tabler-send",class:"mb-2",onClick:_[0]||(_[0]=o=>i.value=!0)},{default:s(()=>[S(" Send Invoice ")]),_:1}),d(V)?(g(),D(E,{key:0,block:"",color:"secondary",variant:"tonal",class:"mb-2",to:{name:"apps-invoice-preview-id",params:{id:d(a).params.id}}},{default:s(()=>[S(" Preview ")]),_:1},8,["to"])):O("",!0),d(V)?O("",!0):(g(),D(E,{key:1,loading:d(r).isActive,disabled:d(r).isActive,block:"",color:"success",class:"mb-2",onClick:q},{default:s(()=>[S(" Save ")]),_:1},8,["loading","disabled"]))]),_:1})]),_:1}),t(de,{modelValue:d(n).payment_type,"onUpdate:modelValue":_[1]||(_[1]=o=>d(n).payment_type=o),items:U,label:"Accept Payment Via",class:"mb-6"},null,8,["modelValue"]),e("div",lt,[t($,{for:"payment-terms"},{default:s(()=>[S(" Payment Terms ")]),_:1}),e("div",null,[t(R,{id:"payment-terms",modelValue:d(w),"onUpdate:modelValue":_[2]||(_[2]=o=>k(w)?w.value=o:null)},null,8,["modelValue"])])]),e("div",dt,[t($,{for:"client-notes"},{default:s(()=>[S(" Client Notes ")]),_:1}),e("div",null,[t(R,{id:"client-notes",modelValue:d(v),"onUpdate:modelValue":_[3]||(_[3]=o=>k(v)?v.value=o:null)},null,8,["modelValue"])])]),e("div",nt,[t($,{for:"payment-stub"},{default:s(()=>[S(" Payment Stub ")]),_:1}),e("div",null,[t(R,{id:"payment-stub",modelValue:d(b),"onUpdate:modelValue":_[4]||(_[4]=o=>k(b)?b.value=o:null)},null,8,["modelValue"])])])]),_:1}),t(ae,{isDrawerOpen:d(i),"onUpdate:isDrawerOpen":_[5]||(_[5]=o=>k(i)?i.value=o:null)},null,8,["isDrawerOpen"])]),_:1}))}};typeof K=="function"&&K(it);export{it as default};
