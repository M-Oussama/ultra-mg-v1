import{bc as De,a1 as Y,k as i,r as fe,o as M,b as k,w as a,p as e,q as t,m as p,C as B,P as ie,D as h,be as re,E as T,y as q,ay as L,Z,$ as ne,A as be,c as le,F as xe,a as ye,x as P,O as Ae,H as Se,I as Ce,bf as pe}from"./main.81882816.js";import{P as O}from"./permissions.bafe5f34.js";import{r as I}from"./validators.330a354f.js";import{e as J}from"./errorsMiddleware.de9f333f.js";import{a as X}from"./VOverlay.ad02dd02.js";import{a as K,V as w}from"./VBtn.e04ef908.js";import{V as W}from"./VSpacer.08392e38.js";import{V as H,c as R}from"./VCard.138d8eaf.js";import{V as ue}from"./VForm.5347714b.js";import{V as ee,a as C}from"./VRow.b2b0e78f.js";import{V as de}from"./VTextField.6a8607d5.js";import{V as j}from"./VAutocomplete.38a54571.js";import{V as Q}from"./VInput.b9d918a3.js";import{V as ve}from"./VTextarea.f5d3adf2.js";import{V as ce}from"./VNavigationDrawer.b5f4e693.js";import{_ as he}from"./DialogCloseBtn.2eda3c42.js";import{V as Ne}from"./VDialog.651b93eb.js";import{s as se}from"./successMiddleware.3313c5ca.js";import{V as oe}from"./VDivider.85a3d826.js";import{V as we}from"./VSelect.613af58b.js";import{V as Ee}from"./VTable.5fcc397b.js";import{V as Te}from"./VTooltip.48b058cc.js";import{V as Ue}from"./VAvatar.637f2477.js";import{V as Me}from"./VPagination.3a3176e2.js";import"./index.b522f886.js";import"./router.8e94bdfa.js";import"./lazy.0d5428c0.js";import"./easing.36b781ab.js";import"./VImg.7b286adf.js";import"./position.10bb3fae.js";import"./forwardRefs.c003b6b8.js";/* empty css                   */import"./VField.5450c9bb.js";import"./index.f8b100c7.js";import"./VCounter.9c267138.js";import"./filter.9b77dbc8.js";import"./VList.79b77ee1.js";import"./VMenu.ef75d0b8.js";import"./scopeId.3d2bbd1b.js";import"./dialog-transition.40a0bedf.js";import"./VCheckboxBtn.cd78058c.js";import"./VSelectionControl.b76e699b.js";import"./VChip.e59b8b10.js";import"./ssrBoot.4a48a228.js";const te=De("useMaintenanceStore",{actions:{fetchData(N){return Y.get("/api/maintenances/list",{headers:{Authorization:localStorage.getItem("accessToken")}})},getComponents(N){return Y.get("/api/assets/"+N+"/components")},addMaintenance(N){return new Promise((V,g)=>{var{maintenance:D}=N,{name:S,component_id:f,asset_id:v,maintenance_date:n,next_maintenance_date:A,notes:s,technician_assigned_id:c,status:b}=D;Y.post("/api/maintenances/store",{name:S,component_id:f,asset_id:v,maintenance_date:n,next_maintenance_date:A,notes:s,technician_assigned_id:c,status:b},{headers:{Authorization:localStorage.getItem("accessToken")}}).then(y=>V(y)).catch(y=>g(y))})},updateComponent(N){return new Promise((V,g)=>{var{maintenance:D}=N,{id:S,name:f,component_id:v,asset_id:n,maintenance_date:A,next_maintenance_date:s,notes:c,technician_assigned_id:b,status:y}=D;Y.post("/api/maintenances/update/"+S,{name:f,component_id:v,asset_id:n,maintenance_date:A,next_maintenance_date:s,notes:c,technician_assigned_id:b,status:y},{headers:{Authorization:localStorage.getItem("accessToken")}}).then(E=>V(E)).catch(E=>g(E))})},deleteMaintenance(N){const{id:V}=N;return new Promise((g,D)=>{Y.delete("/api/maintenances/delete/"+V).then(S=>g(S)).catch(S=>D(S))})}}}),Oe={class:"d-flex align-center pa-6 pb-1"},ke=p("h6",{class:"text-h6"}," Add Maintenance ",-1),Ie={__name:"AddNewDrawer",props:{isDrawerOpen:{type:Boolean,required:!0},assets:{type:Array,required:!0},users:{type:Array,required:!0}},emits:["update:isDrawerOpen","userData"],setup(N,{emit:V}){const g=N,D=te(),S=i(!1),f=i();i("");const v=i(["Started","Active","Done"]),n=i({name:"",asset_id:"",component_id:"",maintenance_date:"",next_maintenance_date:"",notes:"",status:"",technician_assigned_id:null});i();const A=i([]),s=i({isActive:!1}),c=()=>{V("update:isDrawerOpen",!1),L(()=>{var d,l;(d=f.value)==null||d.reset(),(l=f.value)==null||l.resetValidation()})};function b(d,l){if(d===""||l==="")return!0;d=new Date(d),l=new Date(l);const U=d.toISOString().split("T")[0],x=l.toISOString().split("T")[0];return U>=x}const y=d=>{if(d!=null&&d!==""){console.log(d);let l=new Date(d),U=l.getFullYear(),x=String(l.getMonth()+1).padStart(2,"0"),ae=String(l.getDate()).padStart(2,"0");return`${U}-${x}-${ae}`}return d},E=()=>{var d;console.log(n.value.maintenance_date),console.log(n.value.next_maintenance_date),n.value.maintenance_date===""||n.value.next_maintenance_date===""?(n.value.next_maintenance_date===""&&J("Enter The Maintenance Date"),n.value.next_maintenance_date===""&&J("Enter The Next Maintenance Date")):(console.log("else"),n.value.maintenance_date=y(n.value.maintenance_date),n.value.next_maintenance_date=y(n.value.next_maintenance_date),(d=f.value)==null||d.validate().then(({valid:l})=>{l&&(V("objectData",{maintenance:n.value}),V("update:isDrawerOpen",!1),L(()=>{var U,x;(U=f.value)==null||U.reset(),(x=f.value)==null||x.resetValidation()}))}))},F=d=>{V("update:isDrawerOpen",d)};function $(d){return parseInt(d)<10?"0"+d:d}const z=d=>{const l=d.getDate(),U=d.getMonth()+1;return`${d.getFullYear()}-${$(U)}-${$(l)}`},m=()=>{(n.value.maintenance_date===""||b(n.value.maintenance_date,n.value.next_maintenance_date)&&n.value.next_maintenance_date!=="")&&(n.value.next_maintenance_date=""),n.value.next_maintenance_date_restrict=new Date(new Date(n.value.maintenance_date).getTime()+24*60*60*1e3).toISOString().split("T")[0]},u=d=>{s.value.isActive=!0,D.getComponents(d).then(l=>{A.value=l.data.components,s.value.isActive=!1}).catch(l=>{console.error(l),s.value.isActive=!1})};return(d,l)=>{const U=fe("VueDatePicker");return M(),k(ce,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":g.isDrawerOpen,"onUpdate:modelValue":F},{default:a(()=>[e(X,{"model-value":t(s).isActive,class:"align-center justify-center"},{default:a(()=>[e(K,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),p("div",Oe,[ke,e(W),e(w,{variant:"tonal",color:"default",icon:"",size:"32",class:"rounded",onClick:c},{default:a(()=>[e(B,{size:"18",icon:"tabler-x"})]),_:1})]),e(t(ie),{options:{wheelPropagation:!1}},{default:a(()=>[e(H,{flat:""},{default:a(()=>[e(R,null,{default:a(()=>[e(ue,{ref_key:"refForm",ref:f,modelValue:t(S),"onUpdate:modelValue":l[8]||(l[8]=x=>h(S)?S.value=x:null),onSubmit:re(E,["prevent"])},{default:a(()=>[e(ee,null,{default:a(()=>[e(C,{cols:"12"},{default:a(()=>[e(de,{modelValue:t(n).name,"onUpdate:modelValue":l[0]||(l[0]=x=>t(n).name=x),rules:[t(I)],label:"Name"},null,8,["modelValue","rules"])]),_:1}),e(C,{cols:"12"},{default:a(()=>[e(j,{clearable:"",modelValue:t(n).asset_id,"onUpdate:modelValue":[l[1]||(l[1]=x=>t(n).asset_id=x),u],items:g.assets,"item-value":"id","item-title":"name",label:"Asset",placeholder:"Asset",rules:[t(I)]},null,8,["modelValue","items","rules"])]),_:1}),e(C,{cols:"12"},{default:a(()=>[e(j,{clearable:"",modelValue:t(n).component_id,"onUpdate:modelValue":l[2]||(l[2]=x=>t(n).component_id=x),items:t(A),"item-value":"id","item-title":"name",label:"Component",placeholder:"Component",rules:[t(I)]},null,8,["modelValue","items","rules"])]),_:1}),e(C,{cols:"12"},{default:a(()=>[e(Q,null,{default:a(()=>[T(" Maintenance date ")]),_:1}),e(U,{modelValue:t(n).maintenance_date,"onUpdate:modelValue":[l[3]||(l[3]=x=>t(n).maintenance_date=x),m],"auto-apply":"",format:z,"min-date":new Date,required:""},null,8,["modelValue","min-date"])]),_:1}),e(C,{cols:"12"},{default:a(()=>[e(Q,null,{default:a(()=>[T(" Next Maintenance date ")]),_:1}),e(U,{modelValue:t(n).next_maintenance_date,"onUpdate:modelValue":l[4]||(l[4]=x=>t(n).next_maintenance_date=x),"auto-apply":"",format:z,"min-date":t(n).next_maintenance_date_restrict,required:""},null,8,["modelValue","min-date"])]),_:1}),e(C,{cols:"12"},{default:a(()=>[e(ve,{modelValue:t(n).notes,"onUpdate:modelValue":l[5]||(l[5]=x=>t(n).notes=x),label:"Notes"},null,8,["modelValue"])]),_:1}),d.$can(t(O).MAINTENANCE.ASSIGN,t(O).MAINTENANCE.SUBJECT)?(M(),k(C,{key:0,cols:"12"},{default:a(()=>[e(j,{clearable:"",modelValue:t(n).technician_assigned_id,"onUpdate:modelValue":l[6]||(l[6]=x=>t(n).technician_assigned_id=x),items:g.users,"item-value":"id","item-title":"name",label:"Technician",placeholder:"Technician",rules:[t(I)]},null,8,["modelValue","items","rules"])]),_:1})):q("",!0),e(C,{cols:"12"},{default:a(()=>[e(j,{clearable:"",modelValue:t(n).status,"onUpdate:modelValue":l[7]||(l[7]=x=>t(n).status=x),items:t(v),"item-value":"id","item-title":"name",label:"Status",placeholder:"Status",rules:[t(I)]},null,8,["modelValue","items","rules"])]),_:1}),e(C,{cols:"12"},{default:a(()=>[e(w,{type:"submit",class:"me-3"},{default:a(()=>[T(" Submit ")]),_:1}),e(w,{type:"reset",variant:"tonal",color:"secondary",onClick:c},{default:a(()=>[T(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},$e={class:"d-flex align-center pa-6 pb-1"},ze=p("h6",{class:"text-h6"}," Edit Component ",-1),Pe={__name:"EditDrawer",props:{isDrawerOpen:{type:Boolean,required:!0},assets:{type:Array},maintenance:{type:Object},users:{type:Array,required:!0}},emits:["update:isDrawerOpen","objectData"],setup(N,{emit:V}){const g=N,D=i({isActive:!1}),S=te();i(),Z(()=>g.maintenance,m=>{m&&(console.log(m),s.value.id=m.id||0,s.value.name=m.name||"",s.value.asset_id=m.component.asset_id||"",s.value.component_id=m.component_id||"",s.value.maintenance_date=m.maintenance_date||"",s.value.next_maintenance_date=m.next_maintenance_date||"",s.value.notes=m.notes||"",s.value.status=m.status||"",s.value.technician_assigned_id=m.technician_assigned_id||null,y(s.value.asset_id),F())});const f=i(["Started","Active","Done"]),v=i([]),n=i(!1),A=i();i(),i(""),i([]);const s=i({id:"",name:"",asset_id:"",component_id:"",maintenance_date:"",next_maintenance_date:"",notes:"",status:"",technician_assigned_id:null});i(),i(!1);const c=()=>{V("update:isDrawerOpen",!1),L(()=>{var m,u;(m=A.value)==null||m.reset(),(u=A.value)==null||u.resetValidation()})};Z(s.value.maintenance_date,function(){F()});const b=()=>{var m;s.value.maintenance_date===""||s.value.next_maintenance_date===""?(s.value.next_maintenance_date===""&&J("Enter The Maintenance Date"),s.value.next_maintenance_date===""&&J("Enter The Next Maintenance Date")):(m=A.value)==null||m.validate().then(({valid:u})=>{u&&(V("objectData",{maintenance:s.value}),V("update:isDrawerOpen",!1),L(()=>{var d,l;(d=A.value)==null||d.reset(),(l=A.value)==null||l.resetValidation()}))})},y=m=>{D.value.isActive=!0,S.getComponents(m).then(u=>{v.value=u.data.components,D.value.isActive=!1}).catch(u=>{console.error(u),D.value.isActive=!1})};function E(m,u){if(m===""||u==="")return!0;m=new Date(m),u=new Date(u);const d=m.toISOString().split("T")[0],l=u.toISOString().split("T")[0];return d>=l}const F=()=>{(s.value.maintenance_date===""||E(s.value.maintenance_date,s.value.next_maintenance_date)&&s.value.next_maintenance_date!=="")&&(s.value.next_maintenance_date=""),s.value.next_maintenance_date_restrict=new Date(new Date(s.value.maintenance_date).getTime()+24*60*60*1e3).toISOString().split("T")[0]},$=m=>{const u=m.getDate(),d=m.getMonth()+1;return`${m.getFullYear()}-${z(d)}-${z(u)}`};function z(m){return parseInt(m)<10?"0"+m:m}return(m,u)=>{const d=fe("VueDatePicker");return M(),k(ce,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":g.isDrawerOpen},{default:a(()=>[e(X,{"model-value":t(D).isActive,class:"align-center justify-center"},{default:a(()=>[e(K,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),p("div",$e,[ze,e(W),e(w,{variant:"tonal",color:"default",icon:"",size:"32",class:"rounded",onClick:c},{default:a(()=>[e(B,{size:"18",icon:"tabler-x"})]),_:1})]),e(t(ie),{options:{wheelPropagation:!1}},{default:a(()=>[e(H,{flat:""},{default:a(()=>[e(R,null,{default:a(()=>[e(ue,{ref_key:"refForm",ref:A,modelValue:t(n),"onUpdate:modelValue":u[8]||(u[8]=l=>h(n)?n.value=l:null),onSubmit:re(b,["prevent"])},{default:a(()=>[e(ee,null,{default:a(()=>[e(C,{cols:"12"},{default:a(()=>[e(de,{modelValue:t(s).name,"onUpdate:modelValue":u[0]||(u[0]=l=>t(s).name=l),rules:[t(I)],label:"Name"},null,8,["modelValue","rules"])]),_:1}),e(C,{cols:"12"},{default:a(()=>[e(j,{clearable:"",modelValue:t(s).asset_id,"onUpdate:modelValue":[u[1]||(u[1]=l=>t(s).asset_id=l),y],items:g.assets,"item-value":"id","item-title":"name",label:"Asset",placeholder:"Asset",rules:[t(I)]},null,8,["modelValue","items","rules"])]),_:1}),e(C,{cols:"12"},{default:a(()=>[e(j,{clearable:"",modelValue:t(s).component_id,"onUpdate:modelValue":u[2]||(u[2]=l=>t(s).component_id=l),items:t(v),"item-value":"id","item-title":"name",label:"Component",placeholder:"Component",rules:[t(I)]},null,8,["modelValue","items","rules"])]),_:1}),e(C,{cols:"12"},{default:a(()=>[e(Q,null,{default:a(()=>[T(" Maintenance date ")]),_:1}),e(d,{modelValue:t(s).maintenance_date,"onUpdate:modelValue":[u[3]||(u[3]=l=>t(s).maintenance_date=l),F],"auto-apply":"",format:$,"min-date":new Date},null,8,["modelValue","min-date"])]),_:1}),e(C,{cols:"12"},{default:a(()=>[e(Q,null,{default:a(()=>[T(" Next Maintenance date ")]),_:1}),e(d,{modelValue:t(s).next_maintenance_date,"onUpdate:modelValue":u[4]||(u[4]=l=>t(s).next_maintenance_date=l),"auto-apply":"",format:$,"min-date":t(s).next_maintenance_date_restrict},null,8,["modelValue","min-date"])]),_:1}),e(C,{cols:"12"},{default:a(()=>[e(ve,{modelValue:t(s).notes,"onUpdate:modelValue":u[5]||(u[5]=l=>t(s).notes=l),label:"Notes"},null,8,["modelValue"])]),_:1}),m.$can(t(O).MAINTENANCE.ASSIGN,t(O).MAINTENANCE.SUBJECT)?(M(),k(C,{key:0,cols:"12"},{default:a(()=>[e(j,{clearable:"",modelValue:t(s).technician_assigned_id,"onUpdate:modelValue":u[6]||(u[6]=l=>t(s).technician_assigned_id=l),items:g.users,"item-value":"id","item-title":"name",label:"Technician",placeholder:"Technician",rules:[t(I)]},null,8,["modelValue","items","rules"])]),_:1})):q("",!0),e(C,{cols:"12"},{default:a(()=>[e(j,{clearable:"",modelValue:t(s).status,"onUpdate:modelValue":u[7]||(u[7]=l=>t(s).status=l),items:t(f),"item-value":"id","item-title":"name",label:"Status",placeholder:"Status",rules:[t(I)]},null,8,["modelValue","items","rules"])]),_:1}),e(C,{cols:"12"},{default:a(()=>[e(w,{type:"submit",class:"me-3"},{default:a(()=>[T(" Submit ")]),_:1}),e(w,{type:"reset",variant:"tonal",color:"secondary",onClick:c},{default:a(()=>[T(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},je={__name:"ConfirmationDialog",props:{isDialogVisible:{type:Boolean,required:!0},maintenance:{type:Object,required:!0}},emits:["update:isDrawerOpen","objectData"],setup(N,{emit:V}){const g=N,D=i(),S=()=>{V("update:isDialogVisible",!1)};Z(()=>g.maintenance,v=>{v&&(D.value=v.id||0)});const f=()=>{V("objectData",{id:g.maintenance.id}),V("update:isDialogVisible",!1)};return(v,n)=>{const A=he;return M(),k(Ne,{modelValue:g.isDialogVisible,"onUpdate:modelValue":n[2]||(n[2]=s=>g.isDialogVisible=s),persistent:"",class:"v-dialog-sm"},{default:a(()=>[e(A,{onClick:n[0]||(n[0]=s=>S())}),e(H,{title:"Confirmation"},{default:a(()=>[e(R,null,{default:a(()=>[T(" Are you sure you want to delete this maintenance ? ")]),_:1}),e(R,{class:"d-flex justify-end gap-3 flex-wrap"},{default:a(()=>[e(w,{color:"secondary",variant:"tonal",onClick:n[1]||(n[1]=s=>V("update:isDialogVisible",!1))},{default:a(()=>[T(" Disagree ")]),_:1}),e(w,{onClick:f},{default:a(()=>[T(" Agree ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},Fe={class:"d-flex align-center pa-6 pb-1"},Be=p("h6",{class:"text-h6"}," Edit Component ",-1),qe={__name:"EditStatusDrawer",props:{isDrawerOpen:{type:Boolean,required:!0},assets:{type:Array},maintenance:{type:Object}},emits:["update:isDrawerOpen","objectData"],setup(N,{emit:V}){const g=N,D=i({isActive:!1});te(),i(),Z(()=>g.maintenance,c=>{c&&(console.log(c),v.value.id=c.id||0,v.value.name=c.name||"",v.value.asset_id=c.component.asset_id||"",v.value.component_id=c.component_id||"",v.value.maintenance_date=c.maintenance_date||"",v.value.next_maintenance_date=c.next_maintenance_date||"",v.value.notes=c.notes||"",v.value.status=c.status||"")}),i([]);const S=i(!1),f=i();i(),i(""),i([]);const v=i({id:"",name:"",component_id:"",maintenance_date:"",next_maintenance_date:"",notes:"",status:""});i(),i(!1);const n=()=>{V("update:isDrawerOpen",!1),L(()=>{var c,b;(c=f.value)==null||c.reset(),(b=f.value)==null||b.resetValidation()})},A=()=>{var c;(c=f.value)==null||c.validate().then(({valid:b})=>{b&&(V("objectData",{maintenance:v.value}),V("update:isDrawerOpen",!1),L(()=>{var y,E;(y=f.value)==null||y.reset(),(E=f.value)==null||E.resetValidation()}))})},s=i(["Started","Active","Done"]);return(c,b)=>(M(),k(ce,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":g.isDrawerOpen},{default:a(()=>[e(X,{"model-value":t(D).isActive,class:"align-center justify-center"},{default:a(()=>[e(K,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),p("div",Fe,[Be,e(W),e(w,{variant:"tonal",color:"default",icon:"",size:"32",class:"rounded",onClick:n},{default:a(()=>[e(B,{size:"18",icon:"tabler-x"})]),_:1})]),e(t(ie),{options:{wheelPropagation:!1}},{default:a(()=>[e(H,{flat:""},{default:a(()=>[e(R,null,{default:a(()=>[e(ue,{ref_key:"refForm",ref:f,modelValue:t(S),"onUpdate:modelValue":b[1]||(b[1]=y=>h(S)?S.value=y:null),onSubmit:re(A,["prevent"])},{default:a(()=>[e(ee,null,{default:a(()=>[e(C,{cols:"12"},{default:a(()=>[e(j,{clearable:"",modelValue:t(v).status,"onUpdate:modelValue":b[0]||(b[0]=y=>t(v).status=y),items:t(s),"item-value":"id","item-title":"name",label:"Status",placeholder:"Status",rules:[t(I)]},null,8,["modelValue","items","rules"])]),_:1}),e(C,{cols:"12"},{default:a(()=>[e(w,{type:"submit",class:"me-3"},{default:a(()=>[T(" Submit ")]),_:1}),e(w,{type:"reset",variant:"tonal",color:"secondary",onClick:n},{default:a(()=>[T(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"]))}};const Je={class:"me-3"},Re={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Ge={style:{width:"6rem"}},Le=p("thead",null,[p("tr",null,[p("th",{scope:"col"}," ID "),p("th",{scope:"col"}," Maintenance "),p("th",{scope:"col"}," LAST MAINTENANCE "),p("th",{scope:"col"}," NEXT MAINTENANCE "),p("th",{scope:"col"}," REST "),p("th",{scope:"col"}," CREATOR "),p("th",{scope:"col"}," ASSIGNED "),p("th",{scope:"col"}," ACTIONS ")])],-1),Ye={class:"d-flex align-center"},Ze={class:"mb-0"},He={class:"d-flex flex-column ml-5"},Qe={class:"text-base font-weight-medium mb-0"},Xe={class:"text-disabled text-sm"},Ke={class:"text-center",style:{width:"5rem"}},We=p("tr",null,[p("td",{colspan:"7",class:"text-center"}," No data available ")],-1),et=[We],tt={class:"text-sm text-disabled"},at={__name:"index",setup(N){const V=te(),g=i(""),D=i({isActive:!1}),S=i(!0),f=i();i(),i();const v=i(10),n=i(1),A=i(1),s=i(0);let c=i([]),b=i([]),y=i([]);const E=()=>{D.value.isActive=!0,V.fetchData({searchValue:g.value,perPage:v.value,currentPage:n.value}).then(_=>{y.value=_.data.maintenances,c.value=_.data.assets,b.value=_.data.users,D.value.isActive=!1}).catch(_=>{console.error(_),D.value.isActive=!1})};ne(E),ne(()=>{n.value>A.value&&(n.value=A.value)}),Z(g,()=>{E()});const F=_=>(console.log(_),_.status==="Started"?{color:"info",icon:"tabler-pencil"}:_.status==="Active"?{color:"primary",icon:"tabler-chart-pie-2"}:_.status==="Done"?{color:"success",icon:"tabler-check"}:{color:"primary",icon:"tabler-user"}),$=i(!1),z=i(!1),m=i(!1),u=i(!1);i(),ne(()=>{n.value>A.value&&(n.value=A.value)});const d=be(()=>{const _=y.value.length?(n.value-1)*v.value+1:0,r=y.value.length+(n.value-1)*v.value;return`Showing ${_} to ${r} of ${s.value} entries`}),l=_=>{D.value.isActive=!0,V.addMaintenance(_).then(r=>{D.value.isActive=!1,E(),se(r.data.message)}).catch(r=>{J(r.response.data.message),D.value.isActive=!1})},U=_=>{V.updateComponent(_).then(r=>{D.value.isActive=!1,E(),se(r.data.message)}).catch(r=>{J(r.response.data.message),D.value.isActive=!1})},x=_=>{V.deleteMaintenance(_).then(r=>{D.value.isActive=!1,E(),se(r.data.message)}).catch(r=>{J(r.response.data.message),D.value.isActive=!1})},ae=_=>{z.value=!0,f.value=_},_e=_=>{m.value=!0,f.value=_},Ve=_=>{u.value=!0,f.value=_},ge=_=>{const r=new Date,G=new Date(_).getTime()-r.getTime(),me=Math.ceil(G/(1e3*3600*24));return me>=0?me:0};return(_,r)=>(M(),le("section",null,[e(ee,null,{default:a(()=>[e(X,{"model-value":t(D).isActive,class:"align-center justify-center"},{default:a(()=>[e(K,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),e(C,{cols:"12"},{default:a(()=>[e(H,{title:"Maintenances"},{default:a(()=>[e(oe),e(R,{class:"d-flex flex-wrap py-4 gap-4"},{default:a(()=>[p("div",Je,[e(we,{modelValue:t(v),"onUpdate:modelValue":r[0]||(r[0]=o=>h(v)?v.value=o:null),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"])]),e(W),p("div",Re,[p("div",Ge,[e(de,{onInput:r[1]||(r[1]=o=>S.value=!0),ref:"searchField",modelValue:t(g),"onUpdate:modelValue":r[2]||(r[2]=o=>h(g)?g.value=o:null),placeholder:"Search",density:"compact"},null,8,["modelValue"])]),e(w,{variant:"tonal",color:"secondary","prepend-icon":"tabler-screen-share"},{default:a(()=>[T(" Export ")]),_:1}),_.$can(t(O).MAINTENANCE.ADD,t(O).MAINTENANCE.SUBJECT)?(M(),k(w,{key:0,"prepend-icon":"tabler-plus",onClick:r[3]||(r[3]=o=>$.value=!0)},{default:a(()=>[T(" Add Maintenance ")]),_:1})):q("",!0)])]),_:1}),e(oe),e(Ee,{class:"text-no-wrap"},{default:a(()=>[Le,p("tbody",null,[(M(!0),le(xe,null,ye(t(y),o=>(M(),le("tr",{key:o.id,style:{height:"3.75rem"}},[p("td",null,P(o.id),1),p("td",null,[p("div",Ye,[e(Te,null,{activator:a(({props:G})=>[e(Ue,Ae({size:30},G,{color:F(o).color,variant:"tonal"}),{default:a(()=>[e(B,{size:20,icon:F(o).icon},null,8,["icon"])]),_:2},1040,["color"])]),default:a(()=>[p("p",Ze," Status : "+P(o.status),1)]),_:2},1024),p("div",He,[p("h6",Qe,P(o.name),1),p("span",Xe," @"+P(o.technician?o.technician.name:""),1)])])]),p("td",null,P(o.maintenance_date),1),p("td",null,P(o.next_maintenance_date),1),p("td",null,P(ge(o.next_maintenance_date)),1),p("td",null,P(o.technician?o.technician.name:""),1),p("td",null,P(o.assigned?o.assigned.name:""),1),p("td",Ke,[_.$can(t(O).MAINTENANCE.EDIT,t(O).MAINTENANCE.SUBJECT)?(M(),k(w,{key:0,icon:"",size:"x-small",color:"default",variant:"text",onClick:G=>_e(o)},{default:a(()=>[e(B,{size:"22",icon:"tabler-trending-up"})]),_:2},1032,["onClick"])):q("",!0),_.$can(t(O).MAINTENANCE.EDIT,t(O).MAINTENANCE.SUBJECT)?(M(),k(w,{key:1,icon:"",size:"x-small",color:"default",variant:"text",onClick:G=>ae(o)},{default:a(()=>[e(B,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"])):q("",!0),_.$can(t(O).MAINTENANCE.DELETE,t(O).MAINTENANCE.SUBJECT)?(M(),k(w,{key:2,icon:"",size:"x-small",color:"default",variant:"text",onClick:G=>Ve(o)},{default:a(()=>[e(B,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"])):q("",!0),e(w,{icon:"",size:"x-small",color:"default",variant:"text"},{default:a(()=>[e(B,{size:"22",icon:"tabler-dots-vertical"})]),_:1})])]))),128))]),Se(p("tfoot",null,et,512),[[Ce,!t(y).length]])]),_:1}),e(oe),e(R,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3 px-5"},{default:a(()=>[p("span",tt,P(t(d)),1),e(Me,{modelValue:t(n),"onUpdate:modelValue":r[4]||(r[4]=o=>h(n)?n.value=o:null),size:"small","total-visible":5,length:t(A)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Ie,{isDrawerOpen:t($),"onUpdate:isDrawerOpen":r[5]||(r[5]=o=>h($)?$.value=o:null),assets:t(c),"onUpdate:assets":r[6]||(r[6]=o=>h(c)?c.value=o:c=o),onObjectData:l,users:t(b),"onUpdate:users":r[7]||(r[7]=o=>h(b)?b.value=o:b=o)},null,8,["isDrawerOpen","assets","users"]),e(Pe,{isDrawerOpen:t(z),"onUpdate:isDrawerOpen":r[8]||(r[8]=o=>h(z)?z.value=o:null),maintenance:t(f),"onUpdate:maintenance":r[9]||(r[9]=o=>h(f)?f.value=o:null),assets:t(c),"onUpdate:assets":r[10]||(r[10]=o=>h(c)?c.value=o:c=o),users:t(b),"onUpdate:users":r[11]||(r[11]=o=>h(b)?b.value=o:b=o),onObjectData:U},null,8,["isDrawerOpen","maintenance","assets","users"]),e(qe,{isDrawerOpen:t(m),"onUpdate:isDrawerOpen":r[12]||(r[12]=o=>h(m)?m.value=o:null),maintenance:t(f),"onUpdate:maintenance":r[13]||(r[13]=o=>h(f)?f.value=o:null),assets:t(c),"onUpdate:assets":r[14]||(r[14]=o=>h(c)?c.value=o:c=o),onObjectData:U},null,8,["isDrawerOpen","maintenance","assets"]),t(u)?(M(),k(je,{key:0,isDialogVisible:t(u),"onUpdate:isDialogVisible":r[15]||(r[15]=o=>h(u)?u.value=o:null),maintenance:t(f),"onUpdate:maintenance":r[16]||(r[16]=o=>h(f)?f.value=o:null),onObjectData:x},null,8,["isDialogVisible","maintenance"])):q("",!0)]))}};typeof pe=="function"&&pe(at);export{at as default};
