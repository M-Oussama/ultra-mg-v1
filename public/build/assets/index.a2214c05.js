import{k as r,$ as j,Z as dt,A as ut,r as ct,o as i,c as h,p as a,w as s,q as n,m as e,D as m,b as v,E as P,y as R,F as I,a as $,x as d,C as k,H as pt,I as mt,bf as Q}from"./main.ccc6aae0.js";import{_ as ft}from"./DialogCloseBtn.eb9ea561.js";import{u as vt,_ as _t,a as ht,b as xt,c as gt}from"./ClientMonthlyReport.e6193b6f.js";import{P as T}from"./permissions.bafe5f34.js";import"./jspdf.es.min.8586d4e4.js";import"./jspdf.plugin.autotable.e7ed5c09.js";import{a as Vt}from"./VOverlay.0ad0cca7.js";import{a as Z,V as x}from"./VBtn.7efa8e0f.js";import{a as M,V as G}from"./VRow.a17ab33e.js";import{V as K,c as F}from"./VCard.36c7adfd.js";import{V as B}from"./VDivider.09896c6c.js";import{V as bt}from"./VSelect.b041d3dc.js";import{V as Ct}from"./VSpacer.fc3a499d.js";import{V as wt}from"./VTextField.8db2e7e8.js";import{V as W}from"./VTable.484ee967.js";import{V as yt}from"./VAvatar.cb7dc9a5.js";import{V as kt}from"./VImg.e193e870.js";import{V as Dt}from"./VPagination.ced5ec2a.js";import{V as At,a as Lt}from"./VTabs.d4bdf2de.js";import{V as Tt,a as O}from"./VWindowItem.38e58b77.js";import{V as Et}from"./VDialog.11663ea2.js";import"./validators.330a354f.js";import"./index.b522f886.js";import"./VForm.8ba2a0de.js";import"./VInput.1586f7cc.js";import"./router.25b57325.js";import"./index.720d3b34.js";import"./forwardRefs.c003b6b8.js";import"./VAutocomplete.5bdf49b5.js";import"./filter.7282d4f9.js";import"./VList.54d6dfac.js";import"./VMenu.01138ff3.js";import"./scopeId.1409e92e.js";import"./dialog-transition.e2b69798.js";import"./easing.36b781ab.js";import"./VCheckboxBtn.cfb39e43.js";import"./VSelectionControl.e824dbee.js";import"./VChip.768b9a43.js";import"./VNavigationDrawer.df836fef.js";import"./ssrBoot.81f110ad.js";import"./vue3-apexcharts.common.bed8535d.js";import"./vue.runtime.esm-bundler.7cda98a8.js";import"./lazy.ab6dcefa.js";import"./position.ea536dab.js";/* empty css                   */import"./VField.8b77e1e2.js";import"./VCounter.d2fed1b1.js";import"./VSlideGroup.b3deddf0.js";const Ut={class:"me-3",style:{width:"80px"}},zt={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Pt={style:{width:"9rem"}},It=e("thead",null,[e("tr",null,[e("th",{scope:"col"}," ID "),e("th",{scope:"col"}," Client "),e("th",{scope:"col"}," City "),e("th",{scope:"col"}," Phone "),e("th",{scope:"col"}," Balance "),e("th",{scope:"col"}," ACTIONS ")])],-1),$t={class:"d-flex align-center"},St={key:1},Nt={class:"d-flex flex-column"},Rt={class:"text-base"},Bt={class:"text-sm text-disabled"},Ot={class:"text-capitalize text-base font-weight-semibold"},jt={class:"text-capitalize text-base font-weight-semibold"},Ft={class:"text-capitalize text-base font-weight-semibold"},Wt={class:"text-center",style:{width:"5rem"}},Jt=e("tr",null,[e("td",{colspan:"7",class:"text-center"}," No data available ")],-1),qt=[Jt],Ht={class:"text-sm text-disabled"},Qt=e("thead",null,[e("tr",null,[e("th",{class:"text-caption"}," Product "),e("th",{class:"text-caption"}," Date "),e("th",{class:"text-caption"}," Quantity "),e("th",{class:"text-caption"}," Price "),e("th",{class:"text-caption"}," Total ")])],-1),Zt={class:"text-caption"},Mt={class:"text-caption"},Gt={class:"text-caption"},Kt={class:"text-caption"},Xt={class:"text-caption"},Yt=e("td",null,null,-1),te=e("td",null,null,-1),ee=e("td",null,null,-1),le=e("td",{class:"text-caption"}," Total ",-1),ae={class:"text-caption"},oe=e("td",null,null,-1),se=e("td",null,null,-1),ne=e("td",null,null,-1),ie=e("td",{class:"text-caption"}," Payment ",-1),re={class:"text-caption"},de=e("td",null,null,-1),ue=e("td",null,null,-1),ce=e("td",null,null,-1),pe=e("td",{class:"text-caption"}," Rest ",-1),me={class:"text-caption"},fe=e("thead",null,[e("tr",null,[e("th",null," Date "),e("th",null," Amount ")])],-1),ve={__name:"index",setup(_e){const b=vt(),E=r(""),J=r(!1),X=r(!0),C=r(!1);r(),r(),r();const D=r(10),_=r(1),A=r(1),q=r(0),w=r([]);let L=r([]),Y=r([]),V=r("Appetizers"),u=r({isActive:!1});const g=[{id:1,name:"Home"},{id:2,name:"Record"},{id:3,name:"Payments"},{id:4,name:"State"}],U=()=>{u.value.isActive=!0,b.fetchClients({searchValue:E.value,perPage:D.value,currentPage:_.value}).then(o=>{u.value.isActive=!1,L.value=o.data.clients.data,console.log(o.data.clientsAll),Y.value=o.data.clientsAll,console.log(L.value),A.value=o.data.totalPage,w.value=o.data.cities,q.value=o.data.totalClients,J.value=!1}).catch(o=>{console.error(o),u.value.isActive=!1})};j(U),j(()=>{_.value>A.value&&(_.value=A.value)}),dt(E,()=>{U()});const S=r(!1),N=r(!1),z=r(!1);let c=r();j(()=>{_.value>A.value&&(_.value=A.value)});const tt=ut(()=>{const o=L.value.length?(_.value-1)*D.value+1:0,l=L.value.length+(_.value-1)*D.value;return`Showing ${o} to ${l} of ${q.value} entries`}),et=o=>{b.addClient(o).then(l=>{U()}).catch(l=>{console.log(l)})},lt=o=>{b.updateClient(o).then(l=>{U()}).catch(l=>{console.log(l)})},at=o=>{b.deleteClient(o).then(l=>{U()}).catch(l=>{console.log(l)})},ot=o=>{N.value=!0,c=o},st=o=>{z.value=!0,c=o},nt=o=>{C.value=!0,c=o},H=o=>{var l=o.id;u.value.isActive=!0,b.getLogList(l).then(p=>{u.value.isActive=!1;const y=window.URL.createObjectURL(new Blob([p.data])),t=document.createElement("a");t.href=y,t.setAttribute("download","ETAT "+o.name+".pdf"),document.body.appendChild(t),t.click()}).catch(p=>{console.error(p),u.value.isActive=!1})},it=o=>{var l=o.id;u.value.isActive=!0,b.getLogListWithReturn(l).then(p=>{u.value.isActive=!1;const y=window.URL.createObjectURL(new Blob([p.data])),t=document.createElement("a");t.href=y,t.setAttribute("download","ETAT "+o.name+".pdf"),document.body.appendChild(t),t.click()}).catch(p=>{console.error(p),u.value.isActive=!1})},rt=o=>{var l=o.id;u.value.isActive=!0,b.getProductLog(l).then(p=>{u.value.isActive=!1;const y=window.URL.createObjectURL(new Blob([p.data])),t=document.createElement("a");t.href=y,t.setAttribute("download","Product Log "+o.name+".pdf"),document.body.appendChild(t),t.click()}).catch(p=>{console.error(p),u.value.isActive=!1})};return(o,l)=>{const p=ct("RouterLink"),y=ft;return i(),h("section",null,[a(G,null,{default:s(()=>[a(Vt,{"model-value":n(u).isActive,class:"align-center justify-center"},{default:s(()=>[a(Z,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),a(M,{cols:"12"},{default:s(()=>[a(K,{title:"Clients"},{default:s(()=>[a(B),a(F,{class:"d-flex flex-wrap py-4 gap-4"},{default:s(()=>[e("div",Ut,[a(bt,{modelValue:n(D),"onUpdate:modelValue":l[0]||(l[0]=t=>m(D)?D.value=t:null),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"])]),a(Ct),e("div",zt,[e("div",Pt,[n(J)?(i(),v(Z,{key:0,indeterminate:"",color:"primary"})):(i(),v(wt,{key:1,onInput:l[1]||(l[1]=t=>X.value=!0),ref:"searchField",modelValue:n(E),"onUpdate:modelValue":l[2]||(l[2]=t=>m(E)?E.value=t:null),placeholder:"Search",density:"compact"},null,8,["modelValue"]))]),a(x,{variant:"tonal",color:"secondary","prepend-icon":"tabler-screen-share",onClick:H},{default:s(()=>[P(" Export ")]),_:1}),o.$can(n(T).CLIENT.ADD,n(T).CLIENT.SUBJECT)?(i(),v(x,{key:0,"prepend-icon":"tabler-plus",onClick:l[3]||(l[3]=t=>S.value=!0)},{default:s(()=>[P(" Add New Client ")]),_:1})):R("",!0)])]),_:1}),a(B),a(W,{class:"text-no-wrap"},{default:s(()=>[It,e("tbody",null,[(i(!0),h(I,null,$(n(L),t=>(i(),h("tr",{key:t.id,style:{height:"3.75rem"}},[e("td",null,d(t.id),1),e("td",null,[e("div",$t,[a(yt,{variant:"tonal",class:"me-3",size:"38"},{default:s(()=>[t.avatar?(i(),v(kt,{key:0,src:t.avatar},null,8,["src"])):(i(),h("span",St,d(t.name.toUpperCase().charAt(0)),1))]),_:2},1024),e("div",Nt,[e("h6",Rt,[a(p,{to:{name:"apps-user-view-id",params:{id:t.id}},class:"font-weight-medium user-list-name"},{default:s(()=>[P(d(t.name),1)]),_:2},1032,["to"])]),e("span",Bt,"@"+d(t.email),1)])])]),e("td",null,[e("span",Ot,d(t.city.name),1)]),e("td",null,[e("span",jt,d(t.phone),1)]),e("td",null,[e("span",Ft,d(parseFloat(t.balance.balance).toFixed(2))+" DZD",1)]),e("td",Wt,[a(x,{icon:"",size:"x-small",color:"default",variant:"text",onClick:f=>rt(t)},{default:s(()=>[a(k,{size:"22",icon:"tabler-box"})]),_:2},1032,["onClick"]),a(x,{icon:"",size:"x-small",color:"default",variant:"text",onClick:f=>it(t)},{default:s(()=>[a(k,{size:"22",icon:"tabler-briefcase"})]),_:2},1032,["onClick"]),a(x,{icon:"",size:"x-small",color:"default",variant:"text",onClick:f=>H(t)},{default:s(()=>[a(k,{size:"22",icon:"tabler-currency-dollar"})]),_:2},1032,["onClick"]),a(x,{icon:"",size:"x-small",color:"default",variant:"text",onClick:f=>nt(t)},{default:s(()=>[a(k,{size:"22",icon:"tabler-shopping-cart"})]),_:2},1032,["onClick"]),o.$can(n(T).CLIENT.EDIT,n(T).CLIENT.SUBJECT)?(i(),v(x,{key:0,icon:"",size:"x-small",color:"default",variant:"text",onClick:f=>ot(t)},{default:s(()=>[a(k,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"])):R("",!0),o.$can(n(T).CLIENT.DELETE,n(T).CLIENT.SUBJECT)?(i(),v(x,{key:1,icon:"",size:"x-small",color:"default",variant:"text",onClick:f=>st(t)},{default:s(()=>[a(k,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"])):R("",!0),a(x,{icon:"",size:"x-small",color:"default",variant:"text"},{default:s(()=>[a(k,{size:"22",icon:"tabler-dots-vertical"})]),_:1})])]))),128))]),pt(e("tfoot",null,qt,512),[[mt,!n(L).length]])]),_:1}),a(B),a(F,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3 px-5"},{default:s(()=>[e("span",Ht,d(n(tt)),1),a(Dt,{modelValue:n(_),"onUpdate:modelValue":l[4]||(l[4]=t=>m(_)?_.value=t:null),size:"small","total-visible":5,length:n(A)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1}),a(Et,{modelValue:n(C),"onUpdate:modelValue":l[9]||(l[9]=t=>m(C)?C.value=t:null),scrollable:"",class:"v-dialog-sm","max-width":"700",width:"auto","content-class":"scrollable-dialog"},{default:s(()=>[a(y,{onClick:l[5]||(l[5]=t=>C.value=!n(C))}),a(K,{title:" "},{default:s(()=>[a(F,{class:"d-flex justify-end gap-3 flex-wrap"},{default:s(()=>[a(At,{modelValue:n(V),"onUpdate:modelValue":l[6]||(l[6]=t=>m(V)?V.value=t:V=t),grow:""},{default:s(()=>[(i(),h(I,null,$(g,t=>a(Lt,{key:t.id,value:t.id},{default:s(()=>[P(d(t.name),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),a(B),a(Tt,{modelValue:n(V),"onUpdate:modelValue":l[7]||(l[7]=t=>m(V)?V.value=t:V=t),class:"mt-6 pl-3 pa-1"},{default:s(()=>[(i(),v(O,{key:g[0].id,value:g[0].id,width:"150%"},{default:s(()=>[a(G,null,{default:s(()=>[a(M,{cols:"6",md:"6"},{default:s(()=>[a(_t)]),_:1})]),_:1})]),_:1},8,["value"])),(i(),v(O,{key:g[1].id,value:g[1].id,class:"mt-0",style:{"margin-top":"0 !important"}},{default:s(()=>[(i(!0),h(I,null,$(n(c).sales,t=>(i(),v(W,{class:"text-no-wrap mt-0 mb-10"},{default:s(()=>[Qt,e("tbody",null,[(i(!0),h(I,null,$(t.sale_items,f=>(i(),h("tr",{key:f.id},[e("td",Zt,d(f.product.name),1),e("td",Mt,d(f.sale_date),1),e("td",Gt,d(f.quantity),1),e("td",Kt,d(f.price),1),e("td",Xt,d(f.total_price),1)]))),128)),e("tr",null,[Yt,te,ee,le,e("td",ae,d(t.total_amount),1)]),e("tr",null,[oe,se,ne,ie,e("td",re,d(t.regulation),1)]),e("tr",null,[de,ue,ce,pe,e("td",me,d(t.balance),1)])])]),_:2},1024))),256))]),_:1},8,["value"])),(i(),v(O,{key:g[2].id,value:g[2].id,class:"mt-0",style:{width:"-webkit-fill-available"},width:"100%"},{default:s(()=>[a(W,{class:"text-no-wrap mt-0",style:{width:"-webkit-fill-available"}},{default:s(()=>[fe,e("tbody",null,[(i(!0),h(I,null,$(n(c).payments,t=>(i(),h("tr",{key:t.id},[e("td",null,d(t.payment_date),1),e("td",null,d(t.amount_paid),1)]))),128))])]),_:1})]),_:1},8,["value"])),(i(),v(O,{key:g[3].id,value:g[3].id},null,8,["value"]))]),_:1},8,["modelValue"]),a(x,{onClick:l[8]||(l[8]=t=>C.value=!1)},{default:s(()=>[P(" Close ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(ht,{isDrawerOpen:n(S),"onUpdate:isDrawerOpen":l[10]||(l[10]=t=>m(S)?S.value=t:null),cities:n(w),"onUpdate:cities":l[11]||(l[11]=t=>m(w)?w.value=t:null),onClientData:et},null,8,["isDrawerOpen","cities"]),a(xt,{isDrawerOpen:n(N),"onUpdate:isDrawerOpen":l[12]||(l[12]=t=>m(N)?N.value=t:null),client:n(c),"onUpdate:client":l[13]||(l[13]=t=>m(c)?c.value=t:c=t),cities:n(w),"onUpdate:cities":l[14]||(l[14]=t=>m(w)?w.value=t:null),onClientData:lt},null,8,["isDrawerOpen","client","cities"]),n(z)?(i(),v(gt,{key:0,isDialogVisible:n(z),"onUpdate:isDialogVisible":l[15]||(l[15]=t=>m(z)?z.value=t:null),client:n(c),"onUpdate:client":l[16]||(l[16]=t=>m(c)?c.value=t:c=t),onClientData:at},null,8,["isDialogVisible","client"])):R("",!0)])}}};typeof Q=="function"&&Q(ve);export{ve as default};
