import{k as n,Z as le,o as r,b as d,w as a,p as e,E as x,$ as F,A as oe,r as ie,q as o,m as l,D as p,y as b,C as f,c as B,a as se,x as v,O as ne,F as re,H as de,I as ce,bf as Y}from"./main.3e4fe580.js";import{_ as ue}from"./AppDateTimePicker.a0081449.js";import{a as me}from"./formatters.4acf44a4.js";import{u as pe}from"./useSaleStore.ba0b240a.js";import{_ as fe}from"./InvoiceAddPaymentDrawer.33526664.js";import{_ as ve}from"./DialogCloseBtn.156c971b.js";import{V as G,c as $}from"./VCard.6ecf732f.js";import{V as D,a as _e}from"./VBtn.78fdee4b.js";import{V as Ve}from"./VDialog.8856b7dc.js";import{P as u}from"./permissions.bafe5f34.js";import{a as ge}from"./VOverlay.2382ad16.js";import{V as Z}from"./VSelect.47435795.js";import{V as be}from"./VAutocomplete.bd291683.js";import{V as H}from"./VDivider.24d37960.js";import{V as xe}from"./VTable.102acbab.js";import{V as Se}from"./VTooltip.da4ac948.js";import{V as Q}from"./VAvatar.6ab53fb2.js";import{V as De}from"./VImg.0f30bc9b.js";import{V as he}from"./VMenu.a8ae5610.js";import{V as ye,a as N,b as R}from"./VList.763f3acf.js";import{V as we}from"./VSpacer.ff002d0c.js";import{V as Ce}from"./VPagination.63ff60cb.js";import{a as Ae,V as ke}from"./VRow.04916300.js";import"./VField.8b01d37c.js";import"./index.b0f48be5.js";import"./VInput.c44d1482.js";import"./router.304344cf.js";import"./position.ba96c1c3.js";import"./easing.36b781ab.js";import"./index.b522f886.js";import"./errorsMiddleware.17878227.js";import"./successMiddleware.0039b70f.js";import"./VForm.9ee55331.js";import"./forwardRefs.c003b6b8.js";import"./VTextField.8a7f8c82.js";/* empty css                   */import"./VCounter.5e3bb5dc.js";import"./VTextarea.a6002511.js";import"./VNavigationDrawer.b7bda0b7.js";import"./ssrBoot.765a8e5e.js";import"./scopeId.d4b76a30.js";import"./dialog-transition.2b895dc7.js";import"./lazy.8911aa6c.js";import"./VCheckboxBtn.f819973a.js";import"./VSelectionControl.1891ba56.js";import"./VChip.afddbe62.js";import"./filter.99772e0d.js";const Ee={__name:"ConfirmationDialog",props:{isDialogVisible:{type:Boolean,required:!0},sale:{type:Object,required:!0}},emits:["update:isDrawerOpen","saleData"],setup(J,{emit:S}){const h=J,y=n(),_=()=>{S("update:isDialogVisible",!1)};le(()=>h.sale,V=>{V&&(y.value=V.id||0)});const c=()=>{S("saleData",{id:h.sale.id}),S("update:isDialogVisible",!1)};return(V,m)=>{const g=ve;return r(),d(Ve,{modelValue:h.isDialogVisible,"onUpdate:modelValue":m[2]||(m[2]=w=>h.isDialogVisible=w),persistent:"",class:"v-dialog-sm"},{default:a(()=>[e(g,{onClick:m[0]||(m[0]=w=>_())}),e(G,{title:"Confirmation"},{default:a(()=>[e($,null,{default:a(()=>[x(" Are you sure you want to delete this record ? ")]),_:1}),e($,{class:"d-flex justify-end gap-3 flex-wrap"},{default:a(()=>[e(D,{color:"secondary",variant:"tonal",onClick:m[1]||(m[1]=w=>S("update:isDialogVisible",!1))},{default:a(()=>[x(" Disagree ")]),_:1}),e(D,{onClick:c},{default:a(()=>[x(" Agree ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};const Pe={class:"d-flex align-center",style:{width:"135px"}},Te=l("span",{class:"text-no-wrap me-3"},"Show:",-1),Ie={class:"d-flex align-center",style:{width:"30%"}},Le={class:"d-flex align-center flex-wrap gap-4"},$e={class:"invoice-list-filter"},ze={class:"invoice-list-filter"},Ue={class:"invoice-list-filter"},Oe={class:"me-3"},Be={class:"text-uppercase"},Ne=l("th",{scope:"col"}," #ID ",-1),Re={scope:"col",class:"text-center"},Je=l("th",{scope:"col"}," CLIENT ",-1),Me=l("th",{scope:"col",class:"text-center"}," TOTAL ",-1),je=l("th",{scope:"col"}," Issued Date ",-1),qe=l("th",{scope:"col"}," ACTIONS ",-1),Fe={class:"text-center"},Ye={class:"mb-0"},Ze={class:"mb-0"},He={class:"d-flex align-center"},Qe={key:1},Ge={class:"d-flex flex-column"},Ke={class:"text-base font-weight-medium mb-0"},We={class:"text-disabled text-sm"},Xe={class:"text-center"},et={style:{width:"8rem"}},tt=l("tr",null,[l("td",{colspan:"8",class:"text-center text-body-1"}," No data available ")],-1),at=[tt],lt={class:"text-sm text-disabled"},ot={__name:"index",setup(J){const S=pe(),h=n(""),y=n(),_=n(10),c=n(1),V=n(1),m=n(0),g=n([]),w=n([]),P=n(""),M=n([]),T=n(""),I=n(""),A=n(!1),k=n(!1);let C=n();const K=n([{id:1,name:"Paid"},{id:2,name:"Not Paid"}]),z=()=>{S.fetchSales({searchValue:h.value,status:y.value,perPage:_.value,currentPage:c.value,client_id:P.value,from:T.value,to:I.value}).then(s=>{E.value.isActive=!1,g.value=s.data.sales,w.value=s.data.clients,V.value=s.data.totalPage,m.value=s.data.totalSales}).catch(s=>{E.value.isActive=!1,console.log(s)})};F(()=>{z()}),F(()=>{c.value>V.value&&(c.value=V.value)});const W=oe(()=>{const s=g.value.length?(c.value-1)*_.value+1:0,i=g.value.length+(c.value-1)*_.value;return`Showing ${s} to ${i} of ${m.value} entries`}),U=s=>s.balance>0?s.balance==s.total_amount?{variant:"error",icon:"tabler-x"}:{variant:"info",icon:"tabler-circle-half-2"}:s.balance<0?{variant:"warning",icon:"tabler-alert-circle"}:s.balance==0?{variant:"success",icon:"tabler-circle-check"}:{variant:"error",icon:"tabler-chart-pie"},j=n(),X=s=>{A.value=!0,j.value=s},E=n({isActive:!0}),ee=s=>{k.value=!0,C=s,console.log(C)},te=s=>{S.deleteSale(s).then(i=>{z()}).catch(i=>{console.log(i)})},L=()=>{E.value.isActive=!0,z()};return(s,i)=>{const q=ue,ae=ie("RouterLink");return r(),d(ke,null,{default:a(()=>[e(ge,{"model-value":o(E).isActive,class:"align-center justify-center"},{default:a(()=>[e(_e,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),e(Ae,null,{default:a(()=>[o(g)?(r(),d(G,{key:0,id:"invoice-list"},{default:a(()=>[e($,{class:"d-flex align-center flex-wrap gap-4"},{default:a(()=>[l("div",Pe,[Te,e(Z,{modelValue:o(_),"onUpdate:modelValue":i[0]||(i[0]=t=>p(_)?_.value=t:null),density:"compact",items:[10,20,30,50,100,500,1e3,5e3]},null,8,["modelValue"])]),l("div",Ie,[e(be,{clearable:"",modelValue:o(P),"onUpdate:modelValue":[i[1]||(i[1]=t=>p(P)?P.value=t:null),L],items:o(w),"item-value":"id","item-title":"name",label:"Client",placeholder:"Client"},null,8,["modelValue","items"])]),l("div",Le,[l("div",$e,[e(q,{modelValue:o(T),"onUpdate:modelValue":[i[2]||(i[2]=t=>p(T)?T.value=t:null),L],label:"From Date"},null,8,["modelValue"])]),l("div",ze,[e(q,{modelValue:o(I),"onUpdate:modelValue":[i[3]||(i[3]=t=>p(I)?I.value=t:null),L],label:"To Date"},null,8,["modelValue"])]),l("div",Ue,[e(Z,{modelValue:o(y),"onUpdate:modelValue":[i[4]||(i[4]=t=>p(y)?y.value=t:null),L],label:"Select Status",clearable:"","item-value":"id","item-title":"name","clear-icon":"tabler-x","single-line":"",items:o(K)},null,8,["modelValue","items"])]),l("div",Oe,[s.$can(o(u).SALE.ADD,o(u).SALE.SUBJECT)?(r(),d(D,{key:0,"prepend-icon":"tabler-plus",to:{name:"apps-POS-sale-add"}},{default:a(()=>[x(" Create ")]),_:1})):b("",!0)])])]),_:1}),e(H),e(xe,{class:"text-no-wrap invoice-list-table"},{default:a(()=>[l("thead",Be,[l("tr",null,[Ne,l("th",Re,[e(f,{icon:"tabler-trending-up"})]),Je,Me,je,qe])]),l("tbody",null,[(r(!0),B(re,null,se(o(g),t=>(r(),B("tr",{key:t.id,style:{height:"3.75rem"}},[l("td",null,[e(ae,{to:{name:"apps-POS-sale-preview-id",params:{id:t.id}}},{default:a(()=>[x(" #"+v(t.id),1)]),_:2},1032,["to"])]),l("td",Fe,[e(Se,null,{activator:a(({props:O})=>[e(Q,ne({size:30},O,{color:U(t).variant,variant:"tonal"}),{default:a(()=>[e(f,{size:20,icon:U(t).icon},null,8,["icon"])]),_:2},1040,["color"])]),default:a(()=>[l("p",Ye,v(t.invoiceStatus),1),l("p",Ze," Balance: "+v(t.balance),1)]),_:2},1024)]),l("td",null,[l("div",He,[e(Q,{size:"34",color:U(t).variant,variant:"tonal",class:"me-3"},{default:a(()=>[t.avatar?(r(),d(De,{key:0,src:t.avatar},null,8,["src"])):(r(),B("span",Qe,v(o(me)(t.client.name)),1))]),_:2},1032,["color"]),l("div",Ge,[l("h6",Ke,v(t.client.name),1),l("span",We,v(t.client.email),1)])])]),l("td",Xe,v(t.total_amount)+" DZD ",1),l("td",null,v(t.sale_date),1),l("td",et,[e(D,{icon:"",variant:"text",color:"default",size:"x-small"},{default:a(()=>[e(f,{icon:"tabler-mail",size:22})]),_:1}),s.$can(o(u).SALE.DELETE,o(u).SALE.SUBJECT)?(r(),d(D,{key:0,icon:"",variant:"text",color:"default",size:"x-small",onClick:O=>ee(t)},{default:a(()=>[e(f,{size:22,icon:"tabler-trash"})]),_:2},1032,["onClick"])):b("",!0),s.$can(o(u).SALE.LIST,o(u).SALE.SUBJECT)?(r(),d(D,{key:1,icon:"",variant:"text",color:"default",size:"x-small",to:{name:"apps-POS-sale-preview-id",params:{id:t.id}}},{default:a(()=>[e(f,{size:22,icon:"tabler-eye"})]),_:2},1032,["to"])):b("",!0),e(D,{icon:"",variant:"text",color:"default",size:"x-small"},{default:a(()=>[e(f,{size:22,icon:"tabler-dots-vertical"}),e(he,{activator:"parent"},{default:a(()=>[e(ye,null,{default:a(()=>[e(N,{value:"download"},{prepend:a(()=>[e(f,{size:"24",class:"me-3",icon:"tabler-download"})]),default:a(()=>[e(R,null,{default:a(()=>[x("Download")]),_:1})]),_:1}),s.$can(o(u).SALE.EDIT,o(u).SALE.SUBJECT)?(r(),d(N,{key:0,to:{name:"apps-POS-sale-edit-id",params:{id:t.id}}},{prepend:a(()=>[e(f,{size:"24",class:"me-3",icon:"tabler-pencil"})]),default:a(()=>[e(R,null,{default:a(()=>[x("Edit")]),_:1})]),_:2},1032,["to"])):b("",!0),s.$can(o(u).PAYMENT.ADD,o(u).PAYMENT.SUBJECT)?(r(),d(N,{key:1,value:"payment",onClick:O=>X(t)},{prepend:a(()=>[e(f,{size:"24",class:"me-3",icon:"tabler-credit-card"})]),default:a(()=>[e(R,null,{default:a(()=>[x("Payment")]),_:1})]),_:2},1032,["onClick"])):b("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]))),128))]),de(l("tfoot",null,at,512),[[ce,!o(g).length]])]),_:1}),e(H),e($,{class:"d-flex align-center flex-wrap gap-4 py-3"},{default:a(()=>[l("span",lt,v(o(W)),1),e(we),e(Ce,{modelValue:o(c),"onUpdate:modelValue":i[5]||(i[5]=t=>p(c)?c.value=t:null),size:"small","total-visible":5,length:o(V),onNext:i[6]||(i[6]=t=>M.value=[]),onPrev:i[7]||(i[7]=t=>M.value=[])},null,8,["modelValue","length"])]),_:1}),o(k)?(r(),d(Ee,{key:0,isDialogVisible:o(k),"onUpdate:isDialogVisible":i[8]||(i[8]=t=>p(k)?k.value=t:null),sale:o(C),"onUpdate:sale":i[9]||(i[9]=t=>p(C)?C.value=t:C=t),onSaleData:te},null,8,["isDialogVisible","sale"])):b("",!0)]),_:1})):b("",!0)]),_:1}),o(A)?(r(),d(fe,{key:0,loading:o(E),data:o(j),isDrawerOpen:o(A),"onUpdate:isDrawerOpen":i[10]||(i[10]=t=>p(A)?A.value=t:null)},null,8,["loading","data","isDrawerOpen"])):b("",!0)]),_:1})}}};typeof Y=="function"&&Y(ot);export{ot as default};
