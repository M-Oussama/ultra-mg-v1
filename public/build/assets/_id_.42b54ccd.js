import{k as s,bd as ct,$ as j,Z as pt,A as mt,r as _t,o as u,c as x,p as o,w as i,q as n,m as t,D as d,b as V,E as z,F as L,a as N,x as r,H as ft,I as vt,y as ht}from"./main.cf9f31a9.js";import{_ as xt}from"./DialogCloseBtn.1c4165b0.js";import{_ as Vt}from"./AppDateTimePicker.b70b0339.js";import{u as bt,_ as wt,a as yt,b as gt,c as Dt}from"./ClientMonthlyReport.766d2a8a.js";import{E as Ct}from"./jspdf.es.min.aecddb65.js";import{a as kt}from"./jspdf.plugin.autotable.81fc07ed.js";import{a as Ft}from"./VOverlay.9d9650d6.js";import{a as K,V as Y}from"./VBtn.d73656ae.js";import{a as X,V as tt}from"./VRow.a394feb3.js";import{V as et,c as q}from"./VCard.a1247ba2.js";import{V as B}from"./VDivider.01acf602.js";import{V as St}from"./VSelect.32c4b2dd.js";import{V as At}from"./VSpacer.6ec948ae.js";import{V as Pt}from"./VTextField.9102871e.js";import{V as G}from"./VTable.60781dfc.js";import{V as Tt}from"./VAvatar.9270a597.js";import{V as Ut}from"./VPagination.7fcfaf73.js";import{V as It,a as zt}from"./VTabs.0ae1bb3a.js";import{V as Lt,a as E}from"./VWindowItem.3f52cdcf.js";import{V as Nt}from"./VDialog.ac89ffbe.js";import"./VField.6a2ec846.js";import"./index.d1f0132a.js";import"./VInput.d6b4ca43.js";import"./router.1658937d.js";import"./VImg.134af49b.js";import"./position.b360a9d1.js";import"./easing.36b781ab.js";import"./validators.330a354f.js";import"./index.b522f886.js";import"./VForm.f1d9c3ac.js";import"./forwardRefs.c003b6b8.js";import"./VAutocomplete.dab6d47c.js";import"./filter.73bf6f77.js";import"./VList.a34172e8.js";import"./VMenu.3df9bfa4.js";import"./scopeId.08611610.js";import"./dialog-transition.b0009893.js";import"./VCheckboxBtn.b3570faf.js";import"./VSelectionControl.5a5e7888.js";import"./VChip.6c2e2c44.js";import"./VNavigationDrawer.2d863e08.js";import"./ssrBoot.e94d367d.js";import"./vue3-apexcharts.common.64a065dd.js";import"./vue.runtime.esm-bundler.899117cb.js";import"./lazy.f959659a.js";/* empty css                   */import"./VCounter.4f92d6c5.js";import"./VSlideGroup.ee136b32.js";const Wt={class:"me-3",style:{width:"80px"}},$t={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Bt={style:{width:"9rem"}},Et=t("thead",null,[t("tr",null,[t("th",{scope:"col"}," ID "),t("th",{scope:"col"}," Date "),t("th",{scope:"col"}," Achat "),t("th",{scope:"col"}," Regulation "),t("th",{scope:"col"}," Payment "),t("th",{scope:"col"}," Balance ")])],-1),Ot={class:"d-flex align-center"},Rt={class:"d-flex flex-column"},jt={class:"text-base"},Yt={class:"text-sm text-disabled"},qt={class:"text-capitalize text-base font-weight-semibold"},Gt={class:"text-capitalize text-base font-weight-semibold"},Mt={class:"text-capitalize text-base font-weight-semibold"},Qt={class:"text-capitalize text-base font-weight-semibold"},Ht=t("tr",null,[t("td",{colspan:"7",class:"text-center"}," No data available ")],-1),Jt=[Ht],Zt={class:"text-sm text-disabled"},Kt=t("thead",null,[t("tr",null,[t("th",{class:"text-caption"}," Product "),t("th",{class:"text-caption"}," Date "),t("th",{class:"text-caption"}," Quantity "),t("th",{class:"text-caption"}," Price "),t("th",{class:"text-caption"}," Total ")])],-1),Xt={class:"text-caption"},te={class:"text-caption"},ee={class:"text-caption"},ae={class:"text-caption"},le={class:"text-caption"},oe=t("td",null,null,-1),ne=t("td",null,null,-1),se=t("td",null,null,-1),ie=t("td",{class:"text-caption"}," Total ",-1),re={class:"text-caption"},ue=t("td",null,null,-1),de=t("td",null,null,-1),ce=t("td",null,null,-1),pe=t("td",{class:"text-caption"}," Payment ",-1),me={class:"text-caption"},_e=t("td",null,null,-1),fe=t("td",null,null,-1),ve=t("td",null,null,-1),he=t("td",{class:"text-caption"}," Rest ",-1),xe={class:"text-caption"},Ve=t("thead",null,[t("tr",null,[t("th",null," Date "),t("th",null," Amount ")])],-1),fa={__name:"[id]",setup(be){const S=bt(),A=s(""),M=s(!1),at=s(!0),D=s(!1);s(),s(),s();const C=s(10),m=s(1),k=s(1),Q=s(0),w=s([]);let F=s([]),_=s(),b=s("Appetizers"),y=s({isActive:!1});const P=s(new Date(`01-01-${new Date().getFullYear()}`)),T=s(new Date);s("Sample PDF Generator"),s(["This is another few sentences of text to look at it.","Just testing the paragraphs to see how they format.","jsPDF likes arrays for sentences.","Do paragraphs wrap properly?","Yes, they do!","What does it look like?","Not bad at all."]);const h=s([{title:"Item 1",body:"I am item 1 body text"},{title:"Item 2",body:"I am item 2 body text"},{title:"Item 3",body:"I am item 3 body text"},{title:"Item 4",body:"I am item 4 body text"}]);let W=s(0);const H=ct(),U=()=>{y.value.isActive=!0,S.fetchClientLog({client_id:Number(H.params.id),from_date:P.value,to_date:T.value,searchValue:A.value,perPage:C.value,currentPage:m.value}).then(l=>{console.log(l),y.value.isActive=!1,F.value=l.data.logs.data,_.value=l.data.client,k.value=l.data.totalPage,w.value=l.data.cities,Q.value=l.data.totalLogs,M.value=!1}).catch(l=>{console.error(l),y.value.isActive=!1})};j(U),j(()=>{m.value>k.value&&(m.value=k.value)}),pt(A,()=>{U()});const O=s(!1),R=s(!1),$=s(!1);let f=s();j(()=>{m.value>k.value&&(m.value=k.value)});const lt=mt(()=>{const l=F.value.length?(m.value-1)*C.value+1:0,a=F.value.length+(m.value-1)*C.value;return`Showing ${l} to ${a} of ${Q.value} entries`}),ot=l=>{S.addClient(l).then(a=>{U()}).catch(a=>{console.log(a)})},nt=l=>{S.updateClient(l).then(a=>{U()}).catch(a=>{console.log(a)})},st=l=>{S.deleteClient(l).then(a=>{U()}).catch(a=>{console.log(a)})},J=l=>(l.type==="sale"?l.counted||(l.total_balance=W.value,parseFloat(l.amount)>0?l.total_balance+=parseFloat(l.amount):l.total_balance-=parseFloat(l.amount),l.counted=!0,W.value=l.total_balance):l.counted||(l.total_balance=W.value,parseFloat(l.amount)>0?l.total_balance-=parseFloat(l.amount):l.total_balance+=parseFloat(l.amount),l.counted=!0,W.value=l.total_balance),l.total_balance),it=()=>{Z(F)},rt=()=>{let l=s();y.value.isActive=!0,S.exportAllLog({client_id:Number(H.params.id),from_date:P.value,to_date:T.value}).then(a=>{y.value.isActive=!1,l.value=a.data.logs,Z(l)}).catch(a=>{console.error(a),y.value.isActive=!1})},Z=l=>{var a=[],g=1;a.push(["ID","Date","Sale","Payment","Balance"]);for(let c=0;c<l._rawValue.length;c++)J(l._rawValue[c]),l._rawValue[c].type==="sale"?a.push([g,l._rawValue[c].date,l._rawValue[c].amount,l._rawValue[c].regulation>0?l._rawValue[c].regulation:"",l._rawValue[c].total_balance]):a.push([g,l._rawValue[c].date,"",l._rawValue[c].amount,l._rawValue[c].total_balance]),g++;console.log(a),a.push([g,"","","",l._rawValue[l._rawValue.length-1].total_balance]);const p=new Ct({orientation:"portrait",format:"letter"});let I=new Date,e=String(I.getDate()).padStart(2,"0"),v=String(I.getMonth()+1).padStart(2,"0"),ut=I.getFullYear(),dt=e+"/"+v+"/"+ut;p.setFontSize(16).text("CUSTOMER LOG",100,15,{align:"center",maxWidth:"100"}),p.setFontSize(8).text("Client: "+_.value.name+" "+_.value.surname,15,25,{align:"left",maxWidth:"100"}),p.setFontSize(8).text("Address: "+_.value.address,100,25,{align:"center",maxWidth:"100"}),p.setFontSize(8).text("Email: "+(_.value.email===null?"":_.value.email),195,25,{align:"right",maxWidth:"100"}),p.setFontSize(8).text("Phone: "+(_.value.phone===null?"":_.value.phone),15,35,{align:"left",maxWidth:"100"}),p.setFontSize(8).text("From:        To:      ",97,35,{align:"center",maxWidth:"100"}),p.setFontSize(8).text("Date: "+dt,187,35,{align:"right",maxWidth:"100"}),kt(p,{columnStyles:{0:{halign:"center"}},margin:{top:40,left:10},body:a}),p.save(_.value.name+"_"+_.value.surname+"_log.pdf")};return(l,a)=>{const g=Vt,p=_t("RouterLink"),I=xt;return u(),x("section",null,[o(tt,null,{default:i(()=>[o(Ft,{"model-value":n(y).isActive,class:"align-center justify-center"},{default:i(()=>[o(K,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),o(X,{cols:"12"},{default:i(()=>[o(et,{title:"logs"},{default:i(()=>[o(B),o(q,{class:"d-flex flex-wrap py-4 gap-4"},{default:i(()=>[t("div",Wt,[o(St,{modelValue:n(C),"onUpdate:modelValue":a[0]||(a[0]=e=>d(C)?C.value=e:null),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"])]),o(g,{modelValue:n(P),"onUpdate:modelValue":a[1]||(a[1]=e=>d(P)?P.value=e:null),label:"From"},null,8,["modelValue"]),o(g,{modelValue:n(T),"onUpdate:modelValue":a[2]||(a[2]=e=>d(T)?T.value=e:null),label:"To"},null,8,["modelValue"]),o(At),t("div",$t,[t("div",Bt,[n(M)?(u(),V(K,{key:0,indeterminate:"",color:"primary"})):(u(),V(Pt,{key:1,onInput:a[3]||(a[3]=e=>at.value=!0),ref:"searchField",modelValue:n(A),"onUpdate:modelValue":a[4]||(a[4]=e=>d(A)?A.value=e:null),placeholder:"Search",density:"compact"},null,8,["modelValue"]))]),o(Y,{variant:"tonal",color:"secondary","prepend-icon":"tabler-screen-share",onClick:it},{default:i(()=>[z(" Export ")]),_:1}),o(Y,{variant:"tonal",color:"secondary","prepend-icon":"tabler-screen-share",onClick:rt},{default:i(()=>[z(" ExportAll ")]),_:1})])]),_:1}),o(B),o(G,{class:"text-no-wrap"},{default:i(()=>[Et,t("tbody",null,[(u(!0),x(L,null,N(n(F),(e,v)=>(u(),x("tr",{key:e.id,style:{height:"3.75rem"}},[t("td",null,r(parseInt(v)+1),1),t("td",null,[t("div",Ot,[o(Tt,{variant:"tonal",class:"me-3",size:"38"},{default:i(()=>[t("span",null,r(e.type.toUpperCase().charAt(0)),1)]),_:2},1024),t("div",Rt,[t("h6",jt,[o(p,{to:{name:"apps-user-view-id",params:{id:e.id}},class:"font-weight-medium user-list-name"},{default:i(()=>[z(r(e.date),1)]),_:2},1032,["to"])]),t("span",Yt,r(),1)])])]),t("td",null,[t("span",qt,r(e.type==="sale"?e.amount:""),1)]),t("td",null,[t("span",Gt,r(e.type==="sale"?e.regulation:""),1)]),t("td",null,[t("span",Mt,r(e.type==="payment"?e.amount:""),1)]),t("td",null,[t("span",Qt,r(J(e)),1)])]))),128))]),ft(t("tfoot",null,Jt,512),[[vt,!n(F).length]])]),_:1}),o(B),o(q,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3 px-5"},{default:i(()=>[t("span",Zt,r(n(lt)),1),o(Ut,{modelValue:n(m),"onUpdate:modelValue":a[5]||(a[5]=e=>d(m)?m.value=e:null),size:"small","total-visible":5,length:n(k)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1}),o(Nt,{modelValue:n(D),"onUpdate:modelValue":a[10]||(a[10]=e=>d(D)?D.value=e:null),scrollable:"",class:"v-dialog-sm","max-width":"700",width:"auto","content-class":"scrollable-dialog"},{default:i(()=>[o(I,{onClick:a[6]||(a[6]=e=>D.value=!n(D))}),o(et,{title:" "},{default:i(()=>[o(q,{class:"d-flex justify-end gap-3 flex-wrap"},{default:i(()=>[o(It,{modelValue:n(b),"onUpdate:modelValue":a[7]||(a[7]=e=>d(b)?b.value=e:b=e),grow:""},{default:i(()=>[(u(!0),x(L,null,N(n(h),e=>(u(),V(zt,{key:e.id,value:e.id},{default:i(()=>[z(r(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),o(B),o(Lt,{modelValue:n(b),"onUpdate:modelValue":a[8]||(a[8]=e=>d(b)?b.value=e:b=e),class:"mt-6 pl-3 pa-1"},{default:i(()=>[(u(),V(E,{key:n(h)[0].id,value:n(h)[0].id,width:"150%"},{default:i(()=>[o(tt,null,{default:i(()=>[o(X,{cols:"6",md:"6"},{default:i(()=>[o(wt)]),_:1})]),_:1})]),_:1},8,["value"])),(u(),V(E,{key:n(h)[1].id,value:n(h)[1].id,class:"mt-0",style:{"margin-top":"0 !important"}},{default:i(()=>[(u(!0),x(L,null,N(n(f).sales,e=>(u(),V(G,{class:"text-no-wrap mt-0 mb-10"},{default:i(()=>[Kt,t("tbody",null,[(u(!0),x(L,null,N(e.sale_items,v=>(u(),x("tr",{key:v.id},[t("td",Xt,r(v.product.name),1),t("td",te,r(v.sale_date),1),t("td",ee,r(v.quantity),1),t("td",ae,r(v.price),1),t("td",le,r(v.total_price),1)]))),128)),t("tr",null,[oe,ne,se,ie,t("td",re,r(e.amount),1)]),t("tr",null,[ue,de,ce,pe,t("td",me,r(e.regulation),1)]),t("tr",null,[_e,fe,ve,he,t("td",xe,r(e.balance),1)])])]),_:2},1024))),256))]),_:1},8,["value"])),(u(),V(E,{key:n(h)[2].id,value:n(h)[2].id,class:"mt-0",style:{width:"-webkit-fill-available"},width:"100%"},{default:i(()=>[o(G,{class:"text-no-wrap mt-0",style:{width:"-webkit-fill-available"}},{default:i(()=>[Ve,t("tbody",null,[(u(!0),x(L,null,N(n(f).payments,e=>(u(),x("tr",{key:e.id},[t("td",null,r(e.payment_date),1),t("td",null,r(e.amount),1)]))),128))])]),_:1})]),_:1},8,["value"])),(u(),V(E,{key:n(h)[3].id,value:n(h)[3].id},null,8,["value"]))]),_:1},8,["modelValue"]),o(Y,{onClick:a[9]||(a[9]=e=>D.value=!1)},{default:i(()=>[z(" Close ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(yt,{isDrawerOpen:n(O),"onUpdate:isDrawerOpen":a[11]||(a[11]=e=>d(O)?O.value=e:null),cities:n(w),"onUpdate:cities":a[12]||(a[12]=e=>d(w)?w.value=e:null),onClientData:ot},null,8,["isDrawerOpen","cities"]),o(gt,{isDrawerOpen:n(R),"onUpdate:isDrawerOpen":a[13]||(a[13]=e=>d(R)?R.value=e:null),client:n(f),"onUpdate:client":a[14]||(a[14]=e=>d(f)?f.value=e:f=e),cities:n(w),"onUpdate:cities":a[15]||(a[15]=e=>d(w)?w.value=e:null),onClientData:nt},null,8,["isDrawerOpen","client","cities"]),n($)?(u(),V(Dt,{key:0,isDialogVisible:n($),"onUpdate:isDialogVisible":a[16]||(a[16]=e=>d($)?$.value=e:null),client:n(f),"onUpdate:client":a[17]||(a[17]=e=>d(f)?f.value=e:f=e),onClientData:st},null,8,["isDialogVisible","client"])):ht("",!0)])}}};export{fa as default};
