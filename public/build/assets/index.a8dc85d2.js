import{k as u,o as b,b as A,w as t,m as r,p as e,C as z,q as o,P as Y,D as _,be as Z,E as h,Z as j,$ as I,A as ie,r as re,c as q,F as ue,a as de,x as O,H as me,I as pe,y as ce}from"./main.e3ae6f5b.js";import{_ as H}from"./AppDateTimePicker.fa89fced.js";import{u as F}from"./useSaleStore.33d18f08.js";import{e as D,s as B}from"./errorsMiddleware.cd79b49a.js";/* empty css                        */import{q as Q}from"./VueSearchSelect.73cea5c2.js";import{V as L}from"./VSpacer.50e7ecc1.js";import{V,a as K}from"./VBtn.78b9f864.js";import{V as E,c as N}from"./VCard.9574192c.js";import{V as G}from"./VForm.724a7186.js";import{V as M,a as w}from"./VRow.307db058.js";import{V as R}from"./VTextField.c4710a67.js";import{V as J}from"./VTextarea.f0669caf.js";import{V as W}from"./VNavigationDrawer.2a3e31b0.js";import{_ as fe}from"./DialogCloseBtn.91cc9156.js";import{V as ye}from"./VDialog.6cfe2dfa.js";import{a as ve}from"./VOverlay.bef3a4a8.js";import{V as T}from"./VDivider.04b9ef9a.js";import{V as _e}from"./VSelect.e8db8923.js";import{V as ge}from"./VTable.24eac033.js";import{V as Ve}from"./VAvatar.a66dff35.js";import{V as be}from"./VImg.a8f9a1c8.js";import{V as De}from"./VPagination.29fbda3c.js";import"./VField.93385836.js";import"./index.ba8dc909.js";import"./VInput.ebff45cb.js";import"./router.92e08cce.js";import"./position.4c99774d.js";import"./easing.36b781ab.js";import"./forwardRefs.c003b6b8.js";/* empty css                   */import"./VCounter.a137105a.js";import"./ssrBoot.170b97eb.js";import"./scopeId.55b8accf.js";import"./dialog-transition.cc00eae2.js";import"./lazy.f3535b64.js";import"./VList.d6dc74e3.js";import"./VMenu.d6d893ca.js";import"./VCheckboxBtn.41b91637.js";import"./VSelectionControl.90a7537b.js";import"./VChip.dd80b8e5.js";const we={class:"d-flex align-center pa-6 pb-1"},xe=r("h6",{class:"text-h6"}," Add Payment ",-1),Pe={__name:"AddNewPaymentDrawer",props:{isDrawerOpen:{type:null,required:!0},data:{type:null,required:!0},clients:{type:null,required:!0},loading:{type:null,required:!0}},emits:["paymentData"],setup(S,{emit:U}){const l=S,x=u(!1),n=u(),k=F(),s=u({balance:0,amount:"0",date:"",note:"",client:{id:-1}}),d=u();u({id:-1});const f=()=>{l.isDrawerOpen.open=!1},P=()=>{s.value.client.id===-1||s.value.amount==="0"||s.value.amount===""||s.value.date===""?(s.value.client.id===-1&&D("Client not selected","Oops! Looks like you forgot to select a client. Kindly pick at least one client to proceed"),s.value.amount==="0"&&D("Amount cannot be 0","The amount value must be higher than 0"),s.value.amount===""&&D("Amount is Empty","You must enter a value in the amount field"),s.value.date===""&&D("Payment Date not selected","Please select the payment date")):(console.log("payment"),console.log(s),p(),l.loading.isActive=!0,k.storePayment(s.value).then(v=>{l.loading.isActive=!1,s.value.amount=0,s.value.date="",s.value.note="",s.value.client.id=-1,B("Payment created Successfully"),U("paymentData",{data:d})}).catch(v=>{console.log(v),l.loading.isActive=!1,D("Error Occured","Oops! Looks like the payment has not been submited ")}))},c=v=>`${v.name}  ${v.surname}`,p=v=>{console.log(v),l.isDrawerOpen.open=!1};return(v,m)=>{const $=H;return b(),A(W,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":l.isDrawerOpen.open,"onUpdate:modelValue":p},{default:t(()=>[r("div",we,[xe,e(L),e(V,{variant:"tonal",color:"default",icon:"",size:"32",class:"rounded",onClick:f},{default:t(()=>[e(z,{size:"18",icon:"tabler-x"})]),_:1})]),e(o(Y),{options:{wheelPropagation:!1}},{default:t(()=>[e(E,{flat:""},{default:t(()=>[e(N,null,{default:t(()=>[e(G,{ref_key:"refForm",ref:n,modelValue:o(x),"onUpdate:modelValue":m[4]||(m[4]=g=>_(x)?x.value=g:null),onSubmit:Z(P,["prevent"])},{default:t(()=>[e(M,null,{default:t(()=>[e(w,{cols:"12"},{default:t(()=>[e(o(Q),{list:l.clients,modelValue:o(s).client,"onUpdate:modelValue":m[0]||(m[0]=g=>o(s).client=g),"option-value":"id","custom-text":c,hideSelectedOptions:!0,placeholder:"Select Client"},null,8,["list","modelValue"])]),_:1}),e(w,{cols:"12"},{default:t(()=>[e(R,{type:"number",modelValue:o(s).amount,"onUpdate:modelValue":m[1]||(m[1]=g=>o(s).amount=g),min:"0",label:"Payment Amount"},null,8,["modelValue"])]),_:1}),e(w,{cols:"12"},{default:t(()=>[e($,{modelValue:o(s).date,"onUpdate:modelValue":m[2]||(m[2]=g=>o(s).date=g),label:"Payment Date"},null,8,["modelValue"])]),_:1}),e(w,{cols:"12"},{default:t(()=>[e(J,{modelValue:o(s).note,"onUpdate:modelValue":m[3]||(m[3]=g=>o(s).note=g),label:"Internal Payment Note"},null,8,["modelValue"])]),_:1}),e(w,{cols:"12"},{default:t(()=>[e(V,{type:"submit",class:"me-3"},{default:t(()=>[h(" Submit ")]),_:1}),e(V,{type:"reset",variant:"tonal",color:"secondary",onClick:f},{default:t(()=>[h(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},he={class:"d-flex align-center pa-6 pb-1"},ke=r("h6",{class:"text-h6"}," Edit Payment ",-1),Ce={__name:"EditPaymentDrawer",props:{isDrawerOpen:{type:Boolean,required:!0},payment:{type:Object,required:!0},clients:{type:Object,required:!0},loading:{type:Object,required:!0}},emits:["paymentData"],setup(S,{emit:U}){const l=S,x=F();j(()=>l.payment,c=>{console.log("newPayment"),console.log(c)}),j(l.isDrawerOpen,()=>{l.isDrawerOpen.open&&(n.value.id=l.payment.id||-1,n.value.sale_id=l.payment.sale_id||"",n.value.client_id=l.payment.client_id||"",n.value.amount_paid=l.payment.amount_paid||"",n.value.payment_date=l.payment.payment_date||"",n.value.note=l.payment.note||"")});const n=u({id:0,sale_id:"",client_id:-1,amount_paid:"",payment_date:"",note:""}),k=u(!1),s=u(),d=()=>{l.isDrawerOpen.open=!1},f=()=>{n.client_id===-1||n.amount_paid==="0"||n.payment_date===""||n.note===""?(n.client_id===-1&&D("Client not selected","Oops! Looks like you forgot to select a client. Kindly pick at least one client to proceed"),n.amount_paid==="0"&&D("Amount cannot be 0","The amount value must be higher than 0"),n.amount_paid===""&&D("Amount is Empty","You must enter a value in the amount field"),n.payment_date===""&&D("Payment Date not selected","Please select the payment date")):(l.loading.isActive=!0,x.updatePayment(n.value).then(c=>{l.isDrawerOpen.open=!1,l.loading.isActive=!1,U("paymentData",1),B("Payment updated Successfully")}).catch(c=>{console.log(c),l.loading.isActive=!1,D("Error Occured","Oops! Looks like the payment has not been submited ")}))},P=c=>`${c.name}  ${c.surname}`;return(c,p)=>{const v=H;return b(),A(W,{temporary:"",width:400,location:"end",class:"scrollable-content","model-value":l.isDrawerOpen.open},{default:t(()=>[r("div",he,[ke,e(L),e(V,{variant:"tonal",color:"default",icon:"",size:"32",class:"rounded",onClick:d},{default:t(()=>[e(z,{size:"18",icon:"tabler-x"})]),_:1})]),e(o(Y),{options:{wheelPropagation:!1}},{default:t(()=>[e(E,{flat:""},{default:t(()=>[e(N,null,{default:t(()=>[e(G,{ref_key:"refForm",ref:s,modelValue:o(k),"onUpdate:modelValue":p[4]||(p[4]=m=>_(k)?k.value=m:null),onSubmit:Z(f,["prevent"])},{default:t(()=>[e(M,null,{default:t(()=>[e(w,{cols:"12"},{default:t(()=>[e(o(Q),{list:l.clients,modelValue:o(n).client_id,"onUpdate:modelValue":p[0]||(p[0]=m=>o(n).client_id=m),"option-value":"id","custom-text":P,hideSelectedOptions:!0,placeholder:"Select Client"},null,8,["list","modelValue"])]),_:1}),e(w,{cols:"12"},{default:t(()=>[e(R,{type:"number",modelValue:o(n).amount_paid,"onUpdate:modelValue":p[1]||(p[1]=m=>o(n).amount_paid=m),min:"0",label:"Payment Amount"},null,8,["modelValue"])]),_:1}),e(w,{cols:"12"},{default:t(()=>[e(v,{modelValue:o(n).payment_date,"onUpdate:modelValue":p[2]||(p[2]=m=>o(n).payment_date=m),label:"Payment Date"},null,8,["modelValue"])]),_:1}),e(w,{cols:"12"},{default:t(()=>[e(J,{modelValue:o(n).note,"onUpdate:modelValue":p[3]||(p[3]=m=>o(n).note=m),label:"Internal Payment Note"},null,8,["modelValue"])]),_:1}),e(w,{cols:"12"},{default:t(()=>[e(V,{type:"submit",class:"me-3"},{default:t(()=>[h(" Submit ")]),_:1}),e(V,{type:"reset",variant:"tonal",color:"secondary",onClick:d},{default:t(()=>[h(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},Oe={__name:"ConfirmationDialog",props:{isDialogVisible:{type:Boolean,required:!0},payment:{type:Object,required:!0},loading:{type:Object,required:!0},payments:{type:Object,required:!0}},emits:["paymentData"],setup(S,{emit:U}){const l=S,x=F();u();const n=()=>{l.isDialogVisible.open=!1},k=()=>{l.loading.isActive=!0;const s=l.payment.id,d=l.payments.findIndex(f=>f.id===s);x.deletePayment(l.payment).then(f=>{l.isDialogVisible.open=!1,l.loading.isActive=!1,B("Payment Deleted Successfully"),l.payments.splice(d,1),console.log("index: "+d)}).catch(f=>{console.log(f),l.loading.isActive=!1,D("Error Occured","Oops! Looks like the payment has not been deleted ")}),l.isDialogVisible.open=!1};return(s,d)=>{const f=fe;return b(),A(ye,{modelValue:l.isDialogVisible,"onUpdate:modelValue":d[2]||(d[2]=P=>l.isDialogVisible=P),persistent:"",class:"v-dialog-sm"},{default:t(()=>[e(f,{onClick:d[0]||(d[0]=P=>n())}),e(E,{title:"Confirmation"},{default:t(()=>[e(N,null,{default:t(()=>[h(" Are you sure you want to delete this payment ? ")]),_:1}),e(N,{class:"d-flex justify-end gap-3 flex-wrap"},{default:t(()=>[e(V,{color:"secondary",variant:"tonal",onClick:d[1]||(d[1]=P=>l.isDialogVisible.open=!1)},{default:t(()=>[h(" Disagree ")]),_:1}),e(V,{onClick:k},{default:t(()=>[h(" Agree ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};const Ae={class:"me-3",style:{width:"80px"}},Se={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Ue={style:{width:"9rem"}},$e=r("thead",null,[r("tr",null,[r("th",{scope:"col"}," ID "),r("th",{scope:"col"}," Client "),r("th",{scope:"col"}," Amount "),r("th",{scope:"col"}," Date "),r("th",{scope:"col"}," ACTIONS ")])],-1),Ne={class:"d-flex align-center"},ze={key:1},qe={class:"d-flex flex-column"},Fe={class:"text-base"},Ee={class:"text-sm text-disabled"},Ie={class:"text-capitalize text-base font-weight-semibold"},Te={class:"text-capitalize text-base font-weight-semibold"},je={class:"text-center",style:{width:"5rem"}},Be=r("tr",null,[r("td",{colspan:"7",class:"text-center"}," No data available ")],-1),Le=[Be],Me={class:"text-sm text-disabled"},Ut={__name:"index",setup(S){const U=F(),l=u(""),x=u(!1),n=u({isActive:!0}),k=u(!0);u(),u(),u();const s=u(10),d=u(1),f=u(1),P=u(0);let c=u([]),p=u([]);const v=()=>{n.value.isActive=!0,U.fetchPayments({searchValue:l.value,perPage:s.value,currentPage:d.value}).then(y=>{c.value=y.data.payments.data,p.value=y.data.clients,f.value=y.data.totalPage,P.value=y.data.totalPayments,x.value=!1,n.value.isActive=!1}).catch(y=>{console.error(y),n.value.isActive=!1})};I(v),I(()=>{d.value>f.value&&(d.value=f.value)}),j(l,()=>{v()});const m=u({open:!1}),$=u({open:!1}),g=u({open:!1}),C=u();I(()=>{d.value>f.value&&(d.value=f.value)});const X=ie(()=>{const y=c.value.length?(d.value-1)*s.value+1:0,i=c.value.length+(d.value-1)*s.value;return`Showing ${y} to ${i} of ${P.value} entries`}),ee=y=>{v()},te=y=>{v()},ae=y=>{v(),console.log("fetch")},le=y=>{console.log("payment"),console.log(y),C.value=y,console.log("selectedPayment"),console.log(C),$.value.open=!0},oe=y=>{g.value.open=!0,C.value=y};return(y,i)=>{const ne=re("RouterLink");return b(),q("section",null,[e(M,null,{default:t(()=>[e(ve,{"model-value":o(n).isActive,class:"align-center justify-center"},{default:t(()=>[e(K,{color:"primary",indeterminate:"",size:"64"})]),_:1},8,["model-value"]),e(w,{cols:"12"},{default:t(()=>[e(E,{title:"Payments"},{default:t(()=>[e(T),e(N,{class:"d-flex flex-wrap py-4 gap-4"},{default:t(()=>[r("div",Ae,[e(_e,{modelValue:o(s),"onUpdate:modelValue":i[0]||(i[0]=a=>_(s)?s.value=a:null),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"])]),e(L),r("div",Se,[r("div",Ue,[o(x)?(b(),A(K,{key:0,indeterminate:"",color:"primary"})):(b(),A(R,{key:1,onInput:i[1]||(i[1]=a=>k.value=!0),ref:"searchField",modelValue:o(l),"onUpdate:modelValue":i[2]||(i[2]=a=>_(l)?l.value=a:null),placeholder:"Search",density:"compact"},null,8,["modelValue"]))]),e(V,{variant:"tonal",color:"secondary","prepend-icon":"tabler-screen-share"},{default:t(()=>[h(" Export ")]),_:1}),e(V,{"prepend-icon":"tabler-plus",onClick:i[3]||(i[3]=a=>o(m).open=!0)},{default:t(()=>[h(" New Payment ")]),_:1})])]),_:1}),e(T),e(ge,{class:"text-no-wrap"},{default:t(()=>[$e,r("tbody",null,[(b(!0),q(ue,null,de(o(c),a=>(b(),q("tr",{key:a.id,style:{height:"3.75rem"}},[r("td",null,O(a.id),1),r("td",null,[r("div",Ne,[e(Ve,{variant:"tonal",class:"me-3",size:"38"},{default:t(()=>[a.avatar?(b(),A(be,{key:0,src:a.avatar},null,8,["src"])):(b(),q("span",ze,O(a.client.name.toUpperCase().charAt(0)),1))]),_:2},1024),r("div",qe,[r("h6",Fe,[e(ne,{to:{name:"apps-user-view-id",params:{id:a.id}},class:"font-weight-medium user-list-name"},{default:t(()=>[h(O(a.client.name)+" "+O(a.client.surname),1)]),_:2},1032,["to"])]),r("span",Ee,"@"+O(a.client.email),1)])])]),r("td",null,[r("span",Ie,O(parseFloat(a.amount_paid).toFixed(2))+" DZD",1)]),r("td",null,[r("span",Te,O(a.payment_date),1)]),r("td",je,[e(V,{icon:"",size:"x-small",color:"default",variant:"text",onClick:se=>le(a)},{default:t(()=>[e(z,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"]),e(V,{icon:"",size:"x-small",color:"default",variant:"text",onClick:se=>oe(a)},{default:t(()=>[e(z,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"]),e(V,{icon:"",size:"x-small",color:"default",variant:"text"},{default:t(()=>[e(z,{size:"22",icon:"tabler-dots-vertical"})]),_:1})])]))),128))]),me(r("tfoot",null,Le,512),[[pe,!o(c).length]])]),_:1}),e(T),e(N,{class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3 px-5"},{default:t(()=>[r("span",Me,O(o(X)),1),e(De,{modelValue:o(d),"onUpdate:modelValue":i[4]||(i[4]=a=>_(d)?d.value=a:null),size:"small","total-visible":5,length:o(f)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Pe,{isDrawerOpen:o(m),"onUpdate:isDrawerOpen":i[5]||(i[5]=a=>_(m)?m.value=a:null),clients:o(p),"onUpdate:clients":i[6]||(i[6]=a=>_(p)?p.value=a:p=a),loading:o(n),"onUpdate:loading":i[7]||(i[7]=a=>_(n)?n.value=a:null),onPaymentData:ee},null,8,["isDrawerOpen","clients","loading"]),e(Ce,{isDrawerOpen:o($),"onUpdate:isDrawerOpen":i[8]||(i[8]=a=>_($)?$.value=a:null),payment:o(C),"onUpdate:payment":i[9]||(i[9]=a=>_(C)?C.value=a:null),clients:o(p),"onUpdate:clients":i[10]||(i[10]=a=>_(p)?p.value=a:p=a),loading:o(n),"onUpdate:loading":i[11]||(i[11]=a=>_(n)?n.value=a:null),onPaymentData:te},null,8,["isDrawerOpen","payment","clients","loading"]),o(g).open?(b(),A(Oe,{key:0,isDialogVisible:o(g),"onUpdate:isDialogVisible":i[12]||(i[12]=a=>_(g)?g.value=a:null),payment:o(C),"onUpdate:payment":i[13]||(i[13]=a=>_(C)?C.value=a:null),loading:o(n),"onUpdate:loading":i[14]||(i[14]=a=>_(n)?n.value=a:null),payments:o(c),"onUpdate:payments":i[15]||(i[15]=a=>_(c)?c.value=a:c=a),onPaymentData:ae},null,8,["isDialogVisible","payment","loading","payments"])):ce("",!0)])}}};export{Ut as default};
